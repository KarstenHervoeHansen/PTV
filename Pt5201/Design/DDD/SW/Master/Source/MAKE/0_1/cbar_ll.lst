XA assembler v2.0 r2                    SN00085795-037 (c) 1998 TASKING, Inc.
                                                                                                                            Page   1
D:\PROJECT\pt5201\master\source\MAKE\WORK_KEN\temp\xa\cbar_ll.src
ADDR   CODE            LINE SOURCELINE
                          1 ; cbar.asm - assembly routines for PT5201 ColorBar generator
                          2 ;
                          3 ;
                          4 ;
                          5 ;
                          6 ;
                          7 ;
                          8 ;===============================================================================
                          9 $                      
                         11 ; rtxcopts.inc - RTXC assembly options 8051XA
                         13 ;
                         14 ;   RTXC    
                         15 ;   Copyright (c) 
                         16 ;   Embedded System Products, Inc.
                         17 ;   ALL RIGHTS RESERVED
                         18 ;
                         19 ;============================================================================
                         21 ;-------------------------------------
                         22 ; KERNEL priority level
                         23 ;    NOTE: RTXCINTLVL must match level in RTXCOPTS.H
                         24 ;-------------------------------------
                         25 RTXCINTLVL    equ   0Dh
                         27 ;-------------------------------------
                         28 ; KERNEL Trap number
                         29 ;    NOTE:
                         30 ;-------------------------------------
                         31 RTXC_TRAPNUM  equ    0h
                         33 ;-------------------------------------
                         34 ; RTXC stack size
                         35 ;    NOTE: RTXCSTKSZ must match definition in RTXCOPTS.H
                         36 ;-------------------------------------
                         37 RTXCSTKSZ    equ   256; can be changed as needed, min = approx 256 bytes
                         39 ;-------------------------------------
                         40 ; Nulltask's stack size
                         41 ;-------------------------------------
                         42 NULLSTKSZ    equ   128; Size of null stack, min = 128
                         44 ;===========================================================================
                         45 ; This switch is to define 12 bytes of kernel data into the first 1k bytes
                         46 ; of RAM.  Having this switch defined to _near allows the kernel to execute
                         47 ; considerably faster at a minimal cost. If this data is not desired to be
                         48 ; in the 1k bytes, then define CORE_IRAMDATA to zero (0).
                         49 ;                1 = YES,  0 = NO
                         50 ;---------------------------------------------------------------------------
                         52 ;===========================================================================
                         54 ;===========================================================================
                         55 ; This allows the kernel in the LARGE memory model to access the stacks as
                         56 ; 16 bit data.
                         57 ;
                         58 ;NOTE1: This switch must match the setting of the switch of the same name
                         59 ;       in the RTXCOPTS.H module.
                         60 ;
                         61 ;NOTE2: This switch is supported only in the Tasking LARGE memory model.
                         62 ;                1 = YES,  0 = NO
                         63 ;---------------------------------------------------------------------------
                         65 ;===========================================================================
                         67 ;****************************************************************************
                         68 ; Do not modify anything below this line
                         69 ;---------------------------------------------------------------------------
                         71    
                         72    
                         73    
                         74    
XA assembler v2.0 r2                    SN00085795-037 (c) 1998 TASKING, Inc.
                                                                                                                            Page   2

ADDR   CODE            LINE SOURCELINE
                         75        
                         76        
                         77            
                         78        
                         79    
                         80    
                         81    
                         85 ;===========================================================================
                         86 ; The SYSMODE switch should always be defined and equal to 0x080.
                         87 ; This defines the system mode.  User mode is not supported by RTXC.
                         88 ;---------------------------------------------------------------------------
                         89 SYSMODE  equ 080h
                         90 ;===========================================================================
                         92 ; end of rtxcopts.inc
                         94 ;$INCLUDE (isrs.inc)
                         96 LineTypeA equ 01h
                         97 LineTypeB equ 00h
                         98 LineTypeC equ 10h
                         99 LineTypeD equ 11h
                        101 EXTRN DATA ( _CBarSystemLineCnt)
                        102 EXTRN DATA ( _CBarSystemPtr)
000000                  104 CBAR_TABLES     SEGMENT CODE
000000                  105         RSEG CBAR_TABLES
000000 16000000         107 DW 22,  LineTypeB
000004 90001000         108 DW 144, LineTypeC
000008 90001000         109 DW 144, LineTypeC
00000C 02000000         110 DW 2,           LineTypeB
000010 17000100         111 DW 23,  LineTypeA
000014 90001100         112 DW 144, LineTypeD
000018 90001100         113 DW 144, LineTypeD
00001C 02000100         114 DW 2,           LineTypeA
000020 0000             115 DW 0
000000                  118 CBAR_CODE SEGMENT CODE
000000                  119         RSEG CBAR_CODE
000000                  119         RSEG CBAR_CODE
                        121         public cbar_system
000000                  122 cbar_system:
                        124         ; DJNZ VideoLineCnt, next
                        126         ; mov R0, VideoPtr
                        127         ;  inc  VideoPtr
                        128         ; anl VideoPtr, #8
                        129         ; mov R6, [R0]
                        131         ; mov VideoLineCnt, R6
                        132         ; mov StatusPort, R6
                        134         ; next:DW
000000 D680             135    ret
