XA assembler v2.0 r2                    SN00085795-037 (c) 1998 TASKING, Inc.
                                                                                                                            Page   1
U:\Pt5201\Design\DDD\SW\Master\Source\MAKE\1_0\temp\xa\key_hw.src
ADDR   CODE            LINE SOURCELINE
                          1 ; XA C compiler v2.0 r2                   SN00085795-Ccz (c) 1998 TASKING, Inc.
                          2 ; options: -A1 -Cxag3 -e -g -Ic:\cxa\include -I..\..\rtxcdef\xa
                          3 ;          -I..\..\rtxc\xa\include -I..\..\code\include\1_0 -I..\..\app_spec\xa
                          4 ;          -Ml -O2 -s
                          6 $NOZPAGE
                          7         NAME    KEY_HW
                         11 ; key_hw.c    1 /****************************************************************************/
                         12 ; key_hw.c    2 /* MODULE:                                                                  */
                         13 ; key_hw.c    3 /*  key_hw.c - Keyboard driver                                              */
                         14 ; key_hw.c    4 /****************************************************************************/
                         15 ; key_hw.c    5 /* FUNCTIONS:                                                               */
                         16 ; key_hw.c    6 /*                                                                          */
                         17 ; key_hw.c    7 /*      int KeyboardGet( UC *scancode);                                          
                                                                                                                             
                                                    */
                         18 ; key_hw.c    8 /*                                                                          */
                         19 ; key_hw.c    9 /* TASKS:                                                                   */
                         20 ; key_hw.c   10 /*                                                                          */
                         21 ; key_hw.c   11 /* NOTES:                                                                   */
                         22 ; key_hw.c   12 /*                                                                          */
                         23 ; key_hw.c   13 /****************************************************************************/
                         24 ; key_hw.c   14 /*
                         25 ; key_hw.c   15  *   PTV software for PT5201    
                         26 ; key_hw.c   16  *   Copyright (c) 
                         27 ; key_hw.c   17  *   ProTeleVision Technologies A/S.
                         28 ; key_hw.c   18  *   ALL RIGHTS RESERVED
                         29 ; key_hw.c   19 */
                         30 ; key_hw.c   20 /****************************************************************************/
                         31 ; key_hw.c   21 #include "define.h"        // Standard PTV defines
                         34 ; key_hw.c   22 #include "key_hw.h"
                         37 ; key_hw.c   23 #include "keycodes.h"
                         40 ; key_hw.c   24 
                         41 ; key_hw.c   25 volatile UI PushButtonPort _at(0x6a010);        // Port defined in PLD
                         42 ; key_hw.c   26 
                         43 ; key_hw.c   27 /**************************************************************************/
                         44 ; key_hw.c   28 /* KeyboardGet                                                                   
                                                                                                                             
                                                       KEY_HW.C     */
                         45 ; key_hw.c   29 /*                                                                               
                                                                                                                             
                                                                                                                             
                                            */
                         46 ; key_hw.c   30 /* Author:       Kim Engedahl, DEV, 000208                                       
                                                                                                                             
                                    */
                         47 ; key_hw.c   31 /* Revised:      000321, KEn, DEV                                                
                                                                                                                             
                                            */
                         48 ; key_hw.c   32 /*                                                                               
                                                                                                                             
                                                                                                                             
                                            */
                         49 ; key_hw.c   33 /* Function:                                                                     
                                                                                                                             
                                                                                                    */
                         50 ; key_hw.c   34 /* Remarks:                                                                      
                                                                                                                             
                                                                                                                    */
                         51 ; key_hw.c   35 /* Returns:                                                                      
                                                                                                                             
                                                                                                                    */
XA assembler v2.0 r2                    SN00085795-037 (c) 1998 TASKING, Inc.
                                                                                                                            Page   2

ADDR   CODE            LINE SOURCELINE
                         52 ; key_hw.c   36 /* Updates:                                                                      
                                                                                                                             
                                                                                                                    */
                         53 ; key_hw.c   37 /**************************************************************************/
                         54 ; key_hw.c   38 int KeyboardGet( UC *scancode)
                         55 ; key_hw.c   39 {
000000                   56 KEY_HW_PR       SEGMENT HCODE
000000                   57         RSEG    KEY_HW_PR
                         58         ALIGN   1
                         60         PUBLIC  _KeyboardGet
000000                   61 _KeyboardGet:
                         69 ; key_hw.c   40         if ( PushButtonPort & 0x01)
000000 96484206          71         MOV.B   ES,#SEG( _PushButtonPort )
000004 9928A010          72         MOV.W   R2,#SOF( _PushButtonPort )
000008 8A22              73         MOV.W   R2,[R2]
00000A 99250001          74         AND.W   R2,#01H
00000E F304              75         BEQ     _3
                         76 ; key_hw.c   41                 *scancode = KeyNone;
000010 862C42            78         MOV.B   ES,R1L
000013 9208FF            79         MOV.B   [R0],#0FFH
000016 FE03              80         BR      _4
000016 FE03              80         BR      _4
000018                   81 _3:
                         84 ; key_hw.c   42         else
                         85 ; key_hw.c   43                 *scancode = KeyExecute;
000018 862C42            87         MOV.B   ES,R1L
00001B 9208CF            88         MOV.B   [R0],#0CFH
00001B 9208CF            88         MOV.B   [R0],#0CFH
00001E                   89 _4:
                         90 ; key_hw.c   44 
                         91 ; key_hw.c   45         return( OK);
00001E 9908FFFF          93         MOV.W   R0,#0FFFFH
                         95 ; key_hw.c   46 }
000022 D680              97         RET
06A010                  103         HSEG AT 06A010H
                        104         PUBLIC  _PushButtonPort
                        105         ALIGN   1
06A010                  106 _PushButtonPort:        DS      2
   |  RESERVED             
06A011
                        107         EXTRN   DATA(__lc_ub_xvwbuffer)
                        108         EXTRN   DATA(__lc_ue_xvwbuffer)
