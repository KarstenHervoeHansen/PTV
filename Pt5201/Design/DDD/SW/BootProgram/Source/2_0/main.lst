XA assembler v2.0 r2                    SN00085795-037 (c) 1998 TASKING, Inc.
                                                                                                                            Page   1
U:\Pt5201\Design\DDD\SW\BootProgram\Source\2_0\main.src
ADDR   CODE            LINE SOURCELINE
                          2 ; options: -IC:\cxa\include -Ml -Cxag3 -Sd -A1 -O1 -DWritableSector=0
                          3 ;          -DBootProgram=1 -g
                          5 $NOZPAGE
                          6         NAME    MAIN
000000                   33 MAIN_PR SEGMENT HCODE
000000                   34         RSEG    MAIN_PR
                         35         ALIGN   1
000000                   37 MAIN_INI_BI@DS  SEGMENT BIT JOIN INIT
000000                   38         RSEG    MAIN_INI_BI@DS
000000 0                 39 _3:     DB      000H
000000                   40 MAIN_INI_FA     SEGMENT HDATA INSEGMENT INIT
000000                   41         RSEG    MAIN_INI_FA
000000 00                42 _4:     DB      000H
000000                   43 MAIN_CLR_FA     SEGMENT HDATA INSEGMENT CLEAR
000000                   44         RSEG    MAIN_CLR_FA
000000 RESERVED          45 _5:     DS      1
000000
                         46         PUBLIC  _timer_int
000000                   47         RSEG    MAIN_PR
000000                   47         RSEG    MAIN_PR
000000                   48 _timer_int:
000000 0F03              52         PUSH.W  R0, R1
000002 873441            53         PUSH.B  DS
000005 964841rr          54         MOV.B   DS,#SEG( __DS )
000009 873442            55         PUSH.B  ES
00000C 873403            56         PUSH.B  SSEL
00000F 9646037F          57         OR.B    SSEL,#07FH
000013 96485140          62         MOV.B   0451H,#040H
000017 964842rr          64         MOV.B   ES,#SEG( _5 )
00001B 9908rrrr          65         MOV.W   R0,#SOF( _5 )
00001F 8200              66         MOV.B   R0L,[R0]
000021 A101              67         ADDS.B  R0L,#01H
000023 964842rr          68         MOV.B   ES,#SEG( _5 )
000027 9918rrrr          69         MOV.W   R1,#SOF( _5 )
00002B 8209              70         MOV.B   [R1],R0L
00002D 910402            71         CMP.B   R0L,#02H
000030 F940              72         BL      _11
000032 964842rr          74         MOV.B   ES,#SEG( _5 )
000036 9908rrrr          75         MOV.W   R0,#SOF( _5 )
00003A B200              76         MOV.B   [R0],#00H
00003C 860rrr            78         MOV.B   R0L,_UserTimer
00003F F302              79         BEQ     _6
000041 A6rFrr            81         ADDS.B  _UserTimer,#0FH
000041 A6rFrr            81         ADDS.B  _UserTimer,#0FH
000044                   82 _6:
000044 082rrr            84         MOV     C,_LEDFlashON
000047 F035              85         BCC     _11
000049 964842rr          87         MOV.B   ES,#SEG( _4 )
00004D 9908rrrr          88         MOV.W   R0,#SOF( _4 )
000051 8200              89         MOV.B   R0L,[R0]
000053 8110              90         MOV.B   R0H,R0L
000055 A10F              91         ADDS.B  R0L,#0FH
000057 964842rr          92         MOV.B   ES,#SEG( _4 )
00005B 9918rrrr          93         MOV.W   R1,#SOF( _4 )
00005F 8209              94         MOV.B   [R1],R0L
000061 6111              95         OR.B    R0H,R0H
000063 F227              96         BNE     _11
000065 964842rr          98         MOV.B   ES,#SEG( _4 )
000069 9908rrrr          99         MOV.W   R0,#SOF( _4 )
00006D 920814           100         MOV.B   [R0],#014H
000070 97Arrr02         102         JNB     _3,_13
000074 B101             103         MOVS.B  R0L,#01H
XA assembler v2.0 r2                    SN00085795-037 (c) 1998 TASKING, Inc.
                                                                                                                            Page   2

ADDR   CODE            LINE SOURCELINE
000076 FE01             104         BR      _14
000076 FE01             104         BR      _14
000078                  105 _13:
000078 B100             106         MOVS.B  R0L,#00H
000078 B100             106         MOVS.B  R0L,#00H
00007A                  107 _14:
00007A 910701           108         XOR.B   R0L,#01H
00007D 080000           109         CLR     R0.0
000080 F302             110         BEQ     _15
000082 081000           111         SETB    R0.0
000082 08100000         111         SETB    R0.0
000086                  112 _15:
000086 082000           113         MOV     C,R0.0
000089 083rrr           114         MOV     _3,C
00008C 082000           116         MOV     C,R0.0
00008F F00C             117         BCC     _7
000091 964842rr         119         MOV.B   ES,#SEG( _LEDs )
000095 9908rrrr         120         MOV.W   R0,#SOF( _LEDs )
000099 8200             121         MOV.B   R0L,[R0]
00009B 9648420E         122         MOV.B   ES,#SEG( _TestLEDPort )
00009F 9918A014         123         MOV.W   R1,#SOF( _TestLEDPort )
0000A3 8209             124         MOV.B   [R1],R0L
0000A5 FE06             125         BR      _11
0000A5 FE0600           125         BR      _11
0000A8                  126 _7:
0000A8 9648420E         128         MOV.B   ES,#SEG( _TestLEDPort )
0000AC 9908A014         129         MOV.W   R0,#SOF( _TestLEDPort )
0000B0 B200             130         MOV.B   [R0],#00H
0000B2                  132 _11:
0000B2 871403           134         POP.B   SSEL
0000B5 871442           135         POP.B   ES
0000B8 871441           136         POP.B   DS
0000BB 2F03             137         POP.W   R0, R1
0000BD D690             138         RETI
000084                  139         HCSEG AT 084H
000084 008Frrrrrrrrrr   140         DW      08F00H,_16
       rrrrrr               
000000                  141 MAIN_CO SEGMENT CODE
000000                  142         RSEG    MAIN_CO
000000                  142         RSEG    MAIN_CO
000000                  143 _16:
000000 D4rrrrrr         144         FJMP    _timer_int
0000BF                  145         RSEG    MAIN_PR
0000BF 00               147         ALIGN   1
000001                  149         RSEG    MAIN_CLR_FA
000001 RESERVED         150         ALIGN   1
000001
000002                  151 _17:    DS      2
   |  RESERVED             
000003
                        152         PUBLIC  _main
0000C0                  153         RSEG    MAIN_PR
0000C0                  153         RSEG    MAIN_PR
0000C0                  154 _main:
0000C0 A97C             158         ADDS.W  R7,#0CH
0000C2 B6466A           164         MOV.B   046AH,#06H
0000C5 964801AF         166         MOV.B   0401H,#0AFH
0000C9 964869FA         168         MOV.B   0469H,#0FAH
0000CD 964868CA         170         MOV.B   0468H,#0CAH
0000D1 B64000           172         MOV.B   0400H,#00H
0000D4 B64040           174         MOV.B   0440H,#00H
0000D7 964501F0         176         AND.B   0401H,#0F0H
XA assembler v2.0 r2                    SN00085795-037 (c) 1998 TASKING, Inc.
                                                                                                                            Page   3

ADDR   CODE            LINE SOURCELINE
0000DB B6415C           178         MOV.B   045CH,#01H
0000DE B64151           180         MOV.B   0451H,#01H
0000E1 081331           182         SETB    0331H
0000E4 9648A0F0         184         MOV.B   04A0H,#0F0H
0000E8 9648A5EE         186         MOV.B   04A5H,#0EEH
0000EC 081284           188         SETB    0284H
0000EF 081337           190         SETB    0337H
0000F2 9128rr           192         MOV.B   R1L,#SEG( __lc_bs )
0000F5 7133             193         XOR.B   R1H,R1H
0000F7 8907             194         MOV.W   R0,R7
0000F9 9168rr           195         MOV.B   R3L,#SEG( __lc_bs )
0000FC 7177             196         XOR.B   R3H,R3H
0000FE 402702           197         LEA     R2,R7+2
                        198         CALL    _flash_get_device_info
000101 C4rrrrrr        +198 ;       FCALL   _flash_get_device_info
000105 9C7402224A       200         CMP.W   [R7+2],#0224AH
00010A F328             201         BEQ     _18
00010C 9C740222CB       202         CMP.W   [R7+2],#022CBH
000111 F328             203         BEQ     _19
000113 9C740222DA       204         CMP.W   [R7+2],#022DAH
000118 F327             205         BEQ     _20
00011A 9C7402225B       206         CMP.W   [R7+2],#0225BH
00011F F327             207         BEQ     _21
000121 9C74022223       208         CMP.W   [R7+2],#02223H
000126 F326             209         BEQ     _24
000128 9C740222B9       210         CMP.W   [R7+2],#022B9H
00012D F323             211         BEQ     _24
00012F 9C740222D5       212         CMP.W   [R7+2],#022D5H
000134 F31F             213         BEQ     _24
000136 9C740222AB       214         CMP.W   [R7+2],#022ABH
00013B F31F             215         BEQ     _27
00013D 9C740222BA       216         CMP.W   [R7+2],#022BAH
000142 F31B             217         BEQ     _27
000144 9C740222D6       218         CMP.W   [R7+2],#022D6H
000149 F318             219         BEQ     _27
00014B 9C74021690       220         CMP.W   [R7+2],#01690H
000150 F317             221         BEQ     _28
000152 9C74021692       222         CMP.W   [R7+2],#01692H
000157 F317             223         BEQ     _29
000159 FE19             224         BR      _30
00015C                  226 _18:
00015C BC7002           228         MOV.W   [R7+2],#00H
00015F FE18             230         BR      _38
000162                  232 _19:
000162 BC7102           234         MOV.W   [R7+2],#01H
000165 FE15             236         BR      _38
000168                  238 _20:
000168 BC7202           240         MOV.W   [R7+2],#02H
00016B FE12             242         BR      _38
00016E                  244 _21:
00016E BC7302           246         MOV.W   [R7+2],#03H
000171 FE0F             248         BR      _38
000174                  250 _24:
000174 BC7402           252         MOV.W   [R7+2],#04H
000177 FE0C             254         BR      _38
00017A                  256 _27:
00017A BC7502           258         MOV.W   [R7+2],#05H
00017D FE09             260         BR      _38
000180                  262 _28:
000180 BC7602           264         MOV.W   [R7+2],#06H
000183 FE06             266         BR      _38
000186                  268 _29:
XA assembler v2.0 r2                    SN00085795-037 (c) 1998 TASKING, Inc.
                                                                                                                            Page   4

ADDR   CODE            LINE SOURCELINE
000186 BC7702           270         MOV.W   [R7+2],#07H
000189 FE03             272         BR      _38
00018C                  274 _30:
00018C BC7402           276         MOV.W   [R7+2],#04H
000190                  278 _38:
000190 8C0702           280         MOV.W   R0,[R7+2]
                        281         CALL    _flash_init
000193 C4rrrrrr        +281 ;       FCALL   _flash_init
000197 964842rr         283         MOV.B   ES,#SEG( _LEDs )
00019B 9908rrrr         284         MOV.W   R0,#SOF( _LEDs )
00019F B203             285         MOV.B   [R0],#03H
0001A1 910804           287         MOV.B   R0L,#04H
0001A4 911800           288         MOV.B   R0H,#00H
                        289         CALL    _Udr_InitUart
0001A7 C4rrrrrr        +289 ;       FCALL   _Udr_InitUart
0001AB 96r8rr32         291         MOV.B   _UserTimer,#032H
0001B0                  293 _39:
0001B0 860rrr           294         MOV.B   R0L,_UserTimer
0001B3 F2FE             295         BNE     _39
0001B5 9648420E         297         MOV.B   ES,#SEG( _TestLEDPort )
0001B9 9908A014         298         MOV.W   R0,#SOF( _TestLEDPort )
0001BD B203             299         MOV.B   [R0],#03H
0001BF 081rrr           301         SETB    _LEDFlashON
0001C2 FE07             303         BR      _42
0001C4                  305 _40:
0001C4 964842rr         307         MOV.B   ES,#SEG( _17 )
0001C8 9908rrrr         308         MOV.W   R0,#SOF( _17 )
0001CC 8A00             309         MOV.W   R0,[R0]
                        310         CALL    _CmdHandler
0001CE C4rrrrrr        +310 ;       FCALL   _CmdHandler
0001D2                  312 _42:
                        313         CALL    _Udr_InChar
0001D2 C4rrrrrr        +313 ;       FCALL   _Udr_InChar
0001D6 8100             314         MOV.B   R0L,R0L
0001D8 9019             315         SEXT.B  R0H
0001DA 964842rr         316         MOV.B   ES,#SEG( _17 )
0001DE 9918rrrr         317         MOV.W   R1,#SOF( _17 )
0001E2 8A09             318         MOV.W   [R1],R0
0001E4 9904FFFF         319         CMP.W   R0,#0FFFFH
0001E8 F2ED             320         BNE     _40
0001EA FEF3             322         BR      _42
0001EC A974             324         ADDS.W  R7,#04H
0001EE D680             326         RET
000000                  332 MAIN_CLR_BI@DS  SEGMENT BIT JOIN
000000                  333         RSEG    MAIN_CLR_BI@DS
                        334         PUBLIC  _LEDFlashON
000000 RESERVED         335 _LEDFlashON:    DBIT    1
000000
                        338         EXTRN   HCODE(_flash_init)
                        341         EXTRN   HCODE(_CmdHandler)
000000                  344 MAIN_CLR_NE@DS  SEGMENT DATA JOIN CLEAR
000000                  345         RSEG    MAIN_CLR_NE@DS
                        346         PUBLIC  _UserTimer
000000 RESERVED         347 _UserTimer:     DS      1
000000
                        350         EXTRN   HCODE(_Udr_InChar)
                        351         EXTRN   DATA(__DS)
000004                  354         RSEG    MAIN_CLR_FA
                        355         PUBLIC  _LEDs
000004 RESERVED         356 _LEDs:  DS      1
000004
                        363         EXTRN   HCODE(_flash_get_device_info)
XA assembler v2.0 r2                    SN00085795-037 (c) 1998 TASKING, Inc.
                                                                                                                            Page   5

ADDR   CODE            LINE SOURCELINE
                        366         EXTRN   HCODE(_Udr_InitUart)
0EA014                  369         HSEG AT 0EA014H
                        370         PUBLIC  _TestLEDPort
0EA014 RESERVED         371 _TestLEDPort:   DS      1
0EA014
                        372         EXTRN   IDATA(__lc_bs)
                        373         EXTRN   HCODE(__START)
                        374         EXTRN   DATA(__lc_ub_xvwbuffer)
                        375         EXTRN   DATA(__lc_ue_xvwbuffer)
                        376         CALLS   'main', 'flash_get_device_info'
                        377         CALLS   'main', 'flash_init'
                        378         CALLS   'main', 'Udr_InitUart'
                        379         CALLS   'main', 'CmdHandler'
                        380         CALLS   'main', 'Udr_InChar'
