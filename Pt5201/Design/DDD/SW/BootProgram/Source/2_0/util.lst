XA assembler v2.0 r2                    SN00085795-037 (c) 1998 TASKING, Inc.
                                                                                                                            Page   1
U:\Pt5201\Design\DDD\SW\BootProgram\Source\2_0\util.src
ADDR   CODE            LINE SOURCELINE
                          2 ; options: -IC:\cxa\include -Ml -Cxag3 -Sd -A1 -O1 -DWritableSector=0
                          3 ;          -DBootProgram=1 -g
                          5 $NOZPAGE
                          6         NAME    UTIL
000000                   17 UTIL_PR SEGMENT HCODE
000000                   18         RSEG    UTIL_PR
                         19         ALIGN   1
                         21         PUBLIC  _NONE
000000                   22 _NONE:
000000 D680              27         RET
                         29         ALIGN   1
                         31         PUBLIC  _HexToByte
000002                   32 _HexToByte:
000002 910430            39         CMP.B   R0L,#030H
000005 FB06              40         BLT     _4
000007 910439            41         CMP.B   R0L,#039H
00000A FC03              42         BGT     _4
00000C 910230            44         SUB.B   R0L,#030H
00000F D680              45         RET
00000F D68000            45         RET
000012                   46 _4:
000012 910461            48         CMP.B   R0L,#061H
000015 FB03              49         BLT     _11
000017 B911              50         MOVS.W  R1,#01H
000019 FE02              51         BR      _13
000019 FE0200            51         BR      _13
00001C                   52 _11:
00001C B910              53         MOVS.W  R1,#00H
00001C B910              53         MOVS.W  R1,#00H
00001E                   54 _13:
00001E 6911              55         OR.W    R1,R1
000020 F307              56         BEQ     _6
000022 91047A            57         CMP.B   R0L,#07AH
000025 FC03              58         BGT     _14
000027 B911              59         MOVS.W  R1,#01H
000029 FE02              60         BR      _16
000029 FE0200            60         BR      _16
00002C                   61 _14:
00002C B910              62         MOVS.W  R1,#00H
00002C B910              62         MOVS.W  R1,#00H
00002E                   63 _16:
00002E 6911              64         OR.W    R1,R1
00002E 6911              64         OR.W    R1,R1
000030                   65 _6:
000030 F303              66         BEQ     _7
000032 9105DF            67         AND.B   R0L,#0DFH
000035 FE01              68         BR      _8
000035 FE0100            68         BR      _8
000038                   69 _7:
000038                   69 _7:
000038                   70 _8:
000038 910237            71         SUB.B   R0L,#037H
00003C                   73 _5:
00003C D680              74         RET
                         76         ALIGN   1
                         78         PUBLIC  _htol
00003E                   79 _htol:
00003E 0F30              87         PUSH.W  R4, R5
000040 A978              89         ADDS.W  R7,#08H
000042 8951              92         MOV.W   R5,R1
000044 8940              93         MOV.W   R4,R0
000046 866C42            98         MOV.B   ES,R3L
XA assembler v2.0 r2                    SN00085795-037 (c) 1998 TASKING, Inc.
                                                                                                                            Page   2

ADDR   CODE            LINE SOURCELINE
000049 BA20              99         MOV.W   [R2],#00H
00004B BC2002           100         MOV.W   [R2+2],#00H
00004E 8C3F06           101         MOV.W   [R7+6],R3
000051 8C2F04           102         MOV.W   [R7+4],R2
000054 FE1E             106         BR      _18
000054 FE1E             106         BR      _18
000056                  107 _17:
000056 8C1706           109         MOV.W   R1,[R7+6]
000059 8C0704           110         MOV.W   R0,[R7+4]
00005C 862C42           111         MOV.B   ES,R1L
00005F 8C1002           112         MOV.W   R1,[R0+2]
000062 8A00             113         MOV.W   R0,[R0]
000064 DD04             114         ASL.D   R0,#04H
000066 8C1F02           115         MOV.W   [R7+2],R1
000069 8A0F             116         MOV.W   [R7],R0
00006B 86AC42           117         MOV.B   ES,R5L
00006E 8204             118         MOV.B   R0L,[R4]
000070 C5FFC8           119         CALL    _HexToByte
000073 B110             120         MOVS.B  R0H,#00H
000075 B910             121         MOVS.W  R1,#00H
000077 8C3702           122         MOV.W   R3,[R7+2]
00007A 8A27             123         MOV.W   R2,[R7]
00007C 0902             124         ADD.W   R0,R2
00007E 1913             125         ADDC.W  R1,R3
000080 8C3706           126         MOV.W   R3,[R7+6]
000083 8C2704           127         MOV.W   R2,[R7+4]
000086 866C42           128         MOV.B   ES,R3L
000089 8A0A             129         MOV.W   [R2],R0
00008B 8C1A02           130         MOV.W   [R2+2],R1
00008E 99400001         135         ADD.W   R4,#01H
000092                  137 _18:
000092 86AC42           138         MOV.B   ES,R5L
000095 8204             139         MOV.B   R0L,[R4]
000097 F2DF             140         BNE     _17
000099 910800           142         MOV.B   R0L,#00H
00009C 99700008         144         ADD.W   R7,#08H
0000A0 2F30             146         POP.W   R4, R5
0000A2 D680             148         RET
                        151         ALIGN   1
                        153         PUBLIC  _otol
0000A4                  154 _otol:
0000A4 0F70             158         PUSH.W  R4, R5, R6
0000A6 A97C             160         ADDS.W  R7,#0CH
0000A8 866C42           167         MOV.B   ES,R3L
0000AB BA20             168         MOV.W   [R2],#00H
0000AD BC2002           169         MOV.W   [R2+2],#00H
0000B0 FE1A             171         BR      _20
0000B0 FE1A             171         BR      _20
0000B2                  172 _19:
0000B2 866C42           174         MOV.B   ES,R3L
0000B5 8A42             175         MOV.W   R4,[R2]
0000B7 8C5202           176         MOV.W   R5,[R2+2]
0000BA DD43             177         ASL.D   R4,#03H
0000BC 8C1F02           178         MOV.W   [R7+2],R1
0000BF 8A0F             179         MOV.W   [R7],R0
0000C1 862C42           180         MOV.B   ES,R1L
0000C4 82C0             181         MOV.B   R6L,[R0]
0000C6 90D9             182         SEXT.B  R6H
0000C8 99620030         183         SUB.W   R6,#030H
0000CC 8906             184         MOV.W   R0,R6
0000CE 9819             185         SEXT.W  R1
0000D0 0940             186         ADD.W   R4,R0
XA assembler v2.0 r2                    SN00085795-037 (c) 1998 TASKING, Inc.
                                                                                                                            Page   3

ADDR   CODE            LINE SOURCELINE
0000D2 1951             187         ADDC.W  R5,R1
0000D4 866C42           188         MOV.B   ES,R3L
0000D7 8A4A             189         MOV.W   [R2],R4
0000D9 8C5A02           190         MOV.W   [R2+2],R5
0000DC 8C1702           191         MOV.W   R1,[R7+2]
0000DF 8A07             192         MOV.W   R0,[R7]
0000E1 99000001         193         ADD.W   R0,#01H
0000E6                  195 _20:
0000E6 862C42           196         MOV.B   ES,R1L
0000E9 8280             197         MOV.B   R4L,[R0]
0000EB F2E3             198         BNE     _19
0000ED 910800           200         MOV.B   R0L,#00H
0000F0 A974             202         ADDS.W  R7,#04H
0000F2 2F70             204         POP.W   R4, R5, R6
0000F4 D680             206         RET
                        209         ALIGN   1
                        211         PUBLIC  _btol
0000F6                  212 _btol:
0000F6 0F70             216         PUSH.W  R4, R5, R6
0000F8 A97C             218         ADDS.W  R7,#0CH
0000FA 866C42           225         MOV.B   ES,R3L
0000FD BA20             226         MOV.W   [R2],#00H
0000FF BC2002           227         MOV.W   [R2+2],#00H
000102 FE1A             229         BR      _22
000102 FE1A             229         BR      _22
000104                  230 _21:
000104 866C42           232         MOV.B   ES,R3L
000107 8A42             233         MOV.W   R4,[R2]
000109 8C5202           234         MOV.W   R5,[R2+2]
00010C DD41             235         ASL.D   R4,#01H
00010E 8C1F02           236         MOV.W   [R7+2],R1
000111 8A0F             237         MOV.W   [R7],R0
000113 862C42           238         MOV.B   ES,R1L
000116 82C0             239         MOV.B   R6L,[R0]
000118 90D9             240         SEXT.B  R6H
00011A 99620030         241         SUB.W   R6,#030H
00011E 8906             242         MOV.W   R0,R6
000120 9819             243         SEXT.W  R1
000122 0940             244         ADD.W   R4,R0
000124 1951             245         ADDC.W  R5,R1
000126 866C42           246         MOV.B   ES,R3L
000129 8A4A             247         MOV.W   [R2],R4
00012B 8C5A02           248         MOV.W   [R2+2],R5
00012E 8C1702           249         MOV.W   R1,[R7+2]
000131 8A07             250         MOV.W   R0,[R7]
000133 99000001         251         ADD.W   R0,#01H
000138                  253 _22:
000138 862C42           254         MOV.B   ES,R1L
00013B 8280             255         MOV.B   R4L,[R0]
00013D F2E3             256         BNE     _21
00013F 910800           258         MOV.B   R0L,#00H
000142 A974             260         ADDS.W  R7,#04H
000144 2F70             262         POP.W   R4, R5, R6
000146 D680             264         RET
                        267         ALIGN   1
                        269         PUBLIC  _dwordtoa
000148                  270 _dwordtoa:
000148 0F70             274         PUSH.W  R4, R5, R6
00014A A978             276         ADDS.W  R7,#08H
00014C 8C3F06           280         MOV.W   [R7+6],R3
00014F 8C2F04           281         MOV.W   [R7+4],R2
000152 91D800           297         MOV.B   R6H,#00H
XA assembler v2.0 r2                    SN00085795-037 (c) 1998 TASKING, Inc.
                                                                                                                            Page   4

ADDR   CODE            LINE SOURCELINE
000155 91C800           299         MOV.B   R6L,#00H
000158 8931             302         MOV.W   R3,R1
00015A 8920             303         MOV.W   R2,R0
00015C 6910             304         OR.W    R1,R0
00015E F22B             307         BNE     _29
000160 8C1706           309         MOV.W   R1,[R7+6]
000163 8C0704           310         MOV.W   R0,[R7+4]
000166 862C42           311         MOV.B   ES,R1L
000169 920830           312         MOV.B   [R0],#030H
00016C 862C42           316         MOV.B   ES,R1L
00016F B40001           317         MOV.B   [R0+1],#00H
000172 FE5C             319         BR      _32
000174                  321 _28:
000174 B930             331         MOV.W   R3,#00H
000176 9928000A         332         MOV.W   R2,#0AH
00017A 8951             333         MOV.W   R5,R1
00017C 8940             334         MOV.W   R4,R0
00017E C4rrrrrr         335         FCALL   __UDIVL
000182 8C1F02           338         MOV.W   [R7+2],R1
000185 8A0F             339         MOV.W   [R7],R0
000187 8915             342         MOV.W   R1,R5
000189 8904             343         MOV.W   R0,R4
00018B B930             344         MOV.W   R3,#00H
00018D 9928000A         345         MOV.W   R2,#0AH
000191 C4rrrrrr         346         FCALL   __UMODL
000195 8180             350         MOV.B   R4L,R0L
000197 918030           351         ADD.B   R4L,#030H
00019A 810C             352         MOV.B   R0L,R6L
00019C 9019             353         SEXT.B  R0H
00019E 8920             354         MOV.W   R2,R0
0001A0 B930             355         MOVS.W  R3,#00H
0001A2 8C1706           356         MOV.W   R1,[R7+6]
0001A5 8C0704           357         MOV.W   R0,[R7+4]
0001A8 0902             358         ADD.W   R0,R2
0001AA 862C42           359         MOV.B   ES,R1L
0001AD 8288             360         MOV.B   [R0],R4L
0001AF A1C1             361         ADDS.B  R6L,#01H
0001B1 8C3702           365         MOV.W   R3,[R7+2]
0001B4 8A27             366         MOV.W   R2,[R7]
0001B6                  372 _29:
0001B6 8913             373         MOV.W   R1,R3
0001B8 8902             374         MOV.W   R0,R2
0001BA 6932             375         OR.W    R3,R2
0001BC F2DB             378         BNE     _28
0001BE 818C             380         MOV.B   R4L,R6L
0001C0 810C             381         MOV.B   R0L,R6L
0001C2 9019             382         SEXT.B  R0H
0001C4 B910             386         MOVS.W  R1,#00H
0001C6 8C3706           387         MOV.W   R3,[R7+6]
0001C9 8C2704           388         MOV.W   R2,[R7+4]
0001CC 0920             389         ADD.W   R2,R0
0001CE 866C42           390         MOV.B   ES,R3L
0001D1 B220             391         MOV.B   [R2],#00H
0001D3 A18F             392         ADDS.B  R4L,#0FH
0001D5 810D             395         MOV.B   R0L,R6H
0001D7 9019             396         SEXT.B  R0H
0001D9 9819             397         SEXT.W  R1
0001DB 8C3706           398         MOV.W   R3,[R7+6]
0001DE 8C2704           399         MOV.W   R2,[R7+4]
0001E1 0920             400         ADD.W   R2,R0
0001E3 8C3F02           401         MOV.W   [R7+2],R3
0001E6 8A2F             402         MOV.W   [R7],R2
XA assembler v2.0 r2                    SN00085795-037 (c) 1998 TASKING, Inc.
                                                                                                                            Page   5

ADDR   CODE            LINE SOURCELINE
0001E8 FE1F             405         BR      _31
0001E8 FE1F             405         BR      _31
0001EA                  406 _30:
0001EA 8148             408         MOV.B   R2L,R4L
0001EC 9059             409         SEXT.B  R2H
0001EE 9839             410         SEXT.W  R3
0001F0 8C1706           411         MOV.W   R1,[R7+6]
0001F3 8C0704           412         MOV.W   R0,[R7+4]
0001F6 0902             413         ADD.W   R0,R2
0001F8 8931             414         MOV.W   R3,R1
0001FA 8920             415         MOV.W   R2,R0
0001FC 862C42           416         MOV.B   ES,R1L
0001FF 8290             417         MOV.B   R4H,[R0]
000201 8C1702           420         MOV.W   R1,[R7+2]
000204 8A07             421         MOV.W   R0,[R7]
000206 862C42           422         MOV.B   ES,R1L
000209 8200             423         MOV.B   R0L,[R0]
00020B 866C42           424         MOV.B   ES,R3L
00020E 820A             425         MOV.B   [R2],R0L
000210 8C1702           427         MOV.W   R1,[R7+2]
000213 8A07             428         MOV.W   R0,[R7]
000215 862C42           429         MOV.B   ES,R1L
000218 8298             430         MOV.B   [R0],R4H
00021A A18F             434         ADDS.B  R4L,#0FH
00021C 99000001         438         ADD.W   R0,#01H
000220 8C1F02           440         MOV.W   [R7+2],R1
000223 8A0F             441         MOV.W   [R7],R0
000225 A1D1             443         ADDS.B  R6H,#01H
000228                  447 _31:
000228 418D             448         CMP.B   R4L,R6H
00022A FADF             449         BGE     _30
00022C                  451 _32:
00022C 99700008         453         ADD.W   R7,#08H
000230 2F70             455         POP.W   R4, R5, R6
000232 D680             457         RET
                        464         ALIGN   1
                        466         PUBLIC  _bytetohex
000234                  467 _bytetohex:
000234 0F70             471         PUSH.W  R4, R5, R6
000236 A97C             473         ADDS.W  R7,#0CH
000238 8C3F02           476         MOV.W   [R7+2],R3
00023B 8A2F             477         MOV.W   [R7],R2
00023D 912800           488         MOV.B   R1L,#00H
000240 B961             490         MOV.W   R6,#01H
000240 B961             490         MOV.W   R6,#01H
000242                  491 _34:
000242 8140             493         MOV.B   R2L,R0L
000244 E84110           494         DIVU.B  R2L,#010H
000247 D004             497         LSR.B   R0L,#04H
000249 8115             499         MOV.B   R0H,R2H
00024B 91540A           500         CMP.B   R2H,#0AH
00024E F00F             503         BCC     _35
000250 911030           505         ADD.B   R0H,#030H
000253 8142             507         MOV.B   R2L,R1L
000255 B150             508         MOVS.B  R2H,#00H
000257 8936             509         MOV.W   R3,R6
000259 2932             510         SUB.W   R3,R2
00025B 8923             511         MOV.W   R2,R3
00025D B930             512         MOVS.W  R3,#00H
00025F 8C5702           513         MOV.W   R5,[R7+2]
000262 8A47             514         MOV.W   R4,[R7]
000264 0942             515         ADD.W   R4,R2
XA assembler v2.0 r2                    SN00085795-037 (c) 1998 TASKING, Inc.
                                                                                                                            Page   6

ADDR   CODE            LINE SOURCELINE
000266 86AC42           516         MOV.B   ES,R5L
000269 821C             517         MOV.B   [R4],R0H
00026B FE0F             518         BR      _36
00026B FE0F00           518         BR      _36
00026E                  519 _35:
00026E 911037           521         ADD.B   R0H,#037H
000271 8142             522         MOV.B   R2L,R1L
000273 B150             523         MOVS.B  R2H,#00H
000275 8936             524         MOV.W   R3,R6
000277 2932             525         SUB.W   R3,R2
000279 8943             526         MOV.W   R4,R3
00027B B950             527         MOVS.W  R5,#00H
00027D 8C3702           528         MOV.W   R3,[R7+2]
000280 8A27             529         MOV.W   R2,[R7]
000282 0924             530         ADD.W   R2,R4
000284 866C42           531         MOV.B   ES,R3L
000287 821A             532         MOV.B   [R2],R0H
000287 821A00           532         MOV.B   [R2],R0H
00028A                  533 _36:
00028A A121             535         ADDS.B  R1L,#01H
00028C 912402           538         CMP.B   R1L,#02H
00028F F1D9             539         BCS     _34
000291 8C1702           541         MOV.W   R1,[R7+2]
000294 8A07             542         MOV.W   R0,[R7]
000296 862C42           543         MOV.B   ES,R1L
000299 B40002           544         MOV.B   [R0+2],#00H
00029C A974             549         ADDS.W  R7,#04H
00029E 2F70             551         POP.W   R4, R5, R6
0002A0 D680             553         RET
                        556         ALIGN   1
                        558         PUBLIC  _wordtohex
0002A2                  559 _wordtohex:
0002A2 0F70             563         PUSH.W  R4, R5, R6
0002A4 A97C             565         ADDS.W  R7,#0CH
0002A6 8C3F02           568         MOV.W   [R7+2],R3
0002A9 8A2F             569         MOV.W   [R7],R2
0002AB 913800           580         MOV.B   R1H,#00H
0002AE B963             582         MOV.W   R6,#03H
0002AE B963             582         MOV.W   R6,#03H
0002B0                  583 _39:
0002B0 8920             585         MOV.W   R2,R0
0002B2 7933             586         XOR.W   R3,R3
0002B4 E9210010         587         DIVU.D  R2,#010H
0002B8 D804             590         LSR.W   R0,#04H
0002BA 8126             592         MOV.B   R1L,R3L
0002BC 91640A           593         CMP.B   R3L,#0AH
0002BF F00E             596         BCC     _40
0002C1 912030           598         ADD.B   R1L,#030H
0002C4 8143             600         MOV.B   R2L,R1H
0002C6 B150             601         MOVS.B  R2H,#00H
0002C8 8946             602         MOV.W   R4,R6
0002CA 2942             603         SUB.W   R4,R2
0002CC B950             604         MOVS.W  R5,#00H
0002CE 8C3702           605         MOV.W   R3,[R7+2]
0002D1 8A27             606         MOV.W   R2,[R7]
0002D3 0924             607         ADD.W   R2,R4
0002D5 866C42           608         MOV.B   ES,R3L
0002D8 822A             609         MOV.B   [R2],R1L
0002DA FE0E             610         BR      _41
0002DA FE0E             610         BR      _41
0002DC                  611 _40:
0002DC 912037           613         ADD.B   R1L,#037H
XA assembler v2.0 r2                    SN00085795-037 (c) 1998 TASKING, Inc.
                                                                                                                            Page   7

ADDR   CODE            LINE SOURCELINE
0002DF 8143             614         MOV.B   R2L,R1H
0002E1 B150             615         MOVS.B  R2H,#00H
0002E3 8936             616         MOV.W   R3,R6
0002E5 2932             617         SUB.W   R3,R2
0002E7 8943             618         MOV.W   R4,R3
0002E9 B950             619         MOVS.W  R5,#00H
0002EB 8C3702           620         MOV.W   R3,[R7+2]
0002EE 8A27             621         MOV.W   R2,[R7]
0002F0 0924             622         ADD.W   R2,R4
0002F2 866C42           623         MOV.B   ES,R3L
0002F5 822A             624         MOV.B   [R2],R1L
0002F5 822A00           624         MOV.B   [R2],R1L
0002F8                  625 _41:
0002F8 A131             627         ADDS.B  R1H,#01H
0002FA 913404           630         CMP.B   R1H,#04H
0002FD F1D9             631         BCS     _39
0002FF 8C1702           633         MOV.W   R1,[R7+2]
000302 8A07             634         MOV.W   R0,[R7]
000304 862C42           635         MOV.B   ES,R1L
000307 B40004           636         MOV.B   [R0+4],#00H
00030A A974             641         ADDS.W  R7,#04H
00030C 2F70             643         POP.W   R4, R5, R6
00030E D680             645         RET
                        648         ALIGN   1
                        650         PUBLIC  _Cstrcmp
000310                  651 _Cstrcmp:
000310 0F70             657         PUSH.W  R4, R5, R6
000312                  666 _44:
000312 862C42           667         MOV.B   ES,R1L
000315 82C0             668         MOV.B   R6L,[R0]
000317 8953             669         MOV.W   R5,R3
000319 8942             670         MOV.W   R4,R2
00031B 86AC43           671         MOV.B   CS,R5L
00031E 80A4             672         MOVC.B  R5L,[R4+]
000320 818C             673         MOV.B   R4L,R6L
000322 218A             674         SUB.B   R4L,R5L
000324 99200001         675         ADD.W   R2,#01H
000328 99310000         676         ADDC.W  R3,#00H
00032C 8198             677         MOV.B   R4H,R4L
00032E F207             678         BNE     _45
000330 862C42           679         MOV.B   ES,R1L
000333 8290             680         MOV.B   R4H,[R0]
000335 99000001         681         ADD.W   R0,#01H
000339 6199             682         OR.B    R4H,R4H
00033B F2EB             683         BNE     _44
00033B F2EB00           683         BNE     _44
00033E                  684 _45:
00033E 8108             686         MOV.B   R0L,R4L
000340 9019             687         SEXT.B  R0H
000342 2F70             689         POP.W   R4, R5, R6
000344 D680             691         RET
                        695         EXTRN   HCODE(__UMODL)
                        696         EXTRN   HCODE(__UDIVL)
                        697         EXTRN   DATA(__lc_ub_xvwbuffer)
                        698         EXTRN   DATA(__lc_ue_xvwbuffer)
                        699         CALLS   'htol', 'HexToByte'
