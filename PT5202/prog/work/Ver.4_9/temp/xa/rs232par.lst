XA assembler v2.0 r2                    SN00085795-037 (c) 1998 TASKING, Inc.
                                                                                                                            Page   1
F:\PT5202\prog\work\Ver.4_9\temp\xa\rs232par.src
ADDR   CODE            LINE SOURCELINE
                          1 ; XA C compiler v2.0 r2                   SN00085795-Ccz (c) 1998 TASKING, Inc.
                          2 ; options: -A1 -Cxag3 -e -g -IcF:\PT5202\prog\include
                          3 ;          -IF:\PT5202\prog\rtxc\xa\include -I. -Ml -O2 -s
                          5 $NOZPAGE
                          6         NAME    RS232PAR
                         10 ; rs232par.c    1       /* MODULE:                                                               
                               */
                         11 ; rs232par.c    2       /*   r232par.c - RS232 command interpreter                               
                                                                                                                             
                                    */
                         12 ; rs232par.c    3       /************************************************************************
                            ****/
                         13 ; rs232par.c    4       /* FUNCTIONS:                                                            
                               */
                         14 ; rs232par.c    5       /*                                                                       
                               */
                         15 ; rs232par.c    6       /* TASKS:                                                                
                               */
                         16 ; rs232par.c    7       /*                                                                       
                               */
                         17 ; rs232par.c    8       /* NOTES:                                                                
                               */
                         18 ; rs232par.c    9       /*                                                                       
                               */
                         19 ; rs232par.c   10       /************************************************************************
                            ****/
                         20 ; rs232par.c   11       /*
                         21 ; rs232par.c   12        *   PTV software for PT5201
                         22 ; rs232par.c   13        *   Copyright (c) 
                         23 ; rs232par.c   14        *   ProTeleVision Technologies A/S.
                         24 ; rs232par.c   15        *   ALL RIGHTS RESERVED
                         25 ; rs232par.c   16       */
                         26 ; rs232par.c   17       /************************************************************************
                            ****/
                         27 ; rs232par.c   18       
                         28 ; rs232par.c   19       /************************************************************************
                            **/
                         29 ; rs232par.c   20       /* Include files:                                                        
                                                                                                                             
                                                                                                            */
                         30 ; rs232par.c   21       
                         31 ; rs232par.c   22       #include <ctype.h>
                         34 ; rs232par.c   23       #include <stdio.h>
                         55 ; rs232par.c   24       #include <math.h>
                         58 ; rs232par.c   25       #include <string.h>
                         61 ; rs232par.c   26       
                         62 ; rs232par.c   27       #include "define.h"
                         65 ; rs232par.c   28       #include "util.h"
                         68 ; rs232par.c   29       #include "rs232par.h"
                         71 ; rs232par.c   30       #include "rs232err.h"
                         74 ; rs232par.c   31       #include "rs232cmd.h"
                         79 ; rs232par.c   32       #include "rs232.h"
                        408 ; rs232par.c   33       
                        409 ; rs232par.c   34       #define StateP0                 0
                        410 ; rs232par.c   35       #define StateP1                 StateP0+1
                        411 ; rs232par.c   36       #define StateP2                 StateP1+1
                        412 ; rs232par.c   37       #define StateP3                 StateP2+1
                        413 ; rs232par.c   38       #define StateP4                 StateP3+1
                        414 ; rs232par.c   39       #define StateP5                 StateP4+1
                        415 ; rs232par.c   40       #define StateP6                 StateP5+1
                        416 ; rs232par.c   41       #define StateP7                 StateP6+1
                        417 ; rs232par.c   42       #define StateP8                 StateP7+1
XA assembler v2.0 r2                    SN00085795-037 (c) 1998 TASKING, Inc.
                                                                                                                            Page   2

ADDR   CODE            LINE SOURCELINE
                        418 ; rs232par.c   43       
                        419 ; rs232par.c   44       #define StateC0                 StateP8+1
                        420 ; rs232par.c   45       
                        421 ; rs232par.c   46       #define StateD0                 StateC0+1
                        422 ; rs232par.c   47       #define StateD1                 StateD0+1
                        423 ; rs232par.c   48       #define StateD2                 StateD1+1
                        424 ; rs232par.c   49       #define StateD3                 StateD2+1
                        425 ; rs232par.c   50       #define StateD4                 StateD3+1
                        426 ; rs232par.c   51       #define StateD5                 StateD4+1
                        427 ; rs232par.c   52       #define StateD6                 StateD5+1
                        428 ; rs232par.c   53       #define StateD7                 StateD6+1
                        429 ; rs232par.c   54       
                        430 ; rs232par.c   55       #define StateS0                 StateD7+1
                        431 ; rs232par.c   56       #define StateS1                 StateS0+1
                        432 ; rs232par.c   57       #define StateS2                 StateS1+1
                        433 ; rs232par.c   58       #define StateS3                 StateS2+1
                        434 ; rs232par.c   59       
                        435 ; rs232par.c   60       #define StateDA0                StateS3+1
                        436 ; rs232par.c   61       #define StateDA1                StateDA0+1
                        437 ; rs232par.c   62       #define StateDA2                StateDA1+1
                        438 ; rs232par.c   63       #define StateDA3                StateDA2+1
                        439 ; rs232par.c   64       #define StateDA4                StateDA3+1
                        440 ; rs232par.c   65       #define StateDA5                StateDA4+1
                        441 ; rs232par.c   66       
                        442 ; rs232par.c   67       #define StateA0                 StateDA5+1
                        443 ; rs232par.c   68       
                        444 ; rs232par.c   69       #define StateE0                 StateA0+1
                        445 ; rs232par.c   70       
                        446 ; rs232par.c   71       #define StateERROR      StateE0+1
                        447 ; rs232par.c   72       
                        448 ; rs232par.c   73       #define iswhitespace(c)         (((c) != 0x0A) && ((c) <= 0x20))
                        449 ; rs232par.c   74       #define isoctaldigit(c)         (((c) >= '0') && ((c) <= '7'))
                        450 ; rs232par.c   75       #define isbinarydigit(c)        (((c) == '0') || ((c) == '1'))
                        451 ; rs232par.c   76       #define iscolon(c)                              ((c) == ':')
                        452 ; rs232par.c   77       #define isasterix(c)                    ((c) == '*')
                        453 ; rs232par.c   78       #define issemicolon(c)          ((c) == ';')
                        454 ; rs232par.c   79       #define isquestionmark(c)       ((c) == '?')
                        455 ; rs232par.c   80       #define isunderscore(c)         ((c) == '_')
                        456 ; rs232par.c   81       #define isplussign(c)                   ((c) == '+')
                        457 ; rs232par.c   82       #define isminussign(c)          ((c) == '-')
                        458 ; rs232par.c   83       #define isslash(c)                              ((c) == '/')
                        459 ; rs232par.c   84       #define isdoubledagger(c)       ((c) == '#')
                        460 ; rs232par.c   85       #define isdot(c)                                        ((c) == '.')
                        461 ; rs232par.c   86       #define iscomma(c)                              ((c) == ',')
                        462 ; rs232par.c   87       #define isquote(c)                              ((c) == '\'')
                        463 ; rs232par.c   88       #define isdoublequote(c)        ((c) == '\"')
                        464 ; rs232par.c   89       #define isnewline(c)                    ((c) == 0x0A)           // Newlin
                            e is Linefeed
                        465 ; rs232par.c   90       
                        466 ; rs232par.c   91       enum CmdStates  { Idle = 0, NextLevel, Ready, PMUS, PMT, Error };
                        467 ; rs232par.c   92       
                        468 ; rs232par.c   93       bit NewCmdExecuted;
                        469 ; rs232par.c   94       bit CmdRequest, CmdExecute;
                        470 ; rs232par.c   95       
                        471 ; rs232par.c   96       UC ResponseReceived;
                        472 ; rs232par.c   97       
                        473 ; rs232par.c   98       char Cmd[512];
                        474 ; rs232par.c   99       UI CmdNdx;
                        475 ; rs232par.c  100       
                        476 ; rs232par.c  101       UI NumSuffix;
                        477 ; rs232par.c  102       
                        478 ; rs232par.c  103       UC ParCnt;
XA assembler v2.0 r2                    SN00085795-037 (c) 1998 TASKING, Inc.
                                                                                                                            Page   3

ADDR   CODE            LINE SOURCELINE
                        479 ; rs232par.c  104       UC ParType[10];
                        480 ; rs232par.c  105       
                        481 ; rs232par.c  106       static struct CMD_STRUCT code* CmdPtr = &Subsystem[0];
000000                  482 RS232PAR_INI_FA SEGMENT HDATA INSEGMENT INIT
000000                  483         RSEG    RS232PAR_INI_FA
                        502         ALIGN   1
000000                  503 _CmdPtr:
                        504 ; rs232par.c  107       static struct CMD_STRUCT code* CmdLevelPtr = &Subsystem[0];
000000 rrrrrrrrrrrrrr   505         DD      _Subsystem
       rr                   
                        507         ALIGN   1
000004                  508 _CmdLevelPtr:
                        509 ; rs232par.c  108       
                        510 ; rs232par.c  109       static UC State = StateP0;
000004 rrrrrrrrrrrrrr   511         DD      _Subsystem
       rr                   
                        513 ; rs232par.c  110       
                        514 ; rs232par.c  111       static UI NoOfBytes;
                        515 ; rs232par.c  112       static UC NoOfDigits;
                        516 ; rs232par.c  113       
                        517 ; rs232par.c  114       /************************************************************************
                            **/
                        518 ; rs232par.c  115       /* CmdSyntax                                                             
                                                                                                                             
                                                             RS232PAR.C     */
                        519 ; rs232par.c  116       /*                                                                       
                                                                                                                             
                                                                                                                             
                                                    */
                        520 ; rs232par.c  117       /* Author:              Kim Engedahl, DEV, 941124                        
                                                                                                                             
                                    */
                        521 ; rs232par.c  118       /* Revised:             000414                                           
                                                                                                                             
                                                                                    */
                        522 ; rs232par.c  119       /*                                                                       
                                                                                                                             
                                                                                                                             
                                                    */
                        523 ; rs232par.c  120       /* Function:    --                                                       
                                                                                                                             
                                                                                                            */
                        524 ; rs232par.c  121       /* Remarks:             --                                               
                                                                                                                             
                                                                                                                    */
                        525 ; rs232par.c  122       /* Returns:             Command state                                    
                                                                                                                             
                                                                                    */
                        526 ; rs232par.c  123       /* Updates:             --                                               
                                                                                                                             
                                                                                                                    */
                        527 ; rs232par.c  124       /************************************************************************
                            **/
                        528 ; rs232par.c  125       char CmdSyntax( char c)
                        529 ; rs232par.c  126       {
000008 00               530 _State: DB      000H
000000                  531 RS232PAR_PR     SEGMENT HCODE
000000                  532         RSEG    RS232PAR_PR
                        533         ALIGN   1
                        535         PUBLIC  _CmdSyntax
000000                  536 _CmdSyntax:
000000 0F30             540         PUSH.W  R4, R5
XA assembler v2.0 r2                    SN00085795-037 (c) 1998 TASKING, Inc.
                                                                                                                            Page   4

ADDR   CODE            LINE SOURCELINE
000002 A97C             542         ADDS.W  R7,#0CH
                        549 ; rs232par.c  127               char c_str;
                        550 ; rs232par.c  128       
                        551 ; rs232par.c  129               c_str = c;
                        552 ; rs232par.c  130               c = toupper( c);
000004 8190             554         MOV.B   R4H,R0L
000006 8109             555         MOV.B   R0L,R4H
000008 9019             556         SEXT.B  R0H
000000                  561 RS232PAR_IR     SEGMENT HCODE INSEGMENT ROMDATA
000000                  562         RSEG    RS232PAR_IR
                        563         ALIGN   1
000000                  564 __swtable385:
000000 rrrrrrrrrrrrrr   565         DW      SOF _11,SEG _11
       rrrrrrrrrrrrrr       
       rrrr                 
000004 rrrrrrrrrrrrrr   566         DW      SOF _17,SEG _17
       rrrrrrrrrrrrrr       
       rrrr                 
000008 rrrrrrrrrrrrrr   567         DW      SOF _19,SEG _19
       rrrrrrrrrrrrrr       
       rrrr                 
00000C rrrrrrrrrrrrrr   568         DW      SOF _31,SEG _31
       rrrrrrrrrrrrrr       
       rrrr                 
000010 rrrrrrrrrrrrrr   569         DW      SOF _33,SEG _33
       rrrrrrrrrrrrrr       
       rrrr                 
000014 rrrrrrrrrrrrrr   570         DW      SOF _43,SEG _43
       rrrrrrrrrrrrrr       
       rrrr                 
000018 rrrrrrrrrrrrrr   571         DW      SOF _48,SEG _48
       rrrrrrrrrrrrrr       
       rrrr                 
00001C rrrrrrrrrrrrrr   572         DW      SOF _62,SEG _62
       rrrrrrrrrrrrrr       
       rrrr                 
000020 rrrrrrrrrrrrrr   573         DW      SOF _68,SEG _68
       rrrrrrrrrrrrrr       
       rrrr                 
000024 rrrrrrrrrrrrrr   574         DW      SOF _80,SEG _80
       rrrrrrrrrrrrrr       
       rrrr                 
000028 rrrrrrrrrrrrrr   575         DW      SOF _90,SEG _90
       rrrrrrrrrrrrrr       
       rrrr                 
00002C rrrrrrrrrrrrrr   576         DW      SOF _93,SEG _93
       rrrrrrrrrrrrrr       
       rrrr                 
000030 rrrrrrrrrrrrrr   577         DW      SOF _96,SEG _96
       rrrrrrrrrrrrrr       
       rrrr                 
000034 rrrrrrrrrrrrrr   578         DW      SOF _108,SEG _108
       rrrrrrrrrrrrrr       
       rrrr                 
000038 rrrrrrrrrrrrrr   579         DW      SOF _118,SEG _118
       rrrrrrrrrrrrrr       
       rrrr                 
00003C rrrrrrrrrrrrrr   580         DW      SOF _126,SEG _126
       rrrrrrrrrrrrrr       
       rrrr                 
XA assembler v2.0 r2                    SN00085795-037 (c) 1998 TASKING, Inc.
                                                                                                                            Page   5

ADDR   CODE            LINE SOURCELINE
000040 rrrrrrrrrrrrrr   581         DW      SOF _134,SEG _134
       rrrrrrrrrrrrrr       
       rrrr                 
000044 rrrrrrrrrrrrrr   582         DW      SOF _137,SEG _137
       rrrrrrrrrrrrrr       
       rrrr                 
000048 rrrrrrrrrrrrrr   583         DW      SOF _145,SEG _145
       rrrrrrrrrrrrrr       
       rrrr                 
00004C rrrrrrrrrrrrrr   584         DW      SOF _147,SEG _147
       rrrrrrrrrrrrrr       
       rrrr                 
000050 rrrrrrrrrrrrrr   585         DW      SOF _154,SEG _154
       rrrrrrrrrrrrrr       
       rrrr                 
000054 rrrrrrrrrrrrrr   586         DW      SOF _156,SEG _156
       rrrrrrrrrrrrrr       
       rrrr                 
000058 rrrrrrrrrrrrrr   587         DW      SOF _163,SEG _163
       rrrrrrrrrrrrrr       
       rrrr                 
00005C rrrrrrrrrrrrrr   588         DW      SOF _169,SEG _169
       rrrrrrrrrrrrrr       
       rrrr                 
000060 rrrrrrrrrrrrrr   589         DW      SOF _176,SEG _176
       rrrrrrrrrrrrrr       
       rrrr                 
000064 rrrrrrrrrrrrrr   590         DW      SOF _184,SEG _184
       rrrrrrrrrrrrrr       
       rrrr                 
000068 rrrrrrrrrrrrrr   591         DW      SOF _192,SEG _192
       rrrrrrrrrrrrrr       
       rrrr                 
00006C rrrrrrrrrrrrrr   592         DW      SOF _201,SEG _201
       rrrrrrrrrrrrrr       
       rrrr                 
000070 rrrrrrrrrrrrrr   593         DW      SOF _203,SEG _203
       rrrrrrrrrrrrrr       
       rrrr                 
000074 rrrrrrrrrrrrrr   594         DW      SOF _205,SEG _205
       rrrrrrrrrrrrrr       
       rrrr                 
000078 rrrrrrrrrrrrrr   595         DW      SOF _206,SEG _206
       rrrrrrrrrrrrrr       
       rrrr                 
00000A                  596         RSEG    RS232PAR_PR
                        597         CALL    _toupper
00000A C4rrrrrr        +597 ;       FCALL   _toupper
00000E 8950             598         MOV.W   R5,R0
                        604 ; rs232par.c  131       
                        605 ; rs232par.c  132               switch ( rs232GetLastError())
                        607         CALL    _rs232GetLastError
000010 C4rrrrrr        +607 ;       FCALL   _rs232GetLastError
000014 99040000         608         CMP.W   R0,#00H
000018 F33D             609         BEQ     _10
00001A 99040002         610         CMP.W   R0,#02H
00001E F307             611         BEQ     _3
000020 99040001         612         CMP.W   R0,#01H
000024 F311             613         BEQ     _4
000026 99040008         614         CMP.W   R0,#08H
00002A F31B             615         BEQ     _5
00002C FE27             616         BR      _6
XA assembler v2.0 r2                    SN00085795-037 (c) 1998 TASKING, Inc.
                                                                                                                            Page   6

ADDR   CODE            LINE SOURCELINE
                        617 ; rs232par.c  133               {
                        618 ; rs232par.c  134                       case ERR_NONE:
                        619 ; rs232par.c  135                               break;
                        620 ; rs232par.c  136       
                        621 ; rs232par.c  137                       case ERR_OVERFLOW:
00002E                  623 _3:
                        624 ; rs232par.c  138                               SCPIError = InputBufferOverrun;
00002E 964842rr         626         MOV.B   ES,#SEG( _SCPIError )
000032 9908rrrr         627         MOV.W   R0,#SOF( _SCPIError )
000036 9A08002B         628         MOV.W   [R0],#02BH
                        629 ; rs232par.c  139                               State = StateERROR;
00003A 964842rr         631         MOV.B   ES,#SEG( _State )
00003E 9908rrrr         632         MOV.W   R0,#SOF( _State )
000042 92081E           633         MOV.B   [R0],#01EH
                        634 ; rs232par.c  140                               break;
000045 FE27             636         BR      _10
                        637 ; rs232par.c  141       
                        638 ; rs232par.c  142                       case ERR_PARITY:
000048                  640 _4:
                        641 ; rs232par.c  143                               SCPIError = ParityErrInMessage;
000048 964842rr         643         MOV.B   ES,#SEG( _SCPIError )
00004C 9908rrrr         644         MOV.W   R0,#SOF( _SCPIError )
000050 9A080029         645         MOV.W   [R0],#029H
                        646 ; rs232par.c  144                               State = StateERROR;
000054 964842rr         648         MOV.B   ES,#SEG( _State )
000058 9908rrrr         649         MOV.W   R0,#SOF( _State )
00005C 92081E           650         MOV.B   [R0],#01EH
                        651 ; rs232par.c  145                               break;
00005F FE1A             653         BR      _10
                        654 ; rs232par.c  146       
                        655 ; rs232par.c  147                       case ERR_FRAMING:
000062                  657 _5:
                        658 ; rs232par.c  148                               SCPIError = FramingErrInMessage;
000062 964842rr         660         MOV.B   ES,#SEG( _SCPIError )
000066 9908rrrr         661         MOV.W   R0,#SOF( _SCPIError )
00006A 9A08002A         662         MOV.W   [R0],#02AH
                        663 ; rs232par.c  149                               State = StateERROR;
00006E 964842rr         665         MOV.B   ES,#SEG( _State )
000072 9908rrrr         666         MOV.W   R0,#SOF( _State )
000076 92081E           667         MOV.B   [R0],#01EH
                        668 ; rs232par.c  150                               break;
000079 FE0D             670         BR      _10
                        671 ; rs232par.c  151       
                        672 ; rs232par.c  152                       default:
00007C                  674 _6:
                        675 ; rs232par.c  153                               SCPIError = CommunicationErr;
00007C 964842rr         677         MOV.B   ES,#SEG( _SCPIError )
000080 9908rrrr         678         MOV.W   R0,#SOF( _SCPIError )
000084 9A080028         679         MOV.W   [R0],#028H
                        680 ; rs232par.c  154                               State = StateERROR;
000088 964842rr         682         MOV.B   ES,#SEG( _State )
00008C 9908rrrr         683         MOV.W   R0,#SOF( _State )
000090 92081E           684         MOV.B   [R0],#01EH
                        685 ; rs232par.c  155                               break;
                        686 ; rs232par.c  156               }
000094                  688 _10:
                        689 ; rs232par.c  157       
                        690 ; rs232par.c  158               switch ( State)
000094 964842rr         692         MOV.B   ES,#SEG( _State )
000098 9908rrrr         693         MOV.W   R0,#SOF( _State )
00009C 8220             694         MOV.B   R1L,[R0]
00009E 91241E           695         CMP.B   R1L,#01EH
XA assembler v2.0 r2                    SN00085795-037 (c) 1998 TASKING, Inc.
                                                                                                                            Page   7

ADDR   CODE            LINE SOURCELINE
                        696         BG      _329
0000A1 F902            +696 ;       BL      _LG_8
0000A3 D5110A          +696 ;       JMP.L   _329
0000A3 D5110A          +696 ;       JMP.L   _329
0000A6                 +696 _LG_8:
0000A6 7133             697         XOR.B   R1H,R1H
0000A8 D912             698         ASL.W   R1,#02H
0000AA 964843rr         699         MOV.B   CS,#SEG( __swtable385 )
0000AE 9910rrrr         700         ADD.W   R1,#SOF( __swtable385 )
0000B2 8801             701         MOVC.W  R0,[R1+]
0000B4 0F01             702         PUSH.W  R0
0000B6 8801             703         MOVC.W  R0,[R1+]
0000B8 0F01             704         PUSH.W  R0
0000BA D680             705         RET
                        706 ; rs232par.c  159               {
                        707 ; rs232par.c  160                       case StateP0:                                            
                                     // COMMAND PROGRAM DATA
0000BC                  709 _11:
                        710 ; rs232par.c  161                               SCPIError = NoErr;
0000BC B940             712         MOV.W   R4,#00H
0000BE 964842rr         713         MOV.B   ES,#SEG( _SCPIError )
0000C2 9908rrrr         714         MOV.W   R0,#SOF( _SCPIError )
0000C6 BA00             715         MOV.W   [R0],#00H
                        716 ; rs232par.c  162                               CmdExecute = CmdRequest = FALSE;
0000C8 912800           718         MOV.B   R1L,#00H
0000CB 964842rr         719         MOV.B   ES,#SEG( _CmdRequest )
0000CF 9908rrrr         720         MOV.W   R0,#SOF( _CmdRequest )
0000D3 B200             721         MOV.B   [R0],#00H
0000D5 964842rr         722         MOV.B   ES,#SEG( _CmdExecute )
0000D9 9908rrrr         723         MOV.W   R0,#SOF( _CmdExecute )
0000DD 8228             724         MOV.B   [R0],R1L
                        725 ; rs232par.c  163                               ParType[ParCnt = 0] = P_NoParameter;
0000DF 964842rr         727         MOV.B   ES,#SEG( _ParCnt )
0000E3 9908rrrr         728         MOV.W   R0,#SOF( _ParCnt )
0000E7 8228             729         MOV.B   [R0],R1L
0000E9 8142             730         MOV.B   R2L,R1L
0000EB 9059             731         SEXT.B  R2H
0000ED 9839             732         SEXT.W  R3
0000EF 964842rr         733         MOV.B   ES,#SEG( _ParType )
0000F3 852Arrrr         734         MOV.B   [R2+SOF( _ParType )],R1L
                        735 ; rs232par.c  164       
                        736 ; rs232par.c  165                               if ( iswhitespace(c) || issemicolon(c))
0000F7 91A40A           738         CMP.B   R5L,#0AH
0000FA F304             739         BEQ     _12
0000FC 91A420           740         CMP.B   R5L,#020H
                        741         BLE     _329
0000FF FC02            +741 ;       BGT     _LG_12
000101 D510DB          +741 ;       JMP.L   _329
000101 D510DB          +741 ;       JMP.L   _329
000104                 +741 _LG_12:
000104                 +741 _LG_12:
000104                  742 _12:
000104 91A43B           743         CMP.B   R5L,#03BH
                        744         BEQ     _329
000107 F202            +744 ;       BNE     _LG_14
000109 D510D7          +744 ;       JMP.L   _329
000109 D510D7          +744 ;       JMP.L   _329
00010C                 +744 _LG_14:
                        745 ; rs232par.c  166                                       break;
                        746 ; rs232par.c  167       
                        747 ; rs232par.c  168                               if ( isalpha(c))
00010C 814A             749         MOV.B   R2L,R5L
XA assembler v2.0 r2                    SN00085795-037 (c) 1998 TASKING, Inc.
                                                                                                                            Page   8

ADDR   CODE            LINE SOURCELINE
00010E 9059             750         SEXT.B  R2H
000110 9839             751         SEXT.W  R3
000112 964842rr         752         MOV.B   ES,#SEG( __ctype_+1 )
000116 8502rrrr         753         MOV.B   R0L,[R2+SOF( __ctype_+1 )]
00011A 9019             754         SEXT.B  R0H
00011C 99050003         755         AND.W   R0,#03H
000120 F323             756         BEQ     _13
                        757 ; rs232par.c  169                               {
                        758 ; rs232par.c  170                                       Cmd[CmdNdx = 0] = c;
000122 964842rr         760         MOV.B   ES,#SEG( _CmdNdx )
000126 9908rrrr         761         MOV.W   R0,#SOF( _CmdNdx )
00012A 8A48             762         MOV.W   [R0],R4
00012C 8904             763         MOV.W   R0,R4
00012E 9819             764         SEXT.W  R1
000130 964842rr         765         MOV.B   ES,#SEG( _Cmd )
000134 85A8rrrr         766         MOV.B   [R0+SOF( _Cmd )],R5L
                        767 ; rs232par.c  171                                       NumSuffix = 0;
000138 964842rr         769         MOV.B   ES,#SEG( _NumSuffix )
00013C 9908rrrr         770         MOV.W   R0,#SOF( _NumSuffix )
000140 BA00             771         MOV.W   [R0],#00H
                        772 ; rs232par.c  172                                       State = StateP2;
000142 964842rr         774         MOV.B   ES,#SEG( _State )
000146 9908rrrr         775         MOV.W   R0,#SOF( _State )
00014A B202             776         MOV.B   [R0],#02H
                        777 ; rs232par.c  173                                       CmdPtr = CmdLevelPtr;
00014C 964842rr         779         MOV.B   ES,#SEG( _CmdLevelPtr )
000150 9918rrrr         780         MOV.W   R1,#SOF( _CmdLevelPtr )
000154 8B01             781         MOV.W   R0,[R1+]
000156 8A11             782         MOV.W   R1,[R1]
000158 964842rr         783         MOV.B   ES,#SEG( _CmdPtr )
00015C 9928rrrr         784         MOV.W   R2,#SOF( _CmdPtr )
000160 8B0A             785         MOV.W   [R2+],R0
000162 8A1A             786         MOV.W   [R2],R1
                        787 ; rs232par.c  174                                       break;
                        789         BR      _329
000164 D510AA          +789         JMP.L   _329
                        790 ; rs232par.c  175                               }
000168                  792 _13:
                        794 ; rs232par.c  176       
                        795 ; rs232par.c  177                               if ( iscolon(c))
000168 91A43A           797         CMP.B   R5L,#03AH
00016B F217             798         BNE     _14
                        799 ; rs232par.c  178                               {
                        800 ; rs232par.c  179                                       State = StateP1;
00016D 964842rr         802         MOV.B   ES,#SEG( _State )
000171 9908rrrr         803         MOV.W   R0,#SOF( _State )
000175 B201             804         MOV.B   [R0],#01H
                        805 ; rs232par.c  180                                       CmdPtr = CmdLevelPtr = &Subsystem[0];
000177 964842rr         807         MOV.B   ES,#SEG( _CmdLevelPtr )
00017B 9908rrrr         808         MOV.W   R0,#SOF( _CmdLevelPtr )
00017F 9B08rrrr         809         MOV.W   [R0+],#SOF( _Subsystem )
000183 9A08rrrr         810         MOV.W   [R0],#SEG( _Subsystem )
000187 964842rr         811         MOV.B   ES,#SEG( _CmdPtr )
00018B 9908rrrr         812         MOV.W   R0,#SOF( _CmdPtr )
00018F 9B08rrrr         813         MOV.W   [R0+],#SOF( _Subsystem )
000193 9A08rrrr         814         MOV.W   [R0],#SEG( _Subsystem )
                        815 ; rs232par.c  181                                       break;
                        817         BR      _329
000197 D51090          +817         JMP.L   _329
                        818 ; rs232par.c  182                               }
00019A                  820 _14:
                        821 ; rs232par.c  183       
XA assembler v2.0 r2                    SN00085795-037 (c) 1998 TASKING, Inc.
                                                                                                                            Page   9

ADDR   CODE            LINE SOURCELINE
                        822 ; rs232par.c  184                               if ( isasterix(c))
00019A 91A42A           824         CMP.B   R5L,#02AH
00019D F226             825         BNE     _15
                        826 ; rs232par.c  185                               {
                        827 ; rs232par.c  186                                       Cmd[CmdNdx = 0] = c;
00019F 964842rr         829         MOV.B   ES,#SEG( _CmdNdx )
0001A3 9908rrrr         830         MOV.W   R0,#SOF( _CmdNdx )
0001A7 8A48             831         MOV.W   [R0],R4
0001A9 8904             832         MOV.W   R0,R4
0001AB 9819             833         SEXT.W  R1
0001AD 964842rr         834         MOV.B   ES,#SEG( _Cmd )
0001B1 85A8rrrr         835         MOV.B   [R0+SOF( _Cmd )],R5L
                        836 ; rs232par.c  187                                       State = StateP3;
0001B5 964842rr         838         MOV.B   ES,#SEG( _State )
0001B9 9908rrrr         839         MOV.W   R0,#SOF( _State )
0001BD B203             840         MOV.B   [R0],#03H
                        841 ; rs232par.c  188                                       CmdLevelPtr = CmdPtr;
0001BF 964842rr         843         MOV.B   ES,#SEG( _CmdPtr )
0001C3 9918rrrr         844         MOV.W   R1,#SOF( _CmdPtr )
0001C7 8B01             845         MOV.W   R0,[R1+]
0001C9 8A11             846         MOV.W   R1,[R1]
0001CB 964842rr         847         MOV.B   ES,#SEG( _CmdLevelPtr )
0001CF 9928rrrr         848         MOV.W   R2,#SOF( _CmdLevelPtr )
0001D3 8B0A             849         MOV.W   [R2+],R0
0001D5 8A1A             850         MOV.W   [R2],R1
                        851 ; rs232par.c  189                                       CmdPtr = &Mandated[0];
0001D7 964842rr         853         MOV.B   ES,#SEG( _CmdPtr )
0001DB 9908rrrr         854         MOV.W   R0,#SOF( _CmdPtr )
0001DF 9B08rrrr         855         MOV.W   [R0+],#SOF( _Mandated )
0001E3 9A08rrrr         856         MOV.W   [R0],#SEG( _Mandated )
                        857 ; rs232par.c  190                                       break;
                        859         BR      _329
0001E7 D51068          +859         JMP.L   _329
                        860 ; rs232par.c  191                               }
0001EA                  862 _15:
                        863 ; rs232par.c  192       
                        864 ; rs232par.c  193                               if ( isnewline(c))
0001EA 91A40A           866         CMP.B   R5L,#0AH
0001ED F224             867         BNE     _16
                        868 ; rs232par.c  194                               {
                        869 ; rs232par.c  195                                       Cmd[CmdNdx = 0] = 0;
0001EF 964842rr         871         MOV.B   ES,#SEG( _CmdNdx )
0001F3 9908rrrr         872         MOV.W   R0,#SOF( _CmdNdx )
0001F7 8A48             873         MOV.W   [R0],R4
0001F9 8944             874         MOV.W   R4,R4
0001FB 9859             875         SEXT.W  R5
0001FD 964842rr         876         MOV.B   ES,#SEG( _Cmd )
000201 852Crrrr         877         MOV.B   [R4+SOF( _Cmd )],R1L
                        878 ; rs232par.c  196                                       State = StateP0;
000205 964842rr         880         MOV.B   ES,#SEG( _State )
000209 9908rrrr         881         MOV.W   R0,#SOF( _State )
00020D B200             882         MOV.B   [R0],#00H
                        883 ; rs232par.c  197                                       CmdPtr = CmdLevelPtr = &Subsystem[0];
00020F 964842rr         885         MOV.B   ES,#SEG( _CmdLevelPtr )
000213 9908rrrr         886         MOV.W   R0,#SOF( _CmdLevelPtr )
000217 9B08rrrr         887         MOV.W   [R0+],#SOF( _Subsystem )
00021B 9A08rrrr         888         MOV.W   [R0],#SEG( _Subsystem )
00021F 964842rr         889         MOV.B   ES,#SEG( _CmdPtr )
000223 9908rrrr         890         MOV.W   R0,#SOF( _CmdPtr )
000227 9B08rrrr         891         MOV.W   [R0+],#SOF( _Subsystem )
00022B 9A08rrrr         892         MOV.W   [R0],#SEG( _Subsystem )
                        893 ; rs232par.c  198                                       return( PMT);
XA assembler v2.0 r2                    SN00085795-037 (c) 1998 TASKING, Inc.
                                                                                                                            Page  10

ADDR   CODE            LINE SOURCELINE
00022F 910804           895         MOV.B   R0L,#04H
                        896         BR      _384
000232 D5104F          +896         JMP.L   _384
                        897 ; rs232par.c  199                               }
000236                  899 _16:
                        900 ; rs232par.c  200       
                        901 ; rs232par.c  201                               SCPIError = InvalidChar;
000236 964842rr         903         MOV.B   ES,#SEG( _SCPIError )
00023A 9908rrrr         904         MOV.W   R0,#SOF( _SCPIError )
00023E BA02             905         MOV.W   [R0],#02H
                        906 ; rs232par.c  202                               State = StateERROR;
000240 964842rr         908         MOV.B   ES,#SEG( _State )
000244 9908rrrr         909         MOV.W   R0,#SOF( _State )
000248 92081E           910         MOV.B   [R0],#01EH
                        911 ; rs232par.c  203                               break;
                        913         BR      _329
00024B D51036          +913         JMP.L   _329
                        914 ; rs232par.c  204       
                        915 ; rs232par.c  205                       case StateP1:
00024E                  917 _17:
                        918 ; rs232par.c  206                               if ( isalpha(c))
00024E 810A             920         MOV.B   R0L,R5L
000250 9019             921         SEXT.B  R0H
000252 9819             922         SEXT.W  R1
000254 964842rr         923         MOV.B   ES,#SEG( __ctype_+1 )
000258 8500rrrr         924         MOV.B   R0L,[R0+SOF( __ctype_+1 )]
00025C 9019             925         SEXT.B  R0H
00025E 99050003         926         AND.W   R0,#03H
000262 F318             927         BEQ     _18
                        928 ; rs232par.c  207                               {
                        929 ; rs232par.c  208                                       Cmd[CmdNdx = 0] = c;
000264 B910             931         MOV.W   R1,#00H
000266 964842rr         932         MOV.B   ES,#SEG( _CmdNdx )
00026A 9908rrrr         933         MOV.W   R0,#SOF( _CmdNdx )
00026E BA00             934         MOV.W   [R0],#00H
000270 8921             935         MOV.W   R2,R1
000272 B930             936         MOVS.W  R3,#00H
000274 964842rr         937         MOV.B   ES,#SEG( _Cmd )
000278 85AArrrr         938         MOV.B   [R2+SOF( _Cmd )],R5L
                        939 ; rs232par.c  209                                       NumSuffix = 0;
00027C 964842rr         941         MOV.B   ES,#SEG( _NumSuffix )
000280 9908rrrr         942         MOV.W   R0,#SOF( _NumSuffix )
000284 BA00             943         MOV.W   [R0],#00H
                        944 ; rs232par.c  210                                       State = StateP2;
000286 964842rr         946         MOV.B   ES,#SEG( _State )
00028A 9908rrrr         947         MOV.W   R0,#SOF( _State )
00028E B202             948         MOV.B   [R0],#02H
                        949 ; rs232par.c  211                                       break;
                        951         BR      _329
000290 D51014          +951         JMP.L   _329
                        952 ; rs232par.c  212                               }
000294                  954 _18:
                        955 ; rs232par.c  213       
                        956 ; rs232par.c  214                               SCPIError = InvalidChar;
000294 964842rr         958         MOV.B   ES,#SEG( _SCPIError )
000298 9908rrrr         959         MOV.W   R0,#SOF( _SCPIError )
00029C BA02             960         MOV.W   [R0],#02H
                        961 ; rs232par.c  215                               State = StateERROR;
00029E 964842rr         963         MOV.B   ES,#SEG( _State )
0002A2 9908rrrr         964         MOV.W   R0,#SOF( _State )
0002A6 92081E           965         MOV.B   [R0],#01EH
                        966 ; rs232par.c  216                               break;
XA assembler v2.0 r2                    SN00085795-037 (c) 1998 TASKING, Inc.
                                                                                                                            Page  11

ADDR   CODE            LINE SOURCELINE
                        968         BR      _329
0002A9 D51007          +968         JMP.L   _329
                        969 ; rs232par.c  217       
                        970 ; rs232par.c  218                       case StateP2:
0002AC                  972 _19:
                        973 ; rs232par.c  219                               if ( iswhitespace( c))
0002AC 91A40A           975         CMP.B   R5L,#0AH
0002AF F31C             976         BEQ     _21
0002B1 91A420           977         CMP.B   R5L,#020H
0002B4 FC19             978         BGT     _21
                        979 ; rs232par.c  220                               {
                        980 ; rs232par.c  221                                       Cmd[++CmdNdx] = 0;
0002B6 964842rr         982         MOV.B   ES,#SEG( _CmdNdx )
0002BA 9908rrrr         983         MOV.W   R0,#SOF( _CmdNdx )
0002BE 8A00             984         MOV.W   R0,[R0]
0002C0 A901             985         ADDS.W  R0,#01H
0002C2 8920             986         MOV.W   R2,R0
0002C4 B930             987         MOVS.W  R3,#00H
0002C6 964842rr         988         MOV.B   ES,#SEG( _CmdNdx )
0002CA 9918rrrr         989         MOV.W   R1,#SOF( _CmdNdx )
0002CE 8A09             990         MOV.W   [R1],R0
0002D0 964842rr         991         MOV.B   ES,#SEG( _Cmd )
0002D4 B520rrrr         992         MOV.B   [R2+SOF( _Cmd )],#00H
                        993 ; rs232par.c  222                                       State = StateP6;
0002D8 964842rr         995         MOV.B   ES,#SEG( _State )
0002DC 9908rrrr         996         MOV.W   R0,#SOF( _State )
0002E0 B206             997         MOV.B   [R0],#06H
                        998 ; rs232par.c  223                                       return( Ready);
0002E2 910802          1000         MOV.B   R0L,#02H
                       1001         BR      _384
0002E5 D50FF5         +1001         JMP.L   _384
                       1002 ; rs232par.c  224                               }
0002E8                 1004 _21:
                       1005 ; rs232par.c  225       
                       1006 ; rs232par.c  226                               if ( isalpha(c) || isunderscore(c) || isdigit(c))
                            
0002E8 810A            1008         MOV.B   R0L,R5L
0002EA 9019            1009         SEXT.B  R0H
0002EC 9819            1010         SEXT.W  R1
0002EE 9938rrrr        1011         MOV.W   R3,#SEG( __ctype_+1 )
0002F2 9928rrrr        1012         MOV.W   R2,#SOF( __ctype_+1 )
0002F6 0920            1013         ADD.W   R2,R0
0002F8 8C3F02          1014         MOV.W   [R7+2],R3
0002FB 8A2F            1015         MOV.W   [R7],R2
0002FD 964842rr        1016         MOV.B   ES,#SEG( __ctype_+1 )
000301 8500rrrr        1017         MOV.B   R0L,[R0+SOF( __ctype_+1 )]
000305 911803          1018         MOV.B   R0H,#03H
000308 5110            1019         AND.B   R0H,R0L
00030A F205            1020         BNE     _23
00030C 91A45F          1021         CMP.B   R5L,#05FH
00030F F303            1022         BEQ     _23
000311 910504          1023         AND.B   R0L,#04H
000314 F357            1024         BEQ     _26
000314 F357            1024         BEQ     _26
000316                 1025 _23:
                       1026 ; rs232par.c  227                               {
                       1027 ; rs232par.c  228                                       CmdLevelPtr = CmdPtr;
000316 964842rr        1029         MOV.B   ES,#SEG( _CmdPtr )
00031A 9918rrrr        1030         MOV.W   R1,#SOF( _CmdPtr )
00031E 8B01            1031         MOV.W   R0,[R1+]
000320 8A11            1032         MOV.W   R1,[R1]
000322 964842rr        1033         MOV.B   ES,#SEG( _CmdLevelPtr )
XA assembler v2.0 r2                    SN00085795-037 (c) 1998 TASKING, Inc.
                                                                                                                            Page  12

ADDR   CODE            LINE SOURCELINE
000326 9948rrrr        1034         MOV.W   R4,#SOF( _CmdLevelPtr )
00032A 8B0C            1035         MOV.W   [R4+],R0
00032C 8A1C            1036         MOV.W   [R4],R1
                       1037 ; rs232par.c  229       
                       1038 ; rs232par.c  230                                       if ( CmdNdx < 11)
00032E 964842rr        1040         MOV.B   ES,#SEG( _CmdNdx )
000332 9908rrrr        1041         MOV.W   R0,#SOF( _CmdNdx )
000336 8A00            1042         MOV.W   R0,[R0]
000338 9904000B        1043         CMP.W   R0,#0BH
00033C F036            1044         BCC     _25
                       1045 ; rs232par.c  231                                       {
                       1046 ; rs232par.c  232                                               Cmd[++CmdNdx] = c;
00033E A901            1048         ADDS.W  R0,#01H
000340 8910            1049         MOV.W   R1,R0
000342 8921            1050         MOV.W   R2,R1
000344 B930            1051         MOVS.W  R3,#00H
000346 964842rr        1052         MOV.B   ES,#SEG( _CmdNdx )
00034A 9948rrrr        1053         MOV.W   R4,#SOF( _CmdNdx )
00034E 8A1C            1054         MOV.W   [R4],R1
000350 964842rr        1055         MOV.B   ES,#SEG( _Cmd )
000354 85AArrrr        1056         MOV.B   [R2+SOF( _Cmd )],R5L
                       1057 ; rs232par.c  233                                               if ( isdigit(c))
000358 8C3702          1059         MOV.W   R3,[R7+2]
00035B 8A27            1060         MOV.W   R2,[R7]
00035D 866C42          1061         MOV.B   ES,R3L
000360 8222            1062         MOV.B   R1L,[R2]
000362 9039            1063         SEXT.B  R1H
000364 99150004        1064         AND.W   R1,#04H
000368 F313            1065         BEQ     _24
                       1066 ; rs232par.c  234                                               {
                       1067 ; rs232par.c  235                                                       NumSuffix = 10*NumSuffix 
                            + ( c-'0');
00036A 964842rr        1069         MOV.B   ES,#SEG( _NumSuffix )
00036E 9908rrrr        1070         MOV.W   R0,#SOF( _NumSuffix )
000372 8A00            1071         MOV.W   R0,[R0]
000374 E900000A        1072         MULU.W  R0,#0AH
000378 81AA            1073         MOV.B   R5L,R5L
00037A 90B9            1074         SEXT.B  R5H
00037C 99520030        1075         SUB.W   R5,#030H
000380 0905            1076         ADD.W   R0,R5
000382 964842rr        1077         MOV.B   ES,#SEG( _NumSuffix )
000386 9918rrrr        1078         MOV.W   R1,#SOF( _NumSuffix )
00038A 8A09            1079         MOV.W   [R1],R0
                       1080 ; rs232par.c  236                                                       break;
                       1082         BR      _329
00038C D50F96         +1082         JMP.L   _329
                       1083 ; rs232par.c  237                                               }
000390                 1085 _24:
                       1086 ; rs232par.c  238                                               NumSuffix = 0;
000390 964842rr        1088         MOV.B   ES,#SEG( _NumSuffix )
000394 9918rrrr        1089         MOV.W   R1,#SOF( _NumSuffix )
000398 BA10            1090         MOV.W   [R1],#00H
                       1091 ; rs232par.c  239                                               NoOfDigits = CmdNdx + 1;
00039A A101            1093         ADDS.B  R0L,#01H
00039C 964842rr        1094         MOV.B   ES,#SEG( _NoOfDigits )
0003A0 9918rrrr        1095         MOV.W   R1,#SOF( _NoOfDigits )
0003A4 8209            1096         MOV.B   [R1],R0L
                       1097 ; rs232par.c  240                                               break;
                       1099         BR      _329
0003A6 D50F89         +1099         JMP.L   _329
                       1100 ; rs232par.c  241                                       }
0003AA                 1102 _25:
XA assembler v2.0 r2                    SN00085795-037 (c) 1998 TASKING, Inc.
                                                                                                                            Page  13

ADDR   CODE            LINE SOURCELINE
                       1103 ; rs232par.c  242       
                       1104 ; rs232par.c  243                                       SCPIError = PrgmMnemonicTooLong;
0003AA 964842rr        1106         MOV.B   ES,#SEG( _SCPIError )
0003AE 9908rrrr        1107         MOV.W   R0,#SOF( _SCPIError )
0003B2 9A08000A        1108         MOV.W   [R0],#0AH
                       1109 ; rs232par.c  244                                       State = StateERROR;
0003B6 964842rr        1111         MOV.B   ES,#SEG( _State )
0003BA 9908rrrr        1112         MOV.W   R0,#SOF( _State )
0003BE 92081E          1113         MOV.B   [R0],#01EH
                       1114 ; rs232par.c  245                                       break;
                       1116         BR      _329
0003C1 D50F7B         +1116         JMP.L   _329
                       1117 ; rs232par.c  246                               }
0003C4                 1119 _26:
                       1120 ; rs232par.c  247       
                       1121 ; rs232par.c  248                               if ( isquestionmark(c))
0003C4 91A43F          1123         CMP.B   R5L,#03FH
0003C7 F20D            1124         BNE     _27
                       1125 ; rs232par.c  249                               {
                       1126 ; rs232par.c  250                                       State = StateP5;
0003C9 964842rr        1128         MOV.B   ES,#SEG( _State )
0003CD 9908rrrr        1129         MOV.W   R0,#SOF( _State )
0003D1 B205            1130         MOV.B   [R0],#05H
                       1131 ; rs232par.c  251                                       CmdRequest = TRUE;
0003D3 964842rr        1133         MOV.B   ES,#SEG( _CmdRequest )
0003D7 9908rrrr        1134         MOV.W   R0,#SOF( _CmdRequest )
0003DB 9208FF          1135         MOV.B   [R0],#0FFH
                       1136 ; rs232par.c  252                                       break;
                       1138         BR      _329
0003DE D50F6D         +1138         JMP.L   _329
                       1139 ; rs232par.c  253                               }
0003E2                 1141 _27:
                       1142 ; rs232par.c  254       
                       1143 ; rs232par.c  255                               if ( issemicolon(c))
0003E2 91A43B          1145         CMP.B   R5L,#03BH
0003E5 F21A            1146         BNE     _28
                       1147 ; rs232par.c  256                               {
                       1148 ; rs232par.c  257                                       Cmd[++CmdNdx] = 0;
0003E7 964842rr        1150         MOV.B   ES,#SEG( _CmdNdx )
0003EB 9908rrrr        1151         MOV.W   R0,#SOF( _CmdNdx )
0003EF 8A00            1152         MOV.W   R0,[R0]
0003F1 A901            1153         ADDS.W  R0,#01H
0003F3 8920            1154         MOV.W   R2,R0
0003F5 B930            1155         MOVS.W  R3,#00H
0003F7 964842rr        1156         MOV.B   ES,#SEG( _CmdNdx )
0003FB 9918rrrr        1157         MOV.W   R1,#SOF( _CmdNdx )
0003FF 8A09            1158         MOV.W   [R1],R0
000401 964842rr        1159         MOV.B   ES,#SEG( _Cmd )
000405 B520rrrr        1160         MOV.B   [R2+SOF( _Cmd )],#00H
                       1161 ; rs232par.c  258                                       State = StateP0;
000409 964842rr        1163         MOV.B   ES,#SEG( _State )
00040D 9908rrrr        1164         MOV.W   R0,#SOF( _State )
000411 B200            1165         MOV.B   [R0],#00H
                       1166 ; rs232par.c  259                                       return( PMUS);
000413 910803          1168         MOV.B   R0L,#03H
                       1169         BR      _384
000416 D50F5D         +1169         JMP.L   _384
                       1170 ; rs232par.c  260                               }
00041A                 1172 _28:
                       1173 ; rs232par.c  261       
                       1174 ; rs232par.c  262                               if ( iscolon(c))
00041A 91A43A          1176         CMP.B   R5L,#03AH
XA assembler v2.0 r2                    SN00085795-037 (c) 1998 TASKING, Inc.
                                                                                                                            Page  14

ADDR   CODE            LINE SOURCELINE
00041D F21A            1177         BNE     _29
                       1178 ; rs232par.c  263                               {
                       1179 ; rs232par.c  264                                       Cmd[++CmdNdx] = 0;
00041F 964842rr        1181         MOV.B   ES,#SEG( _CmdNdx )
000423 9908rrrr        1182         MOV.W   R0,#SOF( _CmdNdx )
000427 8A00            1183         MOV.W   R0,[R0]
000429 A901            1184         ADDS.W  R0,#01H
00042B 8920            1185         MOV.W   R2,R0
00042D B930            1186         MOVS.W  R3,#00H
00042F 964842rr        1187         MOV.B   ES,#SEG( _CmdNdx )
000433 9918rrrr        1188         MOV.W   R1,#SOF( _CmdNdx )
000437 8A09            1189         MOV.W   [R1],R0
000439 964842rr        1190         MOV.B   ES,#SEG( _Cmd )
00043D B520rrrr        1191         MOV.B   [R2+SOF( _Cmd )],#00H
                       1192 ; rs232par.c  265                                       State = StateP1;
000441 964842rr        1194         MOV.B   ES,#SEG( _State )
000445 9908rrrr        1195         MOV.W   R0,#SOF( _State )
000449 B201            1196         MOV.B   [R0],#01H
                       1197 ; rs232par.c  266                                       return( NextLevel);
00044B 910801          1199         MOV.B   R0L,#01H
                       1200         BR      _384
00044E D50F41         +1200         JMP.L   _384
                       1201 ; rs232par.c  267                               }
000452                 1203 _29:
                       1204 ; rs232par.c  268       
                       1205 ; rs232par.c  269                               if ( isnewline(c))
000452 91A40A          1207         CMP.B   R5L,#0AH
000455 F21A            1208         BNE     _30
                       1209 ; rs232par.c  270                               {
                       1210 ; rs232par.c  271                                       Cmd[++CmdNdx] = 0;
000457 964842rr        1212         MOV.B   ES,#SEG( _CmdNdx )
00045B 9908rrrr        1213         MOV.W   R0,#SOF( _CmdNdx )
00045F 8A00            1214         MOV.W   R0,[R0]
000461 A901            1215         ADDS.W  R0,#01H
000463 8920            1216         MOV.W   R2,R0
000465 B930            1217         MOVS.W  R3,#00H
000467 964842rr        1218         MOV.B   ES,#SEG( _CmdNdx )
00046B 9918rrrr        1219         MOV.W   R1,#SOF( _CmdNdx )
00046F 8A09            1220         MOV.W   [R1],R0
000471 964842rr        1221         MOV.B   ES,#SEG( _Cmd )
000475 B520rrrr        1222         MOV.B   [R2+SOF( _Cmd )],#00H
                       1223 ; rs232par.c  272                                       State = StateP0;
000479 964842rr        1225         MOV.B   ES,#SEG( _State )
00047D 9908rrrr        1226         MOV.W   R0,#SOF( _State )
000481 B200            1227         MOV.B   [R0],#00H
                       1228 ; rs232par.c  273                                       return( PMT);
000483 910804          1230         MOV.B   R0L,#04H
                       1231         BR      _384
000486 D50F25         +1231         JMP.L   _384
                       1232 ; rs232par.c  274                               }
00048A                 1234 _30:
                       1235 ; rs232par.c  275       
                       1236 ; rs232par.c  276                               SCPIError = InvalidChar;
00048A 964842rr        1238         MOV.B   ES,#SEG( _SCPIError )
00048E 9908rrrr        1239         MOV.W   R0,#SOF( _SCPIError )
000492 BA02            1240         MOV.W   [R0],#02H
                       1241 ; rs232par.c  277                               State = StateERROR;
000494 964842rr        1243         MOV.B   ES,#SEG( _State )
000498 9908rrrr        1244         MOV.W   R0,#SOF( _State )
00049C 92081E          1245         MOV.B   [R0],#01EH
                       1246 ; rs232par.c  278                               break;
                       1248         BR      _329
XA assembler v2.0 r2                    SN00085795-037 (c) 1998 TASKING, Inc.
                                                                                                                            Page  15

ADDR   CODE            LINE SOURCELINE
00049F D50F0C         +1248         JMP.L   _329
                       1249 ; rs232par.c  279       
                       1250 ; rs232par.c  280                       case StateP3:
0004A2                 1252 _31:
                       1253 ; rs232par.c  281                               if ( isalpha(c))
0004A2 810A            1255         MOV.B   R0L,R5L
0004A4 9019            1256         SEXT.B  R0H
0004A6 9819            1257         SEXT.W  R1
0004A8 964842rr        1258         MOV.B   ES,#SEG( __ctype_+1 )
0004AC 8500rrrr        1259         MOV.B   R0L,[R0+SOF( __ctype_+1 )]
0004B0 9019            1260         SEXT.B  R0H
0004B2 99050003        1261         AND.W   R0,#03H
0004B6 F318            1262         BEQ     _32
                       1263 ; rs232par.c  282                               {
                       1264 ; rs232par.c  283                                       Cmd[CmdNdx = 0] = c;
0004B8 B910            1266         MOV.W   R1,#00H
0004BA 964842rr        1267         MOV.B   ES,#SEG( _CmdNdx )
0004BE 9908rrrr        1268         MOV.W   R0,#SOF( _CmdNdx )
0004C2 BA00            1269         MOV.W   [R0],#00H
0004C4 8921            1270         MOV.W   R2,R1
0004C6 B930            1271         MOVS.W  R3,#00H
0004C8 964842rr        1272         MOV.B   ES,#SEG( _Cmd )
0004CC 85AArrrr        1273         MOV.B   [R2+SOF( _Cmd )],R5L
                       1274 ; rs232par.c  284                                       NumSuffix = 0;
0004D0 964842rr        1276         MOV.B   ES,#SEG( _NumSuffix )
0004D4 9908rrrr        1277         MOV.W   R0,#SOF( _NumSuffix )
0004D8 BA00            1278         MOV.W   [R0],#00H
                       1279 ; rs232par.c  285                                       State = StateP4;
0004DA 964842rr        1281         MOV.B   ES,#SEG( _State )
0004DE 9908rrrr        1282         MOV.W   R0,#SOF( _State )
0004E2 B204            1283         MOV.B   [R0],#04H
                       1284 ; rs232par.c  286                                       break;
                       1286         BR      _329
0004E4 D50EEA         +1286         JMP.L   _329
                       1287 ; rs232par.c  287                               }
0004E8                 1289 _32:
                       1290 ; rs232par.c  288       
                       1291 ; rs232par.c  289                               SCPIError = InvalidChar;
0004E8 964842rr        1293         MOV.B   ES,#SEG( _SCPIError )
0004EC 9908rrrr        1294         MOV.W   R0,#SOF( _SCPIError )
0004F0 BA02            1295         MOV.W   [R0],#02H
                       1296 ; rs232par.c  290                               State = StateERROR;
0004F2 964842rr        1298         MOV.B   ES,#SEG( _State )
0004F6 9908rrrr        1299         MOV.W   R0,#SOF( _State )
0004FA 92081E          1300         MOV.B   [R0],#01EH
                       1301 ; rs232par.c  291                               break;
                       1303         BR      _329
0004FD D50EDD         +1303         JMP.L   _329
                       1304 ; rs232par.c  292       
                       1305 ; rs232par.c  293                       case StateP4:
000500                 1307 _33:
                       1308 ; rs232par.c  294                               if ( iswhitespace(c))
000500 91A40A          1310         CMP.B   R5L,#0AH
000503 F31C            1311         BEQ     _35
000505 91A420          1312         CMP.B   R5L,#020H
000508 FC19            1313         BGT     _35
                       1314 ; rs232par.c  295                               {
                       1315 ; rs232par.c  296                                       Cmd[++CmdNdx] = 0;
00050A 964842rr        1317         MOV.B   ES,#SEG( _CmdNdx )
00050E 9908rrrr        1318         MOV.W   R0,#SOF( _CmdNdx )
000512 8A00            1319         MOV.W   R0,[R0]
000514 A901            1320         ADDS.W  R0,#01H
XA assembler v2.0 r2                    SN00085795-037 (c) 1998 TASKING, Inc.
                                                                                                                            Page  16

ADDR   CODE            LINE SOURCELINE
000516 8920            1321         MOV.W   R2,R0
000518 B930            1322         MOVS.W  R3,#00H
00051A 964842rr        1323         MOV.B   ES,#SEG( _CmdNdx )
00051E 9918rrrr        1324         MOV.W   R1,#SOF( _CmdNdx )
000522 8A09            1325         MOV.W   [R1],R0
000524 964842rr        1326         MOV.B   ES,#SEG( _Cmd )
000528 B520rrrr        1327         MOV.B   [R2+SOF( _Cmd )],#00H
                       1328 ; rs232par.c  297                                       State = StateP6;
00052C 964842rr        1330         MOV.B   ES,#SEG( _State )
000530 9908rrrr        1331         MOV.W   R0,#SOF( _State )
000534 B206            1332         MOV.B   [R0],#06H
                       1333 ; rs232par.c  298                                       return( Ready);
000536 910802          1335         MOV.B   R0L,#02H
                       1336         BR      _384
000539 D50ECB         +1336         JMP.L   _384
                       1337 ; rs232par.c  299                               }
00053C                 1339 _35:
                       1340 ; rs232par.c  300       
                       1341 ; rs232par.c  301                               if ( isalpha(c) || isunderscore(c) || isdigit(c))
                            
00053C 810A            1343         MOV.B   R0L,R5L
00053E 9019            1344         SEXT.B  R0H
000540 9819            1345         SEXT.W  R1
000542 964842rr        1346         MOV.B   ES,#SEG( __ctype_+1 )
000546 8500rrrr        1347         MOV.B   R0L,[R0+SOF( __ctype_+1 )]
00054A 911803          1348         MOV.B   R0H,#03H
00054D 5110            1349         AND.B   R0H,R0L
00054F F206            1350         BNE     _37
000551 91A45F          1351         CMP.B   R5L,#05FH
000554 F303            1352         BEQ     _37
000556 910504          1353         AND.B   R0L,#04H
000559 F324            1354         BEQ     _39
000559 F32400          1354         BEQ     _39
00055C                 1355 _37:
                       1356 ; rs232par.c  302                               {
                       1357 ; rs232par.c  303                                       if ( CmdNdx < 11)
00055C 964842rr        1359         MOV.B   ES,#SEG( _CmdNdx )
000560 9908rrrr        1360         MOV.W   R0,#SOF( _CmdNdx )
000564 8A00            1361         MOV.W   R0,[R0]
000566 9904000B        1362         CMP.W   R0,#0BH
00056A F00E            1363         BCC     _38
                       1364 ; rs232par.c  304                                       {
                       1365 ; rs232par.c  305                                               Cmd[++CmdNdx] = c;
00056C A901            1367         ADDS.W  R0,#01H
00056E 8920            1368         MOV.W   R2,R0
000570 B930            1369         MOVS.W  R3,#00H
000572 964842rr        1370         MOV.B   ES,#SEG( _CmdNdx )
000576 9918rrrr        1371         MOV.W   R1,#SOF( _CmdNdx )
00057A 8A09            1372         MOV.W   [R1],R0
00057C 964842rr        1373         MOV.B   ES,#SEG( _Cmd )
000580 85AArrrr        1374         MOV.B   [R2+SOF( _Cmd )],R5L
                       1375 ; rs232par.c  306                                               break;
                       1377         BR      _329
000584 D50E9A         +1377         JMP.L   _329
                       1378 ; rs232par.c  307                                       }
000588                 1380 _38:
                       1381 ; rs232par.c  308                                       SCPIError = PrgmMnemonicTooLong;
000588 964842rr        1383         MOV.B   ES,#SEG( _SCPIError )
00058C 9908rrrr        1384         MOV.W   R0,#SOF( _SCPIError )
000590 9A08000A        1385         MOV.W   [R0],#0AH
                       1386 ; rs232par.c  309                                       State = StateERROR;
000594 964842rr        1388         MOV.B   ES,#SEG( _State )
XA assembler v2.0 r2                    SN00085795-037 (c) 1998 TASKING, Inc.
                                                                                                                            Page  17

ADDR   CODE            LINE SOURCELINE
000598 9908rrrr        1389         MOV.W   R0,#SOF( _State )
00059C 92081E          1390         MOV.B   [R0],#01EH
                       1391 ; rs232par.c  310                                       break;
                       1393         BR      _329
00059F D50E8C         +1393         JMP.L   _329
                       1394 ; rs232par.c  311                               }
0005A2                 1396 _39:
                       1397 ; rs232par.c  312       
                       1398 ; rs232par.c  313                               if ( isquestionmark(c))
0005A2 91A43F          1400         CMP.B   R5L,#03FH
0005A5 F20D            1401         BNE     _40
                       1402 ; rs232par.c  314                               {
                       1403 ; rs232par.c  315                                       State = StateP5;
0005A7 964842rr        1405         MOV.B   ES,#SEG( _State )
0005AB 9908rrrr        1406         MOV.W   R0,#SOF( _State )
0005AF B205            1407         MOV.B   [R0],#05H
                       1408 ; rs232par.c  316                                       CmdRequest = TRUE;
0005B1 964842rr        1410         MOV.B   ES,#SEG( _CmdRequest )
0005B5 9908rrrr        1411         MOV.W   R0,#SOF( _CmdRequest )
0005B9 9208FF          1412         MOV.B   [R0],#0FFH
                       1413 ; rs232par.c  317                                       break;
                       1415         BR      _329
0005BC D50E7E         +1415         JMP.L   _329
                       1416 ; rs232par.c  318                               }
0005C0                 1418 _40:
                       1419 ; rs232par.c  319       
                       1420 ; rs232par.c  320                               if ( issemicolon(c))
0005C0 91A43B          1422         CMP.B   R5L,#03BH
0005C3 F21A            1423         BNE     _41
                       1424 ; rs232par.c  321                               {
                       1425 ; rs232par.c  322                                       Cmd[++CmdNdx] = 0;
0005C5 964842rr        1427         MOV.B   ES,#SEG( _CmdNdx )
0005C9 9908rrrr        1428         MOV.W   R0,#SOF( _CmdNdx )
0005CD 8A00            1429         MOV.W   R0,[R0]
0005CF A901            1430         ADDS.W  R0,#01H
0005D1 8920            1431         MOV.W   R2,R0
0005D3 B930            1432         MOVS.W  R3,#00H
0005D5 964842rr        1433         MOV.B   ES,#SEG( _CmdNdx )
0005D9 9918rrrr        1434         MOV.W   R1,#SOF( _CmdNdx )
0005DD 8A09            1435         MOV.W   [R1],R0
0005DF 964842rr        1436         MOV.B   ES,#SEG( _Cmd )
0005E3 B520rrrr        1437         MOV.B   [R2+SOF( _Cmd )],#00H
                       1438 ; rs232par.c  323                                       State = StateP0;
0005E7 964842rr        1440         MOV.B   ES,#SEG( _State )
0005EB 9908rrrr        1441         MOV.W   R0,#SOF( _State )
0005EF B200            1442         MOV.B   [R0],#00H
                       1443 ; rs232par.c  324                                       return( PMUS);
0005F1 910803          1445         MOV.B   R0L,#03H
                       1446         BR      _384
0005F4 D50E6E         +1446         JMP.L   _384
                       1447 ; rs232par.c  325                               }
0005F8                 1449 _41:
                       1450 ; rs232par.c  326       
                       1451 ; rs232par.c  327                               if ( isnewline(c))
0005F8 91A40A          1453         CMP.B   R5L,#0AH
0005FB F21A            1454         BNE     _42
                       1455 ; rs232par.c  328                               {
                       1456 ; rs232par.c  329                                       Cmd[++CmdNdx] = 0;
0005FD 964842rr        1458         MOV.B   ES,#SEG( _CmdNdx )
000601 9908rrrr        1459         MOV.W   R0,#SOF( _CmdNdx )
000605 8A00            1460         MOV.W   R0,[R0]
000607 A901            1461         ADDS.W  R0,#01H
XA assembler v2.0 r2                    SN00085795-037 (c) 1998 TASKING, Inc.
                                                                                                                            Page  18

ADDR   CODE            LINE SOURCELINE
000609 8920            1462         MOV.W   R2,R0
00060B B930            1463         MOVS.W  R3,#00H
00060D 964842rr        1464         MOV.B   ES,#SEG( _CmdNdx )
000611 9918rrrr        1465         MOV.W   R1,#SOF( _CmdNdx )
000615 8A09            1466         MOV.W   [R1],R0
000617 964842rr        1467         MOV.B   ES,#SEG( _Cmd )
00061B B520rrrr        1468         MOV.B   [R2+SOF( _Cmd )],#00H
                       1469 ; rs232par.c  330                                       State = StateP0;
00061F 964842rr        1471         MOV.B   ES,#SEG( _State )
000623 9908rrrr        1472         MOV.W   R0,#SOF( _State )
000627 B200            1473         MOV.B   [R0],#00H
                       1474 ; rs232par.c  331                                       return( PMT);
000629 910804          1476         MOV.B   R0L,#04H
                       1477         BR      _384
00062C D50E52         +1477         JMP.L   _384
                       1478 ; rs232par.c  332                               }
000630                 1480 _42:
                       1481 ; rs232par.c  333       
                       1482 ; rs232par.c  334                               SCPIError = InvalidChar;
000630 964842rr        1484         MOV.B   ES,#SEG( _SCPIError )
000634 9908rrrr        1485         MOV.W   R0,#SOF( _SCPIError )
000638 BA02            1486         MOV.W   [R0],#02H
                       1487 ; rs232par.c  335                               State = StateERROR;
00063A 964842rr        1489         MOV.B   ES,#SEG( _State )
00063E 9908rrrr        1490         MOV.W   R0,#SOF( _State )
000642 92081E          1491         MOV.B   [R0],#01EH
                       1492 ; rs232par.c  336                               break;
                       1494         BR      _329
000645 D50E39         +1494         JMP.L   _329
                       1495 ; rs232par.c  337       
                       1496 ; rs232par.c  338                       case StateP5:
000648                 1498 _43:
                       1499 ; rs232par.c  339                               if ( iswhitespace(c))
000648 91A40A          1501         CMP.B   R5L,#0AH
00064B F31C            1502         BEQ     _45
00064D 91A420          1503         CMP.B   R5L,#020H
000650 FC19            1504         BGT     _45
                       1505 ; rs232par.c  340                               {
                       1506 ; rs232par.c  341                                       Cmd[++CmdNdx] = 0;
000652 964842rr        1508         MOV.B   ES,#SEG( _CmdNdx )
000656 9908rrrr        1509         MOV.W   R0,#SOF( _CmdNdx )
00065A 8A00            1510         MOV.W   R0,[R0]
00065C A901            1511         ADDS.W  R0,#01H
00065E 8920            1512         MOV.W   R2,R0
000660 B930            1513         MOVS.W  R3,#00H
000662 964842rr        1514         MOV.B   ES,#SEG( _CmdNdx )
000666 9918rrrr        1515         MOV.W   R1,#SOF( _CmdNdx )
00066A 8A09            1516         MOV.W   [R1],R0
00066C 964842rr        1517         MOV.B   ES,#SEG( _Cmd )
000670 B520rrrr        1518         MOV.B   [R2+SOF( _Cmd )],#00H
                       1519 ; rs232par.c  342                                       State = StateP6;
000674 964842rr        1521         MOV.B   ES,#SEG( _State )
000678 9908rrrr        1522         MOV.W   R0,#SOF( _State )
00067C B206            1523         MOV.B   [R0],#06H
                       1524 ; rs232par.c  343                                       return( Ready);
00067E 910802          1526         MOV.B   R0L,#02H
                       1527         BR      _384
000681 D50E27         +1527         JMP.L   _384
                       1528 ; rs232par.c  344                               }
000684                 1530 _45:
                       1531 ; rs232par.c  345       
                       1532 ; rs232par.c  346                               if ( issemicolon(c))
XA assembler v2.0 r2                    SN00085795-037 (c) 1998 TASKING, Inc.
                                                                                                                            Page  19

ADDR   CODE            LINE SOURCELINE
000684 91A43B          1534         CMP.B   R5L,#03BH
000687 F21A            1535         BNE     _46
                       1536 ; rs232par.c  347                               {
                       1537 ; rs232par.c  348                                       Cmd[++CmdNdx] = 0;
000689 964842rr        1539         MOV.B   ES,#SEG( _CmdNdx )
00068D 9908rrrr        1540         MOV.W   R0,#SOF( _CmdNdx )
000691 8A00            1541         MOV.W   R0,[R0]
000693 A901            1542         ADDS.W  R0,#01H
000695 8920            1543         MOV.W   R2,R0
000697 B930            1544         MOVS.W  R3,#00H
000699 964842rr        1545         MOV.B   ES,#SEG( _CmdNdx )
00069D 9918rrrr        1546         MOV.W   R1,#SOF( _CmdNdx )
0006A1 8A09            1547         MOV.W   [R1],R0
0006A3 964842rr        1548         MOV.B   ES,#SEG( _Cmd )
0006A7 B520rrrr        1549         MOV.B   [R2+SOF( _Cmd )],#00H
                       1550 ; rs232par.c  349                                       State = StateP0;
0006AB 964842rr        1552         MOV.B   ES,#SEG( _State )
0006AF 9908rrrr        1553         MOV.W   R0,#SOF( _State )
0006B3 B200            1554         MOV.B   [R0],#00H
                       1555 ; rs232par.c  350                                       return( PMUS);
0006B5 910803          1557         MOV.B   R0L,#03H
                       1558         BR      _384
0006B8 D50E0C         +1558         JMP.L   _384
                       1559 ; rs232par.c  351                               }
0006BC                 1561 _46:
                       1562 ; rs232par.c  352       
                       1563 ; rs232par.c  353                               if ( isnewline(c))
0006BC 91A40A          1565         CMP.B   R5L,#0AH
0006BF F21A            1566         BNE     _47
                       1567 ; rs232par.c  354                               {
                       1568 ; rs232par.c  355                                       Cmd[++CmdNdx] = 0;
0006C1 964842rr        1570         MOV.B   ES,#SEG( _CmdNdx )
0006C5 9908rrrr        1571         MOV.W   R0,#SOF( _CmdNdx )
0006C9 8A00            1572         MOV.W   R0,[R0]
0006CB A901            1573         ADDS.W  R0,#01H
0006CD 8920            1574         MOV.W   R2,R0
0006CF B930            1575         MOVS.W  R3,#00H
0006D1 964842rr        1576         MOV.B   ES,#SEG( _CmdNdx )
0006D5 9918rrrr        1577         MOV.W   R1,#SOF( _CmdNdx )
0006D9 8A09            1578         MOV.W   [R1],R0
0006DB 964842rr        1579         MOV.B   ES,#SEG( _Cmd )
0006DF B520rrrr        1580         MOV.B   [R2+SOF( _Cmd )],#00H
                       1581 ; rs232par.c  356                                       State = StateP0;
0006E3 964842rr        1583         MOV.B   ES,#SEG( _State )
0006E7 9908rrrr        1584         MOV.W   R0,#SOF( _State )
0006EB B200            1585         MOV.B   [R0],#00H
                       1586 ; rs232par.c  357                                       return( PMT);
0006ED 910804          1588         MOV.B   R0L,#04H
                       1589         BR      _384
0006F0 D50DF0         +1589         JMP.L   _384
                       1590 ; rs232par.c  358                               }
0006F4                 1592 _47:
                       1593 ; rs232par.c  359       
                       1594 ; rs232par.c  360                               SCPIError = InvalidChar;
0006F4 964842rr        1596         MOV.B   ES,#SEG( _SCPIError )
0006F8 9908rrrr        1597         MOV.W   R0,#SOF( _SCPIError )
0006FC BA02            1598         MOV.W   [R0],#02H
                       1599 ; rs232par.c  361                               State = StateERROR;
0006FE 964842rr        1601         MOV.B   ES,#SEG( _State )
000702 9908rrrr        1602         MOV.W   R0,#SOF( _State )
000706 92081E          1603         MOV.B   [R0],#01EH
                       1604 ; rs232par.c  362                               break;
XA assembler v2.0 r2                    SN00085795-037 (c) 1998 TASKING, Inc.
                                                                                                                            Page  20

ADDR   CODE            LINE SOURCELINE
                       1606         BR      _329
000709 D50DD7         +1606         JMP.L   _329
                       1607 ; rs232par.c  363       
                       1608 ; rs232par.c  364                       case StateP6:
00070C                 1610 _48:
                       1611 ; rs232par.c  365                               if ( iswhitespace(c))
00070C 91A40A          1613         CMP.B   R5L,#0AH
00070F F30A            1614         BEQ     _50
000711 91A420          1615         CMP.B   R5L,#020H
000714 FC07            1616         BGT     _50
                       1617 ; rs232par.c  366                               {
                       1618 ; rs232par.c  367                                       State = StateP6;
000716 964842rr        1620         MOV.B   ES,#SEG( _State )
00071A 9908rrrr        1621         MOV.W   R0,#SOF( _State )
00071E B206            1622         MOV.B   [R0],#06H
                       1623 ; rs232par.c  368                                       break;
                       1625         BR      _329
000720 D50DCC         +1625         JMP.L   _329
                       1626 ; rs232par.c  369                               }
000724                 1628 _50:
                       1629 ; rs232par.c  370       
                       1630 ; rs232par.c  371                               if ( isalpha(c)) {
000724 814A            1632         MOV.B   R2L,R5L
000726 9059            1633         SEXT.B  R2H
000728 9839            1634         SEXT.W  R3
00072A 9918rrrr        1635         MOV.W   R1,#SEG( __ctype_+1 )
00072E 9908rrrr        1636         MOV.W   R0,#SOF( __ctype_+1 )
000732 0902            1637         ADD.W   R0,R2
000734 964842rr        1638         MOV.B   ES,#SEG( __ctype_+1 )
000738 8542rrrr        1639         MOV.B   R2L,[R2+SOF( __ctype_+1 )]
00073C 9059            1640         SEXT.B  R2H
00073E 99250003        1641         AND.W   R2,#03H
000742 F31D            1642         BEQ     _51
                       1643 ; rs232par.c  372                                       Cmd[CmdNdx = 0] = c;
000744 964842rr        1645         MOV.B   ES,#SEG( _CmdNdx )
000748 9908rrrr        1646         MOV.W   R0,#SOF( _CmdNdx )
00074C BA00            1647         MOV.W   [R0],#00H
00074E B900            1648         MOV.W   R0,#00H
000750 B910            1649         MOVS.W  R1,#00H
000752 964842rr        1650         MOV.B   ES,#SEG( _Cmd )
000756 85A8rrrr        1651         MOV.B   [R0+SOF( _Cmd )],R5L
                       1652 ; rs232par.c  373                                       State = StateC0;
00075A 964842rr        1654         MOV.B   ES,#SEG( _State )
00075E 9908rrrr        1655         MOV.W   R0,#SOF( _State )
000762 920809          1656         MOV.B   [R0],#09H
                       1657 ; rs232par.c  374                                       ParCnt++;
000765 964842rr        1659         MOV.B   ES,#SEG( _ParCnt )
000769 9908rrrr        1660         MOV.W   R0,#SOF( _ParCnt )
00076D 8200            1661         MOV.B   R0L,[R0]
00076F A101            1662         ADDS.B  R0L,#01H
000771 964842rr        1663         MOV.B   ES,#SEG( _ParCnt )
000775 9918rrrr        1664         MOV.W   R1,#SOF( _ParCnt )
000779 8209            1665         MOV.B   [R1],R0L
                       1666 ; rs232par.c  375                                       break;
                       1668         BR      _329
00077B D50D9E         +1668         JMP.L   _329
                       1669 ; rs232par.c  376                               }
00077E                 1671 _51:
                       1672 ; rs232par.c  377       
                       1673 ; rs232par.c  378                               if ( isdigit(c)) {
00077E 862C42          1675         MOV.B   ES,R1L
000781 8200            1676         MOV.B   R0L,[R0]
XA assembler v2.0 r2                    SN00085795-037 (c) 1998 TASKING, Inc.
                                                                                                                            Page  21

ADDR   CODE            LINE SOURCELINE
000783 9019            1677         SEXT.B  R0H
000785 99050004        1678         AND.W   R0,#04H
000789 F31E            1679         BEQ     _52
                       1680 ; rs232par.c  379                                       Cmd[CmdNdx = 0] = c;
00078B 964842rr        1682         MOV.B   ES,#SEG( _CmdNdx )
00078F 9908rrrr        1683         MOV.W   R0,#SOF( _CmdNdx )
000793 BA00            1684         MOV.W   [R0],#00H
000795 B900            1685         MOV.W   R0,#00H
000797 B910            1686         MOVS.W  R1,#00H
000799 964842rr        1687         MOV.B   ES,#SEG( _Cmd )
00079D 85A8rrrr        1688         MOV.B   [R0+SOF( _Cmd )],R5L
                       1689 ; rs232par.c  380                                       State = StateD2;
0007A1 964842rr        1691         MOV.B   ES,#SEG( _State )
0007A5 9908rrrr        1692         MOV.W   R0,#SOF( _State )
0007A9 92080C          1693         MOV.B   [R0],#0CH
                       1694 ; rs232par.c  381                                       ParCnt++;
0007AC 964842rr        1696         MOV.B   ES,#SEG( _ParCnt )
0007B0 9908rrrr        1697         MOV.W   R0,#SOF( _ParCnt )
0007B4 8200            1698         MOV.B   R0L,[R0]
0007B6 A101            1699         ADDS.B  R0L,#01H
0007B8 964842rr        1700         MOV.B   ES,#SEG( _ParCnt )
0007BC 9918rrrr        1701         MOV.W   R1,#SOF( _ParCnt )
0007C0 8209            1702         MOV.B   [R1],R0L
                       1703 ; rs232par.c  382                                       break;
                       1705         BR      _329
0007C2 D50D7B         +1705         JMP.L   _329
                       1706 ; rs232par.c  383                               }
0007C6                 1708 _52:
                       1709 ; rs232par.c  384       
                       1710 ; rs232par.c  385                               if ( issemicolon(c)) {
0007C6 91A43B          1712         CMP.B   R5L,#03BH
0007C9 F21A            1713         BNE     _53
                       1714 ; rs232par.c  386                                       Cmd[++CmdNdx] = 0;
0007CB 964842rr        1716         MOV.B   ES,#SEG( _CmdNdx )
0007CF 9908rrrr        1717         MOV.W   R0,#SOF( _CmdNdx )
0007D3 8A00            1718         MOV.W   R0,[R0]
0007D5 A901            1719         ADDS.W  R0,#01H
0007D7 8920            1720         MOV.W   R2,R0
0007D9 B930            1721         MOVS.W  R3,#00H
0007DB 964842rr        1722         MOV.B   ES,#SEG( _CmdNdx )
0007DF 9918rrrr        1723         MOV.W   R1,#SOF( _CmdNdx )
0007E3 8A09            1724         MOV.W   [R1],R0
0007E5 964842rr        1725         MOV.B   ES,#SEG( _Cmd )
0007E9 B520rrrr        1726         MOV.B   [R2+SOF( _Cmd )],#00H
                       1727 ; rs232par.c  387                                       State = StateP0;
0007ED 964842rr        1729         MOV.B   ES,#SEG( _State )
0007F1 9908rrrr        1730         MOV.W   R0,#SOF( _State )
0007F5 B200            1731         MOV.B   [R0],#00H
                       1732 ; rs232par.c  388                                       return( PMUS);
0007F7 910803          1734         MOV.B   R0L,#03H
                       1735         BR      _384
0007FA D50D6B         +1735         JMP.L   _384
                       1736 ; rs232par.c  389                               }
0007FE                 1738 _53:
                       1739 ; rs232par.c  390       
                       1740 ; rs232par.c  391                               if ( isplussign(c) || isminussign(c)) {
0007FE 91A42B          1742         CMP.B   R5L,#02BH
000801 F303            1743         BEQ     _54
000803 91A42D          1744         CMP.B   R5L,#02DH
000806 F21D            1745         BNE     _55
000806 F21D            1745         BNE     _55
000808                 1746 _54:
XA assembler v2.0 r2                    SN00085795-037 (c) 1998 TASKING, Inc.
                                                                                                                            Page  22

ADDR   CODE            LINE SOURCELINE
                       1747 ; rs232par.c  392                                       Cmd[CmdNdx = 0] = c;
000808 964842rr        1749         MOV.B   ES,#SEG( _CmdNdx )
00080C 9908rrrr        1750         MOV.W   R0,#SOF( _CmdNdx )
000810 BA00            1751         MOV.W   [R0],#00H
000812 B900            1752         MOV.W   R0,#00H
000814 B910            1753         MOVS.W  R1,#00H
000816 964842rr        1754         MOV.B   ES,#SEG( _Cmd )
00081A 85A8rrrr        1755         MOV.B   [R0+SOF( _Cmd )],R5L
                       1756 ; rs232par.c  393                                       State = StateD0;
00081E 964842rr        1758         MOV.B   ES,#SEG( _State )
000822 9908rrrr        1759         MOV.W   R0,#SOF( _State )
000826 92080A          1760         MOV.B   [R0],#0AH
                       1761 ; rs232par.c  394                                       ParCnt++;
000829 964842rr        1763         MOV.B   ES,#SEG( _ParCnt )
00082D 9908rrrr        1764         MOV.W   R0,#SOF( _ParCnt )
000831 8200            1765         MOV.B   R0L,[R0]
000833 A101            1766         ADDS.B  R0L,#01H
000835 964842rr        1767         MOV.B   ES,#SEG( _ParCnt )
000839 9918rrrr        1768         MOV.W   R1,#SOF( _ParCnt )
00083D 8209            1769         MOV.B   [R1],R0L
                       1770 ; rs232par.c  395                                       break;
                       1772         BR      _329
00083F D50D3C         +1772         JMP.L   _329
                       1773 ; rs232par.c  396                               }
000842                 1775 _55:
                       1776 ; rs232par.c  397       
                       1777 ; rs232par.c  398                               if ( isdot(c)) {
000842 91A42E          1779         CMP.B   R5L,#02EH
000845 F21E            1780         BNE     _56
                       1781 ; rs232par.c  399                                       Cmd[CmdNdx = 0] = c;
000847 964842rr        1783         MOV.B   ES,#SEG( _CmdNdx )
00084B 9908rrrr        1784         MOV.W   R0,#SOF( _CmdNdx )
00084F BA00            1785         MOV.W   [R0],#00H
000851 B900            1786         MOV.W   R0,#00H
000853 B910            1787         MOVS.W  R1,#00H
000855 964842rr        1788         MOV.B   ES,#SEG( _Cmd )
000859 85A8rrrr        1789         MOV.B   [R0+SOF( _Cmd )],R5L
                       1790 ; rs232par.c  400                                       State = StateD1;
00085D 964842rr        1792         MOV.B   ES,#SEG( _State )
000861 9908rrrr        1793         MOV.W   R0,#SOF( _State )
000865 92080B          1794         MOV.B   [R0],#0BH
                       1795 ; rs232par.c  401                                       ParCnt++;
000868 964842rr        1797         MOV.B   ES,#SEG( _ParCnt )
00086C 9908rrrr        1798         MOV.W   R0,#SOF( _ParCnt )
000870 8200            1799         MOV.B   R0L,[R0]
000872 A101            1800         ADDS.B  R0L,#01H
000874 964842rr        1801         MOV.B   ES,#SEG( _ParCnt )
000878 9918rrrr        1802         MOV.W   R1,#SOF( _ParCnt )
00087C 8209            1803         MOV.B   [R1],R0L
                       1804 ; rs232par.c  402                                       break;
                       1806         BR      _329
00087E D50D1D         +1806         JMP.L   _329
                       1807 ; rs232par.c  403                               }
000882                 1809 _56:
                       1810 ; rs232par.c  404       
                       1811 ; rs232par.c  405                               if ( isdoubledagger(c)) {
000882 91A423          1813         CMP.B   R5L,#023H
000885 F213            1814         BNE     _57
                       1815 ; rs232par.c  406                                       State = StateDA0;
000887 964842rr        1817         MOV.B   ES,#SEG( _State )
00088B 9908rrrr        1818         MOV.W   R0,#SOF( _State )
00088F 920816          1819         MOV.B   [R0],#016H
XA assembler v2.0 r2                    SN00085795-037 (c) 1998 TASKING, Inc.
                                                                                                                            Page  23

ADDR   CODE            LINE SOURCELINE
                       1820 ; rs232par.c  407                                       ParCnt++;
000892 964842rr        1822         MOV.B   ES,#SEG( _ParCnt )
000896 9908rrrr        1823         MOV.W   R0,#SOF( _ParCnt )
00089A 8200            1824         MOV.B   R0L,[R0]
00089C A101            1825         ADDS.B  R0L,#01H
00089E 964842rr        1826         MOV.B   ES,#SEG( _ParCnt )
0008A2 9918rrrr        1827         MOV.W   R1,#SOF( _ParCnt )
0008A6 8209            1828         MOV.B   [R1],R0L
                       1829 ; rs232par.c  408                                       break;
                       1831         BR      _329
0008A8 D50D08         +1831         JMP.L   _329
                       1832 ; rs232par.c  409                               }
0008AC                 1834 _57:
                       1835 ; rs232par.c  410       
                       1836 ; rs232par.c  411                               if ( isdoublequote(c)) {
0008AC 91A422          1838         CMP.B   R5L,#022H
0008AF F218            1839         BNE     _58
                       1840 ; rs232par.c  412                                       CmdNdx = 0;
0008B1 964842rr        1842         MOV.B   ES,#SEG( _CmdNdx )
0008B5 9908rrrr        1843         MOV.W   R0,#SOF( _CmdNdx )
0008B9 BA00            1844         MOV.W   [R0],#00H
                       1845 ; rs232par.c  413                                       State = StateS2;
0008BB 964842rr        1847         MOV.B   ES,#SEG( _State )
0008BF 9908rrrr        1848         MOV.W   R0,#SOF( _State )
0008C3 920814          1849         MOV.B   [R0],#014H
                       1850 ; rs232par.c  414                                       ParCnt++;
0008C6 964842rr        1852         MOV.B   ES,#SEG( _ParCnt )
0008CA 9908rrrr        1853         MOV.W   R0,#SOF( _ParCnt )
0008CE 8200            1854         MOV.B   R0L,[R0]
0008D0 A101            1855         ADDS.B  R0L,#01H
0008D2 964842rr        1856         MOV.B   ES,#SEG( _ParCnt )
0008D6 9918rrrr        1857         MOV.W   R1,#SOF( _ParCnt )
0008DA 8209            1858         MOV.B   [R1],R0L
                       1859 ; rs232par.c  415                                       break;
                       1861         BR      _329
0008DC D50CEE         +1861         JMP.L   _329
                       1862 ; rs232par.c  416                               }
0008E0                 1864 _58:
                       1865 ; rs232par.c  417       
                       1866 ; rs232par.c  418                               if ( isquote(c)) {
0008E0 91A427          1868         CMP.B   R5L,#027H
0008E3 F218            1869         BNE     _59
                       1870 ; rs232par.c  419                                       CmdNdx = 0;
0008E5 964842rr        1872         MOV.B   ES,#SEG( _CmdNdx )
0008E9 9908rrrr        1873         MOV.W   R0,#SOF( _CmdNdx )
0008ED BA00            1874         MOV.W   [R0],#00H
                       1875 ; rs232par.c  420                                       State = StateS0;
0008EF 964842rr        1877         MOV.B   ES,#SEG( _State )
0008F3 9908rrrr        1878         MOV.W   R0,#SOF( _State )
0008F7 920812          1879         MOV.B   [R0],#012H
                       1880 ; rs232par.c  421                                       ParCnt++;
0008FA 964842rr        1882         MOV.B   ES,#SEG( _ParCnt )
0008FE 9908rrrr        1883         MOV.W   R0,#SOF( _ParCnt )
000902 8200            1884         MOV.B   R0L,[R0]
000904 A101            1885         ADDS.B  R0L,#01H
000906 964842rr        1886         MOV.B   ES,#SEG( _ParCnt )
00090A 9918rrrr        1887         MOV.W   R1,#SOF( _ParCnt )
00090E 8209            1888         MOV.B   [R1],R0L
                       1889 ; rs232par.c  422                                       break;
                       1891         BR      _329
000910 D50CD4         +1891         JMP.L   _329
                       1892 ; rs232par.c  423                               }
XA assembler v2.0 r2                    SN00085795-037 (c) 1998 TASKING, Inc.
                                                                                                                            Page  24

ADDR   CODE            LINE SOURCELINE
000914                 1894 _59:
                       1895 ; rs232par.c  424       
                       1896 ; rs232par.c  425                               if ((c) == '(') {
000914 91A428          1898         CMP.B   R5L,#028H
000917 F213            1899         BNE     _60
                       1900 ; rs232par.c  426                                       State = StateE0;
000919 964842rr        1902         MOV.B   ES,#SEG( _State )
00091D 9908rrrr        1903         MOV.W   R0,#SOF( _State )
000921 92081D          1904         MOV.B   [R0],#01DH
                       1905 ; rs232par.c  427                                       ParCnt++;
000924 964842rr        1907         MOV.B   ES,#SEG( _ParCnt )
000928 9908rrrr        1908         MOV.W   R0,#SOF( _ParCnt )
00092C 8200            1909         MOV.B   R0L,[R0]
00092E A101            1910         ADDS.B  R0L,#01H
000930 964842rr        1911         MOV.B   ES,#SEG( _ParCnt )
000934 9918rrrr        1912         MOV.W   R1,#SOF( _ParCnt )
000938 8209            1913         MOV.B   [R1],R0L
                       1914 ; rs232par.c  428                                       break;
                       1916         BR      _329
00093A D50CBF         +1916         JMP.L   _329
                       1917 ; rs232par.c  429                               }
00093E                 1919 _60:
                       1920 ; rs232par.c  430       
                       1921 ; rs232par.c  431                               if ( isnewline(c)) {
00093E 91A40A          1923         CMP.B   R5L,#0AH
000941 F21A            1924         BNE     _61
                       1925 ; rs232par.c  432                                       Cmd[++CmdNdx] = 0;
000943 964842rr        1927         MOV.B   ES,#SEG( _CmdNdx )
000947 9908rrrr        1928         MOV.W   R0,#SOF( _CmdNdx )
00094B 8A00            1929         MOV.W   R0,[R0]
00094D A901            1930         ADDS.W  R0,#01H
00094F 8920            1931         MOV.W   R2,R0
000951 B930            1932         MOVS.W  R3,#00H
000953 964842rr        1933         MOV.B   ES,#SEG( _CmdNdx )
000957 9918rrrr        1934         MOV.W   R1,#SOF( _CmdNdx )
00095B 8A09            1935         MOV.W   [R1],R0
00095D 964842rr        1936         MOV.B   ES,#SEG( _Cmd )
000961 B520rrrr        1937         MOV.B   [R2+SOF( _Cmd )],#00H
                       1938 ; rs232par.c  433                                       State = StateP0;
000965 964842rr        1940         MOV.B   ES,#SEG( _State )
000969 9908rrrr        1941         MOV.W   R0,#SOF( _State )
00096D B200            1942         MOV.B   [R0],#00H
                       1943 ; rs232par.c  434                                       return( PMT);
00096F 910804          1945         MOV.B   R0L,#04H
                       1946         BR      _384
000972 D50CAF         +1946         JMP.L   _384
                       1947 ; rs232par.c  435                               }
000976                 1949 _61:
                       1950 ; rs232par.c  436       
                       1951 ; rs232par.c  437                               SCPIError = InvalidChar;
000976 964842rr        1953         MOV.B   ES,#SEG( _SCPIError )
00097A 9908rrrr        1954         MOV.W   R0,#SOF( _SCPIError )
00097E BA02            1955         MOV.W   [R0],#02H
                       1956 ; rs232par.c  438                               State = StateERROR;
000980 964842rr        1958         MOV.B   ES,#SEG( _State )
000984 9908rrrr        1959         MOV.W   R0,#SOF( _State )
000988 92081E          1960         MOV.B   [R0],#01EH
                       1961 ; rs232par.c  439                               break;
                       1963         BR      _329
00098B D50C96         +1963         JMP.L   _329
                       1964 ; rs232par.c  440       
                       1965 ; rs232par.c  441                       case StateP7:
XA assembler v2.0 r2                    SN00085795-037 (c) 1998 TASKING, Inc.
                                                                                                                            Page  25

ADDR   CODE            LINE SOURCELINE
00098E                 1967 _62:
                       1968 ; rs232par.c  442                               if ( iswhitespace(c))
00098E 91A40A          1970         CMP.B   R5L,#0AH
000991 F30A            1971         BEQ     _64
000993 91A420          1972         CMP.B   R5L,#020H
000996 FC07            1973         BGT     _64
                       1974 ; rs232par.c  443                               {
                       1975 ; rs232par.c  444                                       State = StateP7;
000998 964842rr        1977         MOV.B   ES,#SEG( _State )
00099C 9908rrrr        1978         MOV.W   R0,#SOF( _State )
0009A0 B207            1979         MOV.B   [R0],#07H
                       1980 ; rs232par.c  445                                       break;
                       1982         BR      _329
0009A2 D50C8B         +1982         JMP.L   _329
                       1983 ; rs232par.c  446                               }
0009A6                 1985 _64:
                       1986 ; rs232par.c  447       
                       1987 ; rs232par.c  448                               if ( issemicolon(c))
0009A6 91A43B          1989         CMP.B   R5L,#03BH
0009A9 F21A            1990         BNE     _65
                       1991 ; rs232par.c  449                               {
                       1992 ; rs232par.c  450                                       Cmd[++CmdNdx] = 0;
0009AB 964842rr        1994         MOV.B   ES,#SEG( _CmdNdx )
0009AF 9908rrrr        1995         MOV.W   R0,#SOF( _CmdNdx )
0009B3 8A00            1996         MOV.W   R0,[R0]
0009B5 A901            1997         ADDS.W  R0,#01H
0009B7 8920            1998         MOV.W   R2,R0
0009B9 B930            1999         MOVS.W  R3,#00H
0009BB 964842rr        2000         MOV.B   ES,#SEG( _CmdNdx )
0009BF 9918rrrr        2001         MOV.W   R1,#SOF( _CmdNdx )
0009C3 8A09            2002         MOV.W   [R1],R0
0009C5 964842rr        2003         MOV.B   ES,#SEG( _Cmd )
0009C9 B520rrrr        2004         MOV.B   [R2+SOF( _Cmd )],#00H
                       2005 ; rs232par.c  451                                       State = StateP0;
0009CD 964842rr        2007         MOV.B   ES,#SEG( _State )
0009D1 9908rrrr        2008         MOV.W   R0,#SOF( _State )
0009D5 B200            2009         MOV.B   [R0],#00H
                       2010 ; rs232par.c  452                                       return( PMUS);
0009D7 910803          2012         MOV.B   R0L,#03H
                       2013         BR      _384
0009DA D50C7B         +2013         JMP.L   _384
                       2014 ; rs232par.c  453                               }
0009DE                 2016 _65:
                       2017 ; rs232par.c  454       
                       2018 ; rs232par.c  455                               if ( iscomma(c))
0009DE 91A42C          2020         CMP.B   R5L,#02CH
0009E1 F21A            2021         BNE     _66
                       2022 ; rs232par.c  456                               {
                       2023 ; rs232par.c  457                                       Cmd[++CmdNdx] = c;
0009E3 964842rr        2025         MOV.B   ES,#SEG( _CmdNdx )
0009E7 9908rrrr        2026         MOV.W   R0,#SOF( _CmdNdx )
0009EB 8A00            2027         MOV.W   R0,[R0]
0009ED A901            2028         ADDS.W  R0,#01H
0009EF 8920            2029         MOV.W   R2,R0
0009F1 B930            2030         MOVS.W  R3,#00H
0009F3 964842rr        2031         MOV.B   ES,#SEG( _CmdNdx )
0009F7 9918rrrr        2032         MOV.W   R1,#SOF( _CmdNdx )
0009FB 8A09            2033         MOV.W   [R1],R0
0009FD 964842rr        2034         MOV.B   ES,#SEG( _Cmd )
000A01 85AArrrr        2035         MOV.B   [R2+SOF( _Cmd )],R5L
                       2036 ; rs232par.c  458                                       State = StateP8;
000A05 964842rr        2038         MOV.B   ES,#SEG( _State )
XA assembler v2.0 r2                    SN00085795-037 (c) 1998 TASKING, Inc.
                                                                                                                            Page  26

ADDR   CODE            LINE SOURCELINE
000A09 9908rrrr        2039         MOV.W   R0,#SOF( _State )
000A0D 920808          2040         MOV.B   [R0],#08H
                       2041 ; rs232par.c  459                                       return( Ready);
000A10 910802          2043         MOV.B   R0L,#02H
                       2044         BR      _384
000A13 D50C5E         +2044         JMP.L   _384
                       2045 ; rs232par.c  460                               }
000A16                 2047 _66:
                       2048 ; rs232par.c  461       
                       2049 ; rs232par.c  462                               if ( isnewline(c))
000A16 91A40A          2051         CMP.B   R5L,#0AH
000A19 F21A            2052         BNE     _67
                       2053 ; rs232par.c  463                               {
                       2054 ; rs232par.c  464                                       Cmd[++CmdNdx] = 0;
000A1B 964842rr        2056         MOV.B   ES,#SEG( _CmdNdx )
000A1F 9908rrrr        2057         MOV.W   R0,#SOF( _CmdNdx )
000A23 8A00            2058         MOV.W   R0,[R0]
000A25 A901            2059         ADDS.W  R0,#01H
000A27 8920            2060         MOV.W   R2,R0
000A29 B930            2061         MOVS.W  R3,#00H
000A2B 964842rr        2062         MOV.B   ES,#SEG( _CmdNdx )
000A2F 9918rrrr        2063         MOV.W   R1,#SOF( _CmdNdx )
000A33 8A09            2064         MOV.W   [R1],R0
000A35 964842rr        2065         MOV.B   ES,#SEG( _Cmd )
000A39 B520rrrr        2066         MOV.B   [R2+SOF( _Cmd )],#00H
                       2067 ; rs232par.c  465                                       State = StateP0;
000A3D 964842rr        2069         MOV.B   ES,#SEG( _State )
000A41 9908rrrr        2070         MOV.W   R0,#SOF( _State )
000A45 B200            2071         MOV.B   [R0],#00H
                       2072 ; rs232par.c  466                                       return( PMT);
000A47 910804          2074         MOV.B   R0L,#04H
                       2075         BR      _384
000A4A D50C43         +2075         JMP.L   _384
                       2076 ; rs232par.c  467                               }
000A4E                 2078 _67:
                       2079 ; rs232par.c  468       
                       2080 ; rs232par.c  469                               SCPIError = InvalidChar;
000A4E 964842rr        2082         MOV.B   ES,#SEG( _SCPIError )
000A52 9908rrrr        2083         MOV.W   R0,#SOF( _SCPIError )
000A56 BA02            2084         MOV.W   [R0],#02H
                       2085 ; rs232par.c  470                               State = StateERROR;
000A58 964842rr        2087         MOV.B   ES,#SEG( _State )
000A5C 9908rrrr        2088         MOV.W   R0,#SOF( _State )
000A60 92081E          2089         MOV.B   [R0],#01EH
                       2090 ; rs232par.c  471                               break;
                       2092         BR      _329
000A63 D50C2A         +2092         JMP.L   _329
                       2093 ; rs232par.c  472       
                       2094 ; rs232par.c  473                       case StateP8:
000A66                 2096 _68:
                       2097 ; rs232par.c  474                               if ( iswhitespace(c))
000A66 91A40A          2099         CMP.B   R5L,#0AH
000A69 F30A            2100         BEQ     _70
000A6B 91A420          2101         CMP.B   R5L,#020H
000A6E FC07            2102         BGT     _70
                       2103 ; rs232par.c  475                               {
                       2104 ; rs232par.c  476                                       State = StateP8;
000A70 964842rr        2106         MOV.B   ES,#SEG( _State )
000A74 9908rrrr        2107         MOV.W   R0,#SOF( _State )
000A78 920808          2108         MOV.B   [R0],#08H
                       2109 ; rs232par.c  477                                       break;
                       2111         BR      _329
XA assembler v2.0 r2                    SN00085795-037 (c) 1998 TASKING, Inc.
                                                                                                                            Page  27

ADDR   CODE            LINE SOURCELINE
000A7B D50C1E         +2111         JMP.L   _329
                       2112 ; rs232par.c  478                               }
000A7E                 2114 _70:
                       2115 ; rs232par.c  479       
                       2116 ; rs232par.c  480                               if ( isalpha(c))
000A7E 814A            2118         MOV.B   R2L,R5L
000A80 9059            2119         SEXT.B  R2H
000A82 9839            2120         SEXT.W  R3
000A84 9918rrrr        2121         MOV.W   R1,#SEG( __ctype_+1 )
000A88 9908rrrr        2122         MOV.W   R0,#SOF( __ctype_+1 )
000A8C 0902            2123         ADD.W   R0,R2
000A8E 964842rr        2124         MOV.B   ES,#SEG( __ctype_+1 )
000A92 8542rrrr        2125         MOV.B   R2L,[R2+SOF( __ctype_+1 )]
000A96 9059            2126         SEXT.B  R2H
000A98 99250003        2127         AND.W   R2,#03H
000A9C F323            2128         BEQ     _71
                       2129 ; rs232par.c  481                               {
                       2130 ; rs232par.c  482                                       Cmd[++CmdNdx] = c;
000A9E 964842rr        2132         MOV.B   ES,#SEG( _CmdNdx )
000AA2 9908rrrr        2133         MOV.W   R0,#SOF( _CmdNdx )
000AA6 8A00            2134         MOV.W   R0,[R0]
000AA8 A901            2135         ADDS.W  R0,#01H
000AAA 8920            2136         MOV.W   R2,R0
000AAC B930            2137         MOVS.W  R3,#00H
000AAE 964842rr        2138         MOV.B   ES,#SEG( _CmdNdx )
000AB2 9918rrrr        2139         MOV.W   R1,#SOF( _CmdNdx )
000AB6 8A09            2140         MOV.W   [R1],R0
000AB8 964842rr        2141         MOV.B   ES,#SEG( _Cmd )
000ABC 85AArrrr        2142         MOV.B   [R2+SOF( _Cmd )],R5L
                       2143 ; rs232par.c  483                                       State = StateC0;
000AC0 964842rr        2145         MOV.B   ES,#SEG( _State )
000AC4 9908rrrr        2146         MOV.W   R0,#SOF( _State )
000AC8 920809          2147         MOV.B   [R0],#09H
                       2148 ; rs232par.c  484                                       ParCnt++;
000ACB 964842rr        2150         MOV.B   ES,#SEG( _ParCnt )
000ACF 9908rrrr        2151         MOV.W   R0,#SOF( _ParCnt )
000AD3 8200            2152         MOV.B   R0L,[R0]
000AD5 A101            2153         ADDS.B  R0L,#01H
000AD7 964842rr        2154         MOV.B   ES,#SEG( _ParCnt )
000ADB 9918rrrr        2155         MOV.W   R1,#SOF( _ParCnt )
000ADF 8209            2156         MOV.B   [R1],R0L
                       2157 ; rs232par.c  485                                       break;
                       2159         BR      _329
000AE1 D50BEB         +2159         JMP.L   _329
                       2160 ; rs232par.c  486                               }
000AE4                 2162 _71:
                       2163 ; rs232par.c  487       
                       2164 ; rs232par.c  488                               if ( isdigit(c))
000AE4 862C42          2166         MOV.B   ES,R1L
000AE7 8200            2167         MOV.B   R0L,[R0]
000AE9 9019            2168         SEXT.B  R0H
000AEB 99050004        2169         AND.W   R0,#04H
000AEF F324            2170         BEQ     _72
                       2171 ; rs232par.c  489                               {
                       2172 ; rs232par.c  490                                       Cmd[++CmdNdx] = c;
000AF1 964842rr        2174         MOV.B   ES,#SEG( _CmdNdx )
000AF5 9908rrrr        2175         MOV.W   R0,#SOF( _CmdNdx )
000AF9 8A00            2176         MOV.W   R0,[R0]
000AFB A901            2177         ADDS.W  R0,#01H
000AFD 8920            2178         MOV.W   R2,R0
000AFF B930            2179         MOVS.W  R3,#00H
000B01 964842rr        2180         MOV.B   ES,#SEG( _CmdNdx )
XA assembler v2.0 r2                    SN00085795-037 (c) 1998 TASKING, Inc.
                                                                                                                            Page  28

ADDR   CODE            LINE SOURCELINE
000B05 9918rrrr        2181         MOV.W   R1,#SOF( _CmdNdx )
000B09 8A09            2182         MOV.W   [R1],R0
000B0B 964842rr        2183         MOV.B   ES,#SEG( _Cmd )
000B0F 85AArrrr        2184         MOV.B   [R2+SOF( _Cmd )],R5L
                       2185 ; rs232par.c  491                                       State = StateD2;
000B13 964842rr        2187         MOV.B   ES,#SEG( _State )
000B17 9908rrrr        2188         MOV.W   R0,#SOF( _State )
000B1B 92080C          2189         MOV.B   [R0],#0CH
                       2190 ; rs232par.c  492                                       ParCnt++;
000B1E 964842rr        2192         MOV.B   ES,#SEG( _ParCnt )
000B22 9908rrrr        2193         MOV.W   R0,#SOF( _ParCnt )
000B26 8200            2194         MOV.B   R0L,[R0]
000B28 A101            2195         ADDS.B  R0L,#01H
000B2A 964842rr        2196         MOV.B   ES,#SEG( _ParCnt )
000B2E 9918rrrr        2197         MOV.W   R1,#SOF( _ParCnt )
000B32 8209            2198         MOV.B   [R1],R0L
                       2199 ; rs232par.c  493                                       break;
                       2201         BR      _329
000B34 D50BC2         +2201         JMP.L   _329
                       2202 ; rs232par.c  494                               }
000B38                 2204 _72:
                       2205 ; rs232par.c  495       
                       2206 ; rs232par.c  496                               if ( isplussign(c) || isminussign(c))
000B38 91A42B          2208         CMP.B   R5L,#02BH
000B3B F303            2209         BEQ     _73
000B3D 91A42D          2210         CMP.B   R5L,#02DH
000B40 F223            2211         BNE     _74
000B40 F223            2211         BNE     _74
000B42                 2212 _73:
                       2213 ; rs232par.c  497                               {
                       2214 ; rs232par.c  498                                       Cmd[++CmdNdx] = c;
000B42 964842rr        2216         MOV.B   ES,#SEG( _CmdNdx )
000B46 9908rrrr        2217         MOV.W   R0,#SOF( _CmdNdx )
000B4A 8A00            2218         MOV.W   R0,[R0]
000B4C A901            2219         ADDS.W  R0,#01H
000B4E 8920            2220         MOV.W   R2,R0
000B50 B930            2221         MOVS.W  R3,#00H
000B52 964842rr        2222         MOV.B   ES,#SEG( _CmdNdx )
000B56 9918rrrr        2223         MOV.W   R1,#SOF( _CmdNdx )
000B5A 8A09            2224         MOV.W   [R1],R0
000B5C 964842rr        2225         MOV.B   ES,#SEG( _Cmd )
000B60 85AArrrr        2226         MOV.B   [R2+SOF( _Cmd )],R5L
                       2227 ; rs232par.c  499                                       State = StateD0;
000B64 964842rr        2229         MOV.B   ES,#SEG( _State )
000B68 9908rrrr        2230         MOV.W   R0,#SOF( _State )
000B6C 92080A          2231         MOV.B   [R0],#0AH
                       2232 ; rs232par.c  500                                       ParCnt++;
000B6F 964842rr        2234         MOV.B   ES,#SEG( _ParCnt )
000B73 9908rrrr        2235         MOV.W   R0,#SOF( _ParCnt )
000B77 8200            2236         MOV.B   R0L,[R0]
000B79 A101            2237         ADDS.B  R0L,#01H
000B7B 964842rr        2238         MOV.B   ES,#SEG( _ParCnt )
000B7F 9918rrrr        2239         MOV.W   R1,#SOF( _ParCnt )
000B83 8209            2240         MOV.B   [R1],R0L
                       2241 ; rs232par.c  501                                       break;
                       2243         BR      _329
000B85 D50B99         +2243         JMP.L   _329
                       2244 ; rs232par.c  502                               }
000B88                 2246 _74:
                       2247 ; rs232par.c  503       
                       2248 ; rs232par.c  504                               if ( isdot(c))
000B88 91A42E          2250         CMP.B   R5L,#02EH
XA assembler v2.0 r2                    SN00085795-037 (c) 1998 TASKING, Inc.
                                                                                                                            Page  29

ADDR   CODE            LINE SOURCELINE
000B8B F224            2251         BNE     _75
                       2252 ; rs232par.c  505                               {
                       2253 ; rs232par.c  506                                       Cmd[++CmdNdx] = c;
000B8D 964842rr        2255         MOV.B   ES,#SEG( _CmdNdx )
000B91 9908rrrr        2256         MOV.W   R0,#SOF( _CmdNdx )
000B95 8A00            2257         MOV.W   R0,[R0]
000B97 A901            2258         ADDS.W  R0,#01H
000B99 8920            2259         MOV.W   R2,R0
000B9B B930            2260         MOVS.W  R3,#00H
000B9D 964842rr        2261         MOV.B   ES,#SEG( _CmdNdx )
000BA1 9918rrrr        2262         MOV.W   R1,#SOF( _CmdNdx )
000BA5 8A09            2263         MOV.W   [R1],R0
000BA7 964842rr        2264         MOV.B   ES,#SEG( _Cmd )
000BAB 85AArrrr        2265         MOV.B   [R2+SOF( _Cmd )],R5L
                       2266 ; rs232par.c  507                                       State = StateD1;
000BAF 964842rr        2268         MOV.B   ES,#SEG( _State )
000BB3 9908rrrr        2269         MOV.W   R0,#SOF( _State )
000BB7 92080B          2270         MOV.B   [R0],#0BH
                       2271 ; rs232par.c  508                                       ParCnt++;
000BBA 964842rr        2273         MOV.B   ES,#SEG( _ParCnt )
000BBE 9908rrrr        2274         MOV.W   R0,#SOF( _ParCnt )
000BC2 8200            2275         MOV.B   R0L,[R0]
000BC4 A101            2276         ADDS.B  R0L,#01H
000BC6 964842rr        2277         MOV.B   ES,#SEG( _ParCnt )
000BCA 9918rrrr        2278         MOV.W   R1,#SOF( _ParCnt )
000BCE 8209            2279         MOV.B   [R1],R0L
                       2280 ; rs232par.c  509                                       break;
                       2282         BR      _329
000BD0 D50B74         +2282         JMP.L   _329
                       2283 ; rs232par.c  510                               }
000BD4                 2285 _75:
                       2286 ; rs232par.c  511       
                       2287 ; rs232par.c  512                               if ( isdoubledagger(c))
000BD4 91A423          2289         CMP.B   R5L,#023H
000BD7 F213            2290         BNE     _76
                       2291 ; rs232par.c  513                               {
                       2292 ; rs232par.c  514                                       State = StateDA0;
000BD9 964842rr        2294         MOV.B   ES,#SEG( _State )
000BDD 9908rrrr        2295         MOV.W   R0,#SOF( _State )
000BE1 920816          2296         MOV.B   [R0],#016H
                       2297 ; rs232par.c  515                                       ParCnt++;
000BE4 964842rr        2299         MOV.B   ES,#SEG( _ParCnt )
000BE8 9908rrrr        2300         MOV.W   R0,#SOF( _ParCnt )
000BEC 8200            2301         MOV.B   R0L,[R0]
000BEE A101            2302         ADDS.B  R0L,#01H
000BF0 964842rr        2303         MOV.B   ES,#SEG( _ParCnt )
000BF4 9918rrrr        2304         MOV.W   R1,#SOF( _ParCnt )
000BF8 8209            2305         MOV.B   [R1],R0L
                       2306 ; rs232par.c  516                                       break;
                       2308         BR      _329
000BFA D50B5F         +2308         JMP.L   _329
                       2309 ; rs232par.c  517                               }
000BFE                 2311 _76:
                       2312 ; rs232par.c  518       
                       2313 ; rs232par.c  519                               if ( isdoublequote(c))
000BFE 91A422          2315         CMP.B   R5L,#022H
000C01 F21E            2316         BNE     _77
                       2317 ; rs232par.c  520                               {                                                
                                                                                    
                       2318 ; rs232par.c  521                                       CmdNdx++;
000C03 964842rr        2320         MOV.B   ES,#SEG( _CmdNdx )
000C07 9908rrrr        2321         MOV.W   R0,#SOF( _CmdNdx )
XA assembler v2.0 r2                    SN00085795-037 (c) 1998 TASKING, Inc.
                                                                                                                            Page  30

ADDR   CODE            LINE SOURCELINE
000C0B 8A00            2322         MOV.W   R0,[R0]
000C0D A901            2323         ADDS.W  R0,#01H
000C0F 964842rr        2324         MOV.B   ES,#SEG( _CmdNdx )
000C13 9918rrrr        2325         MOV.W   R1,#SOF( _CmdNdx )
000C17 8A09            2326         MOV.W   [R1],R0
                       2327 ; rs232par.c  522                                       State = StateS2;
000C19 964842rr        2329         MOV.B   ES,#SEG( _State )
000C1D 9908rrrr        2330         MOV.W   R0,#SOF( _State )
000C21 920814          2331         MOV.B   [R0],#014H
                       2332 ; rs232par.c  523                                       ParCnt++;
000C24 964842rr        2334         MOV.B   ES,#SEG( _ParCnt )
000C28 9908rrrr        2335         MOV.W   R0,#SOF( _ParCnt )
000C2C 8200            2336         MOV.B   R0L,[R0]
000C2E A101            2337         ADDS.B  R0L,#01H
000C30 964842rr        2338         MOV.B   ES,#SEG( _ParCnt )
000C34 9918rrrr        2339         MOV.W   R1,#SOF( _ParCnt )
000C38 8209            2340         MOV.B   [R1],R0L
                       2341 ; rs232par.c  524                                       break;
                       2343         BR      _329
000C3A D50B3F         +2343         JMP.L   _329
                       2344 ; rs232par.c  525                               }
000C3E                 2346 _77:
                       2347 ; rs232par.c  526       
                       2348 ; rs232par.c  527                               if ( isquote(c)) {
000C3E 91A427          2350         CMP.B   R5L,#027H
000C41 F21E            2351         BNE     _78
                       2352 ; rs232par.c  528                                       CmdNdx++;
000C43 964842rr        2354         MOV.B   ES,#SEG( _CmdNdx )
000C47 9908rrrr        2355         MOV.W   R0,#SOF( _CmdNdx )
000C4B 8A00            2356         MOV.W   R0,[R0]
000C4D A901            2357         ADDS.W  R0,#01H
000C4F 964842rr        2358         MOV.B   ES,#SEG( _CmdNdx )
000C53 9918rrrr        2359         MOV.W   R1,#SOF( _CmdNdx )
000C57 8A09            2360         MOV.W   [R1],R0
                       2361 ; rs232par.c  529                                       State = StateS0;
000C59 964842rr        2363         MOV.B   ES,#SEG( _State )
000C5D 9908rrrr        2364         MOV.W   R0,#SOF( _State )
000C61 920812          2365         MOV.B   [R0],#012H
                       2366 ; rs232par.c  530                                       ParCnt++;
000C64 964842rr        2368         MOV.B   ES,#SEG( _ParCnt )
000C68 9908rrrr        2369         MOV.W   R0,#SOF( _ParCnt )
000C6C 8200            2370         MOV.B   R0L,[R0]
000C6E A101            2371         ADDS.B  R0L,#01H
000C70 964842rr        2372         MOV.B   ES,#SEG( _ParCnt )
000C74 9918rrrr        2373         MOV.W   R1,#SOF( _ParCnt )
000C78 8209            2374         MOV.B   [R1],R0L
                       2375 ; rs232par.c  531                                       break;
                       2377         BR      _329
000C7A D50B1F         +2377         JMP.L   _329
                       2378 ; rs232par.c  532                               }
000C7E                 2380 _78:
                       2381 ; rs232par.c  533       
                       2382 ; rs232par.c  534                               if ( (c) == '(')
000C7E 91A428          2384         CMP.B   R5L,#028H
000C81 F213            2385         BNE     _79
                       2386 ; rs232par.c  535                               {
                       2387 ; rs232par.c  536                                       State = StateE0;
000C83 964842rr        2389         MOV.B   ES,#SEG( _State )
000C87 9908rrrr        2390         MOV.W   R0,#SOF( _State )
000C8B 92081D          2391         MOV.B   [R0],#01DH
                       2392 ; rs232par.c  537                                       ParCnt++;
000C8E 964842rr        2394         MOV.B   ES,#SEG( _ParCnt )
XA assembler v2.0 r2                    SN00085795-037 (c) 1998 TASKING, Inc.
                                                                                                                            Page  31

ADDR   CODE            LINE SOURCELINE
000C92 9908rrrr        2395         MOV.W   R0,#SOF( _ParCnt )
000C96 8200            2396         MOV.B   R0L,[R0]
000C98 A101            2397         ADDS.B  R0L,#01H
000C9A 964842rr        2398         MOV.B   ES,#SEG( _ParCnt )
000C9E 9918rrrr        2399         MOV.W   R1,#SOF( _ParCnt )
000CA2 8209            2400         MOV.B   [R1],R0L
                       2401 ; rs232par.c  538                                       break;
                       2403         BR      _329
000CA4 D50B0A         +2403         JMP.L   _329
                       2404 ; rs232par.c  539                               }
000CA8                 2406 _79:
                       2407 ; rs232par.c  540       
                       2408 ; rs232par.c  541                               SCPIError = InvalidChar;
000CA8 964842rr        2410         MOV.B   ES,#SEG( _SCPIError )
000CAC 9908rrrr        2411         MOV.W   R0,#SOF( _SCPIError )
000CB0 BA02            2412         MOV.W   [R0],#02H
                       2413 ; rs232par.c  542                               State = StateERROR;
000CB2 964842rr        2415         MOV.B   ES,#SEG( _State )
000CB6 9908rrrr        2416         MOV.W   R0,#SOF( _State )
000CBA 92081E          2417         MOV.B   [R0],#01EH
                       2418 ; rs232par.c  543                               break;
                       2420         BR      _329
000CBD D50AFD         +2420         JMP.L   _329
                       2421 ; rs232par.c  544       
                       2422 ; rs232par.c  545                       case StateC0:                                            
                                     // CHARACTER PROGRAM DATA
000CC0                 2424 _80:
                       2425 ; rs232par.c  546                               if ( iswhitespace(c)) {
000CC0 91A40A          2427         CMP.B   R5L,#0AH
000CC3 F315            2428         BEQ     _82
000CC5 91A420          2429         CMP.B   R5L,#020H
000CC8 FC12            2430         BGT     _82
                       2431 ; rs232par.c  547                                       State = StateP7;
000CCA 964842rr        2433         MOV.B   ES,#SEG( _State )
000CCE 9908rrrr        2434         MOV.W   R0,#SOF( _State )
000CD2 B207            2435         MOV.B   [R0],#07H
                       2436 ; rs232par.c  548                                       
                       2437 ; rs232par.c  549                                       ParType[ParCnt] = P_Char;
000CD4 964842rr        2439         MOV.B   ES,#SEG( _ParCnt )
000CD8 9908rrrr        2440         MOV.W   R0,#SOF( _ParCnt )
000CDC 8200            2441         MOV.B   R0L,[R0]
000CDE B110            2442         MOVS.B  R0H,#00H
000CE0 B910            2443         MOVS.W  R1,#00H
000CE2 964842rr        2444         MOV.B   ES,#SEG( _ParType )
000CE6 B501rrrr        2445         MOV.B   [R0+SOF( _ParType )],#01H
                       2446 ; rs232par.c  550                                       break;
                       2448         BR      _329
000CEA D50AE7         +2448         JMP.L   _329
                       2449 ; rs232par.c  551                               }
000CEE                 2451 _82:
                       2452 ; rs232par.c  552       
                       2453 ; rs232par.c  553                               if ( isalpha(c) || isunderscore(c) || isdigit(c))
                             {
000CEE 810A            2455         MOV.B   R0L,R5L
000CF0 9019            2456         SEXT.B  R0H
000CF2 9819            2457         SEXT.W  R1
000CF4 964842rr        2458         MOV.B   ES,#SEG( __ctype_+1 )
000CF8 8500rrrr        2459         MOV.B   R0L,[R0+SOF( __ctype_+1 )]
000CFC 911803          2460         MOV.B   R0H,#03H
000CFF 5110            2461         AND.B   R0H,R0L
000D01 F206            2462         BNE     _84
000D03 91A45F          2463         CMP.B   R5L,#05FH
XA assembler v2.0 r2                    SN00085795-037 (c) 1998 TASKING, Inc.
                                                                                                                            Page  32

ADDR   CODE            LINE SOURCELINE
000D06 F303            2464         BEQ     _84
000D08 910504          2465         AND.B   R0L,#04H
000D0B F324            2466         BEQ     _86
000D0B F32400          2466         BEQ     _86
000D0E                 2467 _84:
                       2468 ; rs232par.c  554                                       if ( CmdNdx < 11) {
000D0E 964842rr        2470         MOV.B   ES,#SEG( _CmdNdx )
000D12 9908rrrr        2471         MOV.W   R0,#SOF( _CmdNdx )
000D16 8A00            2472         MOV.W   R0,[R0]
000D18 9904000B        2473         CMP.W   R0,#0BH
000D1C F00E            2474         BCC     _85
                       2475 ; rs232par.c  555                                               Cmd[++CmdNdx] = c;
000D1E A901            2477         ADDS.W  R0,#01H
000D20 8920            2478         MOV.W   R2,R0
000D22 B930            2479         MOVS.W  R3,#00H
000D24 964842rr        2480         MOV.B   ES,#SEG( _CmdNdx )
000D28 9918rrrr        2481         MOV.W   R1,#SOF( _CmdNdx )
000D2C 8A09            2482         MOV.W   [R1],R0
000D2E 964842rr        2483         MOV.B   ES,#SEG( _Cmd )
000D32 85AArrrr        2484         MOV.B   [R2+SOF( _Cmd )],R5L
                       2485 ; rs232par.c  556                                               break;
                       2487         BR      _329
000D36 D50AC1         +2487         JMP.L   _329
                       2488 ; rs232par.c  557                                       }
000D3A                 2490 _85:
                       2491 ; rs232par.c  558                                       SCPIError = PrgmMnemonicTooLong;
000D3A 964842rr        2493         MOV.B   ES,#SEG( _SCPIError )
000D3E 9908rrrr        2494         MOV.W   R0,#SOF( _SCPIError )
000D42 9A08000A        2495         MOV.W   [R0],#0AH
                       2496 ; rs232par.c  559                                       State = StateERROR;
000D46 964842rr        2498         MOV.B   ES,#SEG( _State )
000D4A 9908rrrr        2499         MOV.W   R0,#SOF( _State )
000D4E 92081E          2500         MOV.B   [R0],#01EH
                       2501 ; rs232par.c  560                                       break;
                       2503         BR      _329
000D51 D50AB3         +2503         JMP.L   _329
                       2504 ; rs232par.c  561                               }
000D54                 2506 _86:
                       2507 ; rs232par.c  562       
                       2508 ; rs232par.c  563                               if ( issemicolon(c))
000D54 91A43B          2510         CMP.B   R5L,#03BH
000D57 F225            2511         BNE     _87
                       2512 ; rs232par.c  564                               {
                       2513 ; rs232par.c  565                                       Cmd[++CmdNdx] = 0;
000D59 964842rr        2515         MOV.B   ES,#SEG( _CmdNdx )
000D5D 9908rrrr        2516         MOV.W   R0,#SOF( _CmdNdx )
000D61 8A00            2517         MOV.W   R0,[R0]
000D63 A901            2518         ADDS.W  R0,#01H
000D65 8920            2519         MOV.W   R2,R0
000D67 B930            2520         MOVS.W  R3,#00H
000D69 964842rr        2521         MOV.B   ES,#SEG( _CmdNdx )
000D6D 9918rrrr        2522         MOV.W   R1,#SOF( _CmdNdx )
000D71 8A09            2523         MOV.W   [R1],R0
000D73 964842rr        2524         MOV.B   ES,#SEG( _Cmd )
000D77 B520rrrr        2525         MOV.B   [R2+SOF( _Cmd )],#00H
                       2526 ; rs232par.c  566                                       State = StateP0;
000D7B 964842rr        2528         MOV.B   ES,#SEG( _State )
000D7F 9908rrrr        2529         MOV.W   R0,#SOF( _State )
000D83 B200            2530         MOV.B   [R0],#00H
                       2531 ; rs232par.c  567                                       ParType[ParCnt] = P_Char;
000D85 964842rr        2533         MOV.B   ES,#SEG( _ParCnt )
000D89 9908rrrr        2534         MOV.W   R0,#SOF( _ParCnt )
XA assembler v2.0 r2                    SN00085795-037 (c) 1998 TASKING, Inc.
                                                                                                                            Page  33

ADDR   CODE            LINE SOURCELINE
000D8D 8200            2535         MOV.B   R0L,[R0]
000D8F B110            2536         MOVS.B  R0H,#00H
000D91 B910            2537         MOVS.W  R1,#00H
000D93 964842rr        2538         MOV.B   ES,#SEG( _ParType )
000D97 B501rrrr        2539         MOV.B   [R0+SOF( _ParType )],#01H
                       2540 ; rs232par.c  568                                       return( PMUS);
000D9B 910803          2542         MOV.B   R0L,#03H
                       2543         BR      _384
000D9E D50A99         +2543         JMP.L   _384
                       2544 ; rs232par.c  569                               }
000DA2                 2546 _87:
                       2547 ; rs232par.c  570       
                       2548 ; rs232par.c  571                               if ( iscomma(c))
000DA2 91A42C          2550         CMP.B   R5L,#02CH
000DA5 F225            2551         BNE     _88
                       2552 ; rs232par.c  572                               {
                       2553 ; rs232par.c  573                                       Cmd[++CmdNdx] = c;
000DA7 964842rr        2555         MOV.B   ES,#SEG( _CmdNdx )
000DAB 9908rrrr        2556         MOV.W   R0,#SOF( _CmdNdx )
000DAF 8A00            2557         MOV.W   R0,[R0]
000DB1 A901            2558         ADDS.W  R0,#01H
000DB3 8920            2559         MOV.W   R2,R0
000DB5 B930            2560         MOVS.W  R3,#00H
000DB7 964842rr        2561         MOV.B   ES,#SEG( _CmdNdx )
000DBB 9918rrrr        2562         MOV.W   R1,#SOF( _CmdNdx )
000DBF 8A09            2563         MOV.W   [R1],R0
000DC1 964842rr        2564         MOV.B   ES,#SEG( _Cmd )
000DC5 85AArrrr        2565         MOV.B   [R2+SOF( _Cmd )],R5L
                       2566 ; rs232par.c  574                                       State = StateP8;
000DC9 964842rr        2568         MOV.B   ES,#SEG( _State )
000DCD 9908rrrr        2569         MOV.W   R0,#SOF( _State )
000DD1 920808          2570         MOV.B   [R0],#08H
                       2571 ; rs232par.c  575                                       ParType[ParCnt] = P_Char;
000DD4 964842rr        2573         MOV.B   ES,#SEG( _ParCnt )
000DD8 9908rrrr        2574         MOV.W   R0,#SOF( _ParCnt )
000DDC 8200            2575         MOV.B   R0L,[R0]
000DDE B110            2576         MOVS.B  R0H,#00H
000DE0 B910            2577         MOVS.W  R1,#00H
000DE2 964842rr        2578         MOV.B   ES,#SEG( _ParType )
000DE6 B501rrrr        2579         MOV.B   [R0+SOF( _ParType )],#01H
                       2580 ; rs232par.c  576                                       return( Ready);
000DEA 910802          2582         MOV.B   R0L,#02H
                       2583         BR      _384
000DED D50A71         +2583         JMP.L   _384
                       2584 ; rs232par.c  577                               }
000DF0                 2586 _88:
                       2587 ; rs232par.c  578       
                       2588 ; rs232par.c  579                               if ( isnewline(c))
000DF0 91A40A          2590         CMP.B   R5L,#0AH
000DF3 F225            2591         BNE     _89
                       2592 ; rs232par.c  580                               {
                       2593 ; rs232par.c  581                                       Cmd[++CmdNdx] = 0;
000DF5 964842rr        2595         MOV.B   ES,#SEG( _CmdNdx )
000DF9 9908rrrr        2596         MOV.W   R0,#SOF( _CmdNdx )
000DFD 8A00            2597         MOV.W   R0,[R0]
000DFF A901            2598         ADDS.W  R0,#01H
000E01 8920            2599         MOV.W   R2,R0
000E03 B930            2600         MOVS.W  R3,#00H
000E05 964842rr        2601         MOV.B   ES,#SEG( _CmdNdx )
000E09 9918rrrr        2602         MOV.W   R1,#SOF( _CmdNdx )
000E0D 8A09            2603         MOV.W   [R1],R0
000E0F 964842rr        2604         MOV.B   ES,#SEG( _Cmd )
XA assembler v2.0 r2                    SN00085795-037 (c) 1998 TASKING, Inc.
                                                                                                                            Page  34

ADDR   CODE            LINE SOURCELINE
000E13 B520rrrr        2605         MOV.B   [R2+SOF( _Cmd )],#00H
                       2606 ; rs232par.c  582                                       State = StateP0;
000E17 964842rr        2608         MOV.B   ES,#SEG( _State )
000E1B 9908rrrr        2609         MOV.W   R0,#SOF( _State )
000E1F B200            2610         MOV.B   [R0],#00H
                       2611 ; rs232par.c  583                                       ParType[ParCnt] = P_Char;
000E21 964842rr        2613         MOV.B   ES,#SEG( _ParCnt )
000E25 9908rrrr        2614         MOV.W   R0,#SOF( _ParCnt )
000E29 8200            2615         MOV.B   R0L,[R0]
000E2B B110            2616         MOVS.B  R0H,#00H
000E2D B910            2617         MOVS.W  R1,#00H
000E2F 964842rr        2618         MOV.B   ES,#SEG( _ParType )
000E33 B501rrrr        2619         MOV.B   [R0+SOF( _ParType )],#01H
                       2620 ; rs232par.c  584                                       return( PMT);
000E37 910804          2622         MOV.B   R0L,#04H
                       2623         BR      _384
000E3A D50A4B         +2623         JMP.L   _384
                       2624 ; rs232par.c  585                               }
000E3E                 2626 _89:
                       2627 ; rs232par.c  586       
                       2628 ; rs232par.c  587                               SCPIError = InvalidChar;
000E3E 964842rr        2630         MOV.B   ES,#SEG( _SCPIError )
000E42 9908rrrr        2631         MOV.W   R0,#SOF( _SCPIError )
000E46 BA02            2632         MOV.W   [R0],#02H
                       2633 ; rs232par.c  588                               State = StateERROR;
000E48 964842rr        2635         MOV.B   ES,#SEG( _State )
000E4C 9908rrrr        2636         MOV.W   R0,#SOF( _State )
000E50 92081E          2637         MOV.B   [R0],#01EH
                       2638 ; rs232par.c  589                               break;
                       2640         BR      _329
000E53 D50A32         +2640         JMP.L   _329
                       2641 ; rs232par.c  590       
                       2642 ; rs232par.c  591                       case StateD0:                                            
                                     // NUMERIC DECIMAL PROGRAM DATA
000E56                 2644 _90:
                       2645 ; rs232par.c  592                               if ( isdigit(c))
000E56 810A            2647         MOV.B   R0L,R5L
000E58 9019            2648         SEXT.B  R0H
000E5A 9819            2649         SEXT.W  R1
000E5C 964842rr        2650         MOV.B   ES,#SEG( __ctype_+1 )
000E60 8500rrrr        2651         MOV.B   R0L,[R0+SOF( __ctype_+1 )]
000E64 9019            2652         SEXT.B  R0H
000E66 99050004        2653         AND.W   R0,#04H
000E6A F318            2654         BEQ     _91
                       2655 ; rs232par.c  593                               {
                       2656 ; rs232par.c  594                                       Cmd[++CmdNdx] = c;
000E6C 964842rr        2658         MOV.B   ES,#SEG( _CmdNdx )
000E70 9908rrrr        2659         MOV.W   R0,#SOF( _CmdNdx )
000E74 8A00            2660         MOV.W   R0,[R0]
000E76 A901            2661         ADDS.W  R0,#01H
000E78 8920            2662         MOV.W   R2,R0
000E7A B930            2663         MOVS.W  R3,#00H
000E7C 964842rr        2664         MOV.B   ES,#SEG( _CmdNdx )
000E80 9918rrrr        2665         MOV.W   R1,#SOF( _CmdNdx )
000E84 8A09            2666         MOV.W   [R1],R0
000E86 964842rr        2667         MOV.B   ES,#SEG( _Cmd )
000E8A 85AArrrr        2668         MOV.B   [R2+SOF( _Cmd )],R5L
                       2669 ; rs232par.c  595                                       State = StateD2;
000E8E 964842rr        2671         MOV.B   ES,#SEG( _State )
000E92 9908rrrr        2672         MOV.W   R0,#SOF( _State )
000E96 92080C          2673         MOV.B   [R0],#0CH
                       2674 ; rs232par.c  596                                       break;
XA assembler v2.0 r2                    SN00085795-037 (c) 1998 TASKING, Inc.
                                                                                                                            Page  35

ADDR   CODE            LINE SOURCELINE
                       2676         BR      _329
000E99 D50A0F         +2676         JMP.L   _329
                       2677 ; rs232par.c  597                               }
000E9C                 2679 _91:
                       2680 ; rs232par.c  598       
                       2681 ; rs232par.c  599                               if ( isdot(c))
000E9C 91A42E          2683         CMP.B   R5L,#02EH
000E9F F219            2684         BNE     _92
                       2685 ; rs232par.c  600                               {
                       2686 ; rs232par.c  601                                       Cmd[++CmdNdx] = c;
000EA1 964842rr        2688         MOV.B   ES,#SEG( _CmdNdx )
000EA5 9908rrrr        2689         MOV.W   R0,#SOF( _CmdNdx )
000EA9 8A00            2690         MOV.W   R0,[R0]
000EAB A901            2691         ADDS.W  R0,#01H
000EAD 8920            2692         MOV.W   R2,R0
000EAF B930            2693         MOVS.W  R3,#00H
000EB1 964842rr        2694         MOV.B   ES,#SEG( _CmdNdx )
000EB5 9918rrrr        2695         MOV.W   R1,#SOF( _CmdNdx )
000EB9 8A09            2696         MOV.W   [R1],R0
000EBB 964842rr        2697         MOV.B   ES,#SEG( _Cmd )
000EBF 85AArrrr        2698         MOV.B   [R2+SOF( _Cmd )],R5L
                       2699 ; rs232par.c  602                                       State = StateD1;
000EC3 964842rr        2701         MOV.B   ES,#SEG( _State )
000EC7 9908rrrr        2702         MOV.W   R0,#SOF( _State )
000ECB 92080B          2703         MOV.B   [R0],#0BH
                       2704 ; rs232par.c  603                                       break;
                       2706         BR      _329
000ECE D509F5         +2706         JMP.L   _329
                       2707 ; rs232par.c  604                               }
000ED2                 2709 _92:
                       2710 ; rs232par.c  605       
                       2711 ; rs232par.c  606                               SCPIError = InvalidCharInNumber;
000ED2 964842rr        2713         MOV.B   ES,#SEG( _SCPIError )
000ED6 9908rrrr        2714         MOV.W   R0,#SOF( _SCPIError )
000EDA 9A08000E        2715         MOV.W   [R0],#0EH
                       2716 ; rs232par.c  607                               State = StateERROR;
000EDE 964842rr        2718         MOV.B   ES,#SEG( _State )
000EE2 9908rrrr        2719         MOV.W   R0,#SOF( _State )
000EE6 92081E          2720         MOV.B   [R0],#01EH
                       2721 ; rs232par.c  608                               break;
                       2723         BR      _329
000EE9 D509E7         +2723         JMP.L   _329
                       2724 ; rs232par.c  609       
                       2725 ; rs232par.c  610                       case StateD1:
000EEC                 2727 _93:
                       2728 ; rs232par.c  611                               if ( isdigit(c))
000EEC 810A            2730         MOV.B   R0L,R5L
000EEE 9019            2731         SEXT.B  R0H
000EF0 9819            2732         SEXT.W  R1
000EF2 964842rr        2733         MOV.B   ES,#SEG( __ctype_+1 )
000EF6 8500rrrr        2734         MOV.B   R0L,[R0+SOF( __ctype_+1 )]
000EFA 9019            2735         SEXT.B  R0H
000EFC 99050004        2736         AND.W   R0,#04H
000F00 F328            2737         BEQ     _95
                       2738 ; rs232par.c  612                               {
                       2739 ; rs232par.c  613                                       if ( CmdNdx < 255)
000F02 964842rr        2741         MOV.B   ES,#SEG( _CmdNdx )
000F06 9908rrrr        2742         MOV.W   R0,#SOF( _CmdNdx )
000F0A 8A00            2743         MOV.W   R0,[R0]
000F0C 990400FF        2744         CMP.W   R0,#0FFH
000F10 F013            2745         BCC     _94
                       2746 ; rs232par.c  614                                       {
XA assembler v2.0 r2                    SN00085795-037 (c) 1998 TASKING, Inc.
                                                                                                                            Page  36

ADDR   CODE            LINE SOURCELINE
                       2747 ; rs232par.c  615                                               Cmd[++CmdNdx] = c;
000F12 A901            2749         ADDS.W  R0,#01H
000F14 8920            2750         MOV.W   R2,R0
000F16 B930            2751         MOVS.W  R3,#00H
000F18 964842rr        2752         MOV.B   ES,#SEG( _CmdNdx )
000F1C 9918rrrr        2753         MOV.W   R1,#SOF( _CmdNdx )
000F20 8A09            2754         MOV.W   [R1],R0
000F22 964842rr        2755         MOV.B   ES,#SEG( _Cmd )
000F26 85AArrrr        2756         MOV.B   [R2+SOF( _Cmd )],R5L
                       2757 ; rs232par.c  616                                               State = StateD3;
000F2A 964842rr        2759         MOV.B   ES,#SEG( _State )
000F2E 9908rrrr        2760         MOV.W   R0,#SOF( _State )
000F32 92080D          2761         MOV.B   [R0],#0DH
                       2762 ; rs232par.c  617                                               break;
                       2764         BR      _329
000F35 D509C1         +2764         JMP.L   _329
                       2765 ; rs232par.c  618                                       }
000F38                 2767 _94:
                       2768 ; rs232par.c  619                                       SCPIError = TooManyDigits;
000F38 964842rr        2770         MOV.B   ES,#SEG( _SCPIError )
000F3C 9908rrrr        2771         MOV.W   R0,#SOF( _SCPIError )
000F40 9A080010        2772         MOV.W   [R0],#010H
                       2773 ; rs232par.c  620                                       State = StateERROR;
000F44 964842rr        2775         MOV.B   ES,#SEG( _State )
000F48 9908rrrr        2776         MOV.W   R0,#SOF( _State )
000F4C 92081E          2777         MOV.B   [R0],#01EH
                       2778 ; rs232par.c  621                                       break;
                       2780         BR      _329
000F4F D509B4         +2780         JMP.L   _329
                       2781 ; rs232par.c  622                               }
000F52                 2783 _95:
                       2784 ; rs232par.c  623       
                       2785 ; rs232par.c  624                               SCPIError = InvalidCharInNumber;
000F52 964842rr        2787         MOV.B   ES,#SEG( _SCPIError )
000F56 9908rrrr        2788         MOV.W   R0,#SOF( _SCPIError )
000F5A 9A08000E        2789         MOV.W   [R0],#0EH
                       2790 ; rs232par.c  625                               State = StateERROR;
000F5E 964842rr        2792         MOV.B   ES,#SEG( _State )
000F62 9908rrrr        2793         MOV.W   R0,#SOF( _State )
000F66 92081E          2794         MOV.B   [R0],#01EH
                       2795 ; rs232par.c  626                               break;
                       2797         BR      _329
000F69 D509A7         +2797         JMP.L   _329
                       2798 ; rs232par.c  627       
                       2799 ; rs232par.c  628                       case StateD2:
000F6C                 2801 _96:
                       2802 ; rs232par.c  629                               if ( iswhitespace(c))
000F6C 91A40A          2804         CMP.B   R5L,#0AH
000F6F F315            2805         BEQ     _98
000F71 91A420          2806         CMP.B   R5L,#020H
000F74 FC12            2807         BGT     _98
                       2808 ; rs232par.c  630                               {
                       2809 ; rs232par.c  631                                       State = StateD4;
000F76 964842rr        2811         MOV.B   ES,#SEG( _State )
000F7A 9908rrrr        2812         MOV.W   R0,#SOF( _State )
000F7E 92080E          2813         MOV.B   [R0],#0EH
                       2814 ; rs232par.c  632                                       ParType[ParCnt] = P_DecNum;
000F81 964842rr        2816         MOV.B   ES,#SEG( _ParCnt )
000F85 9908rrrr        2817         MOV.W   R0,#SOF( _ParCnt )
000F89 8200            2818         MOV.B   R0L,[R0]
000F8B B110            2819         MOVS.B  R0H,#00H
000F8D B910            2820         MOVS.W  R1,#00H
XA assembler v2.0 r2                    SN00085795-037 (c) 1998 TASKING, Inc.
                                                                                                                            Page  37

ADDR   CODE            LINE SOURCELINE
000F8F 964842rr        2821         MOV.B   ES,#SEG( _ParType )
000F93 B502rrrr        2822         MOV.B   [R0+SOF( _ParType )],#02H
                       2823 ; rs232par.c  633                                       break;
                       2825         BR      _329
000F97 D50990         +2825         JMP.L   _329
                       2826 ; rs232par.c  634                               }
000F9A                 2828 _98:
                       2829 ; rs232par.c  635       
                       2830 ; rs232par.c  636                               if ( isdigit(c))
000F9A 810A            2832         MOV.B   R0L,R5L
000F9C 9019            2833         SEXT.B  R0H
000F9E 9819            2834         SEXT.W  R1
000FA0 964842rr        2835         MOV.B   ES,#SEG( __ctype_+1 )
000FA4 8500rrrr        2836         MOV.B   R0L,[R0+SOF( __ctype_+1 )]
000FA8 9019            2837         SEXT.B  R0H
000FAA 99050004        2838         AND.W   R0,#04H
000FAE F323            2839         BEQ     _100
                       2840 ; rs232par.c  637                               {
                       2841 ; rs232par.c  638                                       if ( CmdNdx < 255)
000FB0 964842rr        2843         MOV.B   ES,#SEG( _CmdNdx )
000FB4 9908rrrr        2844         MOV.W   R0,#SOF( _CmdNdx )
000FB8 8A00            2845         MOV.W   R0,[R0]
000FBA 990400FF        2846         CMP.W   R0,#0FFH
000FBE F00E            2847         BCC     _99
                       2848 ; rs232par.c  639                                       {
                       2849 ; rs232par.c  640                                               Cmd[++CmdNdx] = c;
000FC0 A901            2851         ADDS.W  R0,#01H
000FC2 8920            2852         MOV.W   R2,R0
000FC4 B930            2853         MOVS.W  R3,#00H
000FC6 964842rr        2854         MOV.B   ES,#SEG( _CmdNdx )
000FCA 9918rrrr        2855         MOV.W   R1,#SOF( _CmdNdx )
000FCE 8A09            2856         MOV.W   [R1],R0
000FD0 964842rr        2857         MOV.B   ES,#SEG( _Cmd )
000FD4 85AArrrr        2858         MOV.B   [R2+SOF( _Cmd )],R5L
                       2859 ; rs232par.c  641                                               break;
                       2861         BR      _329
000FD8 D50970         +2861         JMP.L   _329
                       2862 ; rs232par.c  642                                       }
000FDC                 2864 _99:
                       2865 ; rs232par.c  643                                       SCPIError = TooManyDigits;
000FDC 964842rr        2867         MOV.B   ES,#SEG( _SCPIError )
000FE0 9908rrrr        2868         MOV.W   R0,#SOF( _SCPIError )
000FE4 9A080010        2869         MOV.W   [R0],#010H
                       2870 ; rs232par.c  644                                       State = StateERROR;
000FE8 964842rr        2872         MOV.B   ES,#SEG( _State )
000FEC 9908rrrr        2873         MOV.W   R0,#SOF( _State )
000FF0 92081E          2874         MOV.B   [R0],#01EH
                       2875 ; rs232par.c  645                                       break;
                       2877         BR      _329
000FF3 D50962         +2877         JMP.L   _329
                       2878 ; rs232par.c  646                               }
000FF6                 2880 _100:
                       2881 ; rs232par.c  647       
                       2882 ; rs232par.c  648                               if ( issemicolon(c))
000FF6 91A43B          2884         CMP.B   R5L,#03BH
000FF9 F225            2885         BNE     _101
                       2886 ; rs232par.c  649                               {
                       2887 ; rs232par.c  650                                       Cmd[++CmdNdx] = 0;
000FFB 964842rr        2889         MOV.B   ES,#SEG( _CmdNdx )
000FFF 9908rrrr        2890         MOV.W   R0,#SOF( _CmdNdx )
001003 8A00            2891         MOV.W   R0,[R0]
001005 A901            2892         ADDS.W  R0,#01H
XA assembler v2.0 r2                    SN00085795-037 (c) 1998 TASKING, Inc.
                                                                                                                            Page  38

ADDR   CODE            LINE SOURCELINE
001007 8920            2893         MOV.W   R2,R0
001009 B930            2894         MOVS.W  R3,#00H
00100B 964842rr        2895         MOV.B   ES,#SEG( _CmdNdx )
00100F 9918rrrr        2896         MOV.W   R1,#SOF( _CmdNdx )
001013 8A09            2897         MOV.W   [R1],R0
001015 964842rr        2898         MOV.B   ES,#SEG( _Cmd )
001019 B520rrrr        2899         MOV.B   [R2+SOF( _Cmd )],#00H
                       2900 ; rs232par.c  651                                       State = StateP0;
00101D 964842rr        2902         MOV.B   ES,#SEG( _State )
001021 9908rrrr        2903         MOV.W   R0,#SOF( _State )
001025 B200            2904         MOV.B   [R0],#00H
                       2905 ; rs232par.c  652                                       ParType[ParCnt] = P_DecNum;
001027 964842rr        2907         MOV.B   ES,#SEG( _ParCnt )
00102B 9908rrrr        2908         MOV.W   R0,#SOF( _ParCnt )
00102F 8200            2909         MOV.B   R0L,[R0]
001031 B110            2910         MOVS.B  R0H,#00H
001033 B910            2911         MOVS.W  R1,#00H
001035 964842rr        2912         MOV.B   ES,#SEG( _ParType )
001039 B502rrrr        2913         MOV.B   [R0+SOF( _ParType )],#02H
                       2914 ; rs232par.c  653                                       return( PMUS);
00103D 910803          2916         MOV.B   R0L,#03H
                       2917         BR      _384
001040 D50948         +2917         JMP.L   _384
                       2918 ; rs232par.c  654                               }
001044                 2920 _101:
                       2921 ; rs232par.c  655       
                       2922 ; rs232par.c  656                               if ( isdot(c))
001044 91A42E          2924         CMP.B   R5L,#02EH
001047 F229            2925         BNE     _103
                       2926 ; rs232par.c  657                               {
                       2927 ; rs232par.c  658                                       if ( ++CmdNdx < 255)
001049 964842rr        2929         MOV.B   ES,#SEG( _CmdNdx )
00104D 9908rrrr        2930         MOV.W   R0,#SOF( _CmdNdx )
001051 8A00            2931         MOV.W   R0,[R0]
001053 A901            2932         ADDS.W  R0,#01H
001055 8910            2933         MOV.W   R1,R0
001057 964842rr        2934         MOV.B   ES,#SEG( _CmdNdx )
00105B 9928rrrr        2935         MOV.W   R2,#SOF( _CmdNdx )
00105F 8A1A            2936         MOV.W   [R2],R1
001061 991400FF        2937         CMP.W   R1,#0FFH
001065 F00D            2938         BCC     _102
                       2939 ; rs232par.c  659                                       {
                       2940 ; rs232par.c  660                                               Cmd[CmdNdx] = c;
001067 B910            2942         MOVS.W  R1,#00H
001069 964842rr        2943         MOV.B   ES,#SEG( _Cmd )
00106D 85A8rrrr        2944         MOV.B   [R0+SOF( _Cmd )],R5L
                       2945 ; rs232par.c  661                                               State = StateD3;
001071 964842rr        2947         MOV.B   ES,#SEG( _State )
001075 9908rrrr        2948         MOV.W   R0,#SOF( _State )
001079 92080D          2949         MOV.B   [R0],#0DH
                       2950 ; rs232par.c  662                                               break;
                       2952         BR      _329
00107C D5091E         +2952         JMP.L   _329
                       2953 ; rs232par.c  663                                       }
001080                 2955 _102:
                       2956 ; rs232par.c  664                                       SCPIError = TooManyDigits;
001080 964842rr        2958         MOV.B   ES,#SEG( _SCPIError )
001084 9908rrrr        2959         MOV.W   R0,#SOF( _SCPIError )
001088 9A080010        2960         MOV.W   [R0],#010H
                       2961 ; rs232par.c  665                                       State = StateERROR;
00108C 964842rr        2963         MOV.B   ES,#SEG( _State )
001090 9908rrrr        2964         MOV.W   R0,#SOF( _State )
XA assembler v2.0 r2                    SN00085795-037 (c) 1998 TASKING, Inc.
                                                                                                                            Page  39

ADDR   CODE            LINE SOURCELINE
001094 92081E          2965         MOV.B   [R0],#01EH
                       2966 ; rs232par.c  666                                       break;
                       2968         BR      _329
001097 D50910         +2968         JMP.L   _329
                       2969 ; rs232par.c  667                               }
00109A                 2971 _103:
                       2972 ; rs232par.c  668       
                       2973 ; rs232par.c  669                               if ( iscomma(c))
00109A 91A42C          2975         CMP.B   R5L,#02CH
00109D F225            2976         BNE     _104
                       2977 ; rs232par.c  670                               {
                       2978 ; rs232par.c  671                                       Cmd[++CmdNdx] = c;
00109F 964842rr        2980         MOV.B   ES,#SEG( _CmdNdx )
0010A3 9908rrrr        2981         MOV.W   R0,#SOF( _CmdNdx )
0010A7 8A00            2982         MOV.W   R0,[R0]
0010A9 A901            2983         ADDS.W  R0,#01H
0010AB 8920            2984         MOV.W   R2,R0
0010AD B930            2985         MOVS.W  R3,#00H
0010AF 964842rr        2986         MOV.B   ES,#SEG( _CmdNdx )
0010B3 9918rrrr        2987         MOV.W   R1,#SOF( _CmdNdx )
0010B7 8A09            2988         MOV.W   [R1],R0
0010B9 964842rr        2989         MOV.B   ES,#SEG( _Cmd )
0010BD 85AArrrr        2990         MOV.B   [R2+SOF( _Cmd )],R5L
                       2991 ; rs232par.c  672                                       State = StateP8;
0010C1 964842rr        2993         MOV.B   ES,#SEG( _State )
0010C5 9908rrrr        2994         MOV.W   R0,#SOF( _State )
0010C9 920808          2995         MOV.B   [R0],#08H
                       2996 ; rs232par.c  673                                       ParType[ParCnt] = P_DecNum;
0010CC 964842rr        2998         MOV.B   ES,#SEG( _ParCnt )
0010D0 9908rrrr        2999         MOV.W   R0,#SOF( _ParCnt )
0010D4 8200            3000         MOV.B   R0L,[R0]
0010D6 B110            3001         MOVS.B  R0H,#00H
0010D8 B910            3002         MOVS.W  R1,#00H
0010DA 964842rr        3003         MOV.B   ES,#SEG( _ParType )
0010DE B502rrrr        3004         MOV.B   [R0+SOF( _ParType )],#02H
                       3005 ; rs232par.c  674                                       return( Ready);
0010E2 910802          3007         MOV.B   R0L,#02H
                       3008         BR      _384
0010E5 D508F5         +3008         JMP.L   _384
                       3009 ; rs232par.c  675                               }
0010E8                 3011 _104:
                       3012 ; rs232par.c  676       
                       3013 ; rs232par.c  677                               if ( (c) == 'E')
0010E8 91A445          3015         CMP.B   R5L,#045H
0010EB F229            3016         BNE     _106
                       3017 ; rs232par.c  678                               {
                       3018 ; rs232par.c  679                                       if ( CmdNdx < 255)
0010ED 964842rr        3020         MOV.B   ES,#SEG( _CmdNdx )
0010F1 9908rrrr        3021         MOV.W   R0,#SOF( _CmdNdx )
0010F5 8A00            3022         MOV.W   R0,[R0]
0010F7 990400FF        3023         CMP.W   R0,#0FFH
0010FB F014            3024         BCC     _105
                       3025 ; rs232par.c  680                                       {
                       3026 ; rs232par.c  681                                               Cmd[++CmdNdx] = c;
0010FD A901            3028         ADDS.W  R0,#01H
0010FF 8920            3029         MOV.W   R2,R0
001101 B930            3030         MOVS.W  R3,#00H
001103 964842rr        3031         MOV.B   ES,#SEG( _CmdNdx )
001107 9918rrrr        3032         MOV.W   R1,#SOF( _CmdNdx )
00110B 8A09            3033         MOV.W   [R1],R0
00110D 964842rr        3034         MOV.B   ES,#SEG( _Cmd )
001111 85AArrrr        3035         MOV.B   [R2+SOF( _Cmd )],R5L
XA assembler v2.0 r2                    SN00085795-037 (c) 1998 TASKING, Inc.
                                                                                                                            Page  40

ADDR   CODE            LINE SOURCELINE
                       3036 ; rs232par.c  682                                               State = StateD5;
001115 964842rr        3038         MOV.B   ES,#SEG( _State )
001119 9908rrrr        3039         MOV.W   R0,#SOF( _State )
00111D 92080F          3040         MOV.B   [R0],#0FH
                       3041 ; rs232par.c  683                                               break;
                       3043         BR      _329
001120 D508CC         +3043         JMP.L   _329
                       3044 ; rs232par.c  684                                       }
001124                 3046 _105:
                       3047 ; rs232par.c  685                                       SCPIError = TooManyDigits;               
                                                    // TBD
001124 964842rr        3049         MOV.B   ES,#SEG( _SCPIError )
001128 9908rrrr        3050         MOV.W   R0,#SOF( _SCPIError )
00112C 9A080010        3051         MOV.W   [R0],#010H
                       3052 ; rs232par.c  686                                       State = StateERROR;
001130 964842rr        3054         MOV.B   ES,#SEG( _State )
001134 9908rrrr        3055         MOV.W   R0,#SOF( _State )
001138 92081E          3056         MOV.B   [R0],#01EH
                       3057 ; rs232par.c  687                                       break;
                       3059         BR      _329
00113B D508BE         +3059         JMP.L   _329
                       3060 ; rs232par.c  688                               }
00113E                 3062 _106:
                       3063 ; rs232par.c  689       
                       3064 ; rs232par.c  690                               if ( isnewline(c))
00113E 91A40A          3066         CMP.B   R5L,#0AH
001141 F225            3067         BNE     _107
                       3068 ; rs232par.c  691                               {
                       3069 ; rs232par.c  692                                       Cmd[++CmdNdx] = 0;
001143 964842rr        3071         MOV.B   ES,#SEG( _CmdNdx )
001147 9908rrrr        3072         MOV.W   R0,#SOF( _CmdNdx )
00114B 8A00            3073         MOV.W   R0,[R0]
00114D A901            3074         ADDS.W  R0,#01H
00114F 8920            3075         MOV.W   R2,R0
001151 B930            3076         MOVS.W  R3,#00H
001153 964842rr        3077         MOV.B   ES,#SEG( _CmdNdx )
001157 9918rrrr        3078         MOV.W   R1,#SOF( _CmdNdx )
00115B 8A09            3079         MOV.W   [R1],R0
00115D 964842rr        3080         MOV.B   ES,#SEG( _Cmd )
001161 B520rrrr        3081         MOV.B   [R2+SOF( _Cmd )],#00H
                       3082 ; rs232par.c  693                                       State = StateP0;
001165 964842rr        3084         MOV.B   ES,#SEG( _State )
001169 9908rrrr        3085         MOV.W   R0,#SOF( _State )
00116D B200            3086         MOV.B   [R0],#00H
                       3087 ; rs232par.c  694                                       ParType[ParCnt] = P_DecNum;
00116F 964842rr        3089         MOV.B   ES,#SEG( _ParCnt )
001173 9908rrrr        3090         MOV.W   R0,#SOF( _ParCnt )
001177 8200            3091         MOV.B   R0L,[R0]
001179 B110            3092         MOVS.B  R0H,#00H
00117B B910            3093         MOVS.W  R1,#00H
00117D 964842rr        3094         MOV.B   ES,#SEG( _ParType )
001181 B502rrrr        3095         MOV.B   [R0+SOF( _ParType )],#02H
                       3096 ; rs232par.c  695                                       return( PMT);
001185 910804          3098         MOV.B   R0L,#04H
                       3099         BR      _384
001188 D508A4         +3099         JMP.L   _384
                       3100 ; rs232par.c  696                               }
00118C                 3102 _107:
                       3103 ; rs232par.c  697       
                       3104 ; rs232par.c  698                               SCPIError = InvalidChar;
00118C 964842rr        3106         MOV.B   ES,#SEG( _SCPIError )
001190 9908rrrr        3107         MOV.W   R0,#SOF( _SCPIError )
XA assembler v2.0 r2                    SN00085795-037 (c) 1998 TASKING, Inc.
                                                                                                                            Page  41

ADDR   CODE            LINE SOURCELINE
001194 BA02            3108         MOV.W   [R0],#02H
                       3109 ; rs232par.c  699                               State = StateERROR;
001196 964842rr        3111         MOV.B   ES,#SEG( _State )
00119A 9908rrrr        3112         MOV.W   R0,#SOF( _State )
00119E 92081E          3113         MOV.B   [R0],#01EH
                       3114 ; rs232par.c  700                               break;
                       3116         BR      _329
0011A1 D5088B         +3116         JMP.L   _329
                       3117 ; rs232par.c  701       
                       3118 ; rs232par.c  702                       case StateD3:
0011A4                 3120 _108:
                       3121 ; rs232par.c  703                               if ( iswhitespace(c))
0011A4 91A40A          3123         CMP.B   R5L,#0AH
0011A7 F315            3124         BEQ     _110
0011A9 91A420          3125         CMP.B   R5L,#020H
0011AC FC12            3126         BGT     _110
                       3127 ; rs232par.c  704                               {
                       3128 ; rs232par.c  705                                       State = StateD4;
0011AE 964842rr        3130         MOV.B   ES,#SEG( _State )
0011B2 9908rrrr        3131         MOV.W   R0,#SOF( _State )
0011B6 92080E          3132         MOV.B   [R0],#0EH
                       3133 ; rs232par.c  706                                       ParType[ParCnt] = P_DecNum;
0011B9 964842rr        3135         MOV.B   ES,#SEG( _ParCnt )
0011BD 9908rrrr        3136         MOV.W   R0,#SOF( _ParCnt )
0011C1 8200            3137         MOV.B   R0L,[R0]
0011C3 B110            3138         MOVS.B  R0H,#00H
0011C5 B910            3139         MOVS.W  R1,#00H
0011C7 964842rr        3140         MOV.B   ES,#SEG( _ParType )
0011CB B502rrrr        3141         MOV.B   [R0+SOF( _ParType )],#02H
                       3142 ; rs232par.c  707                                       break;
                       3144         BR      _329
0011CF D50874         +3144         JMP.L   _329
                       3145 ; rs232par.c  708                               }
0011D2                 3147 _110:
                       3148 ; rs232par.c  709       
                       3149 ; rs232par.c  710                               if ( isdigit(c))
0011D2 810A            3151         MOV.B   R0L,R5L
0011D4 9019            3152         SEXT.B  R0H
0011D6 9819            3153         SEXT.W  R1
0011D8 964842rr        3154         MOV.B   ES,#SEG( __ctype_+1 )
0011DC 8500rrrr        3155         MOV.B   R0L,[R0+SOF( __ctype_+1 )]
0011E0 9019            3156         SEXT.B  R0H
0011E2 99050004        3157         AND.W   R0,#04H
0011E6 F328            3158         BEQ     _112
                       3159 ; rs232par.c  711                               {
                       3160 ; rs232par.c  712                                       if ( CmdNdx < 255)
0011E8 964842rr        3162         MOV.B   ES,#SEG( _CmdNdx )
0011EC 9908rrrr        3163         MOV.W   R0,#SOF( _CmdNdx )
0011F0 8A00            3164         MOV.W   R0,[R0]
0011F2 990400FF        3165         CMP.W   R0,#0FFH
0011F6 F013            3166         BCC     _111
                       3167 ; rs232par.c  713                                       {
                       3168 ; rs232par.c  714                                               Cmd[++CmdNdx] = c;
0011F8 A901            3170         ADDS.W  R0,#01H
0011FA 8920            3171         MOV.W   R2,R0
0011FC B930            3172         MOVS.W  R3,#00H
0011FE 964842rr        3173         MOV.B   ES,#SEG( _CmdNdx )
001202 9918rrrr        3174         MOV.W   R1,#SOF( _CmdNdx )
001206 8A09            3175         MOV.W   [R1],R0
001208 964842rr        3176         MOV.B   ES,#SEG( _Cmd )
00120C 85AArrrr        3177         MOV.B   [R2+SOF( _Cmd )],R5L
                       3178 ; rs232par.c  715                                               State = StateD3;
XA assembler v2.0 r2                    SN00085795-037 (c) 1998 TASKING, Inc.
                                                                                                                            Page  42

ADDR   CODE            LINE SOURCELINE
001210 964842rr        3180         MOV.B   ES,#SEG( _State )
001214 9908rrrr        3181         MOV.W   R0,#SOF( _State )
001218 92080D          3182         MOV.B   [R0],#0DH
                       3183 ; rs232par.c  716                                               break;
                       3185         BR      _329
00121B D5084E         +3185         JMP.L   _329
                       3186 ; rs232par.c  717                                       }
00121E                 3188 _111:
                       3189 ; rs232par.c  718                                       SCPIError = TooManyDigits;
00121E 964842rr        3191         MOV.B   ES,#SEG( _SCPIError )
001222 9908rrrr        3192         MOV.W   R0,#SOF( _SCPIError )
001226 9A080010        3193         MOV.W   [R0],#010H
                       3194 ; rs232par.c  719                                       State = StateERROR;
00122A 964842rr        3196         MOV.B   ES,#SEG( _State )
00122E 9908rrrr        3197         MOV.W   R0,#SOF( _State )
001232 92081E          3198         MOV.B   [R0],#01EH
                       3199 ; rs232par.c  720                                       break;
                       3201         BR      _329
001235 D50841         +3201         JMP.L   _329
                       3202 ; rs232par.c  721                               }
001238                 3204 _112:
                       3205 ; rs232par.c  722       
                       3206 ; rs232par.c  723                               if ( issemicolon(c))
001238 91A43B          3208         CMP.B   R5L,#03BH
00123B F225            3209         BNE     _113
                       3210 ; rs232par.c  724                               {
                       3211 ; rs232par.c  725                                       Cmd[++CmdNdx] = 0;
00123D 964842rr        3213         MOV.B   ES,#SEG( _CmdNdx )
001241 9908rrrr        3214         MOV.W   R0,#SOF( _CmdNdx )
001245 8A00            3215         MOV.W   R0,[R0]
001247 A901            3216         ADDS.W  R0,#01H
001249 8920            3217         MOV.W   R2,R0
00124B B930            3218         MOVS.W  R3,#00H
00124D 964842rr        3219         MOV.B   ES,#SEG( _CmdNdx )
001251 9918rrrr        3220         MOV.W   R1,#SOF( _CmdNdx )
001255 8A09            3221         MOV.W   [R1],R0
001257 964842rr        3222         MOV.B   ES,#SEG( _Cmd )
00125B B520rrrr        3223         MOV.B   [R2+SOF( _Cmd )],#00H
                       3224 ; rs232par.c  726                                       State = StateP0;
00125F 964842rr        3226         MOV.B   ES,#SEG( _State )
001263 9908rrrr        3227         MOV.W   R0,#SOF( _State )
001267 B200            3228         MOV.B   [R0],#00H
                       3229 ; rs232par.c  727                                       ParType[ParCnt] = P_DecNum;
001269 964842rr        3231         MOV.B   ES,#SEG( _ParCnt )
00126D 9908rrrr        3232         MOV.W   R0,#SOF( _ParCnt )
001271 8200            3233         MOV.B   R0L,[R0]
001273 B110            3234         MOVS.B  R0H,#00H
001275 B910            3235         MOVS.W  R1,#00H
001277 964842rr        3236         MOV.B   ES,#SEG( _ParType )
00127B B502rrrr        3237         MOV.B   [R0+SOF( _ParType )],#02H
                       3238 ; rs232par.c  728                                       return( PMUS);
00127F 910803          3240         MOV.B   R0L,#03H
                       3241         BR      _384
001282 D50827         +3241         JMP.L   _384
                       3242 ; rs232par.c  729                               }
001286                 3244 _113:
                       3245 ; rs232par.c  730       
                       3246 ; rs232par.c  731                               if ( iscomma(c))
001286 91A42C          3248         CMP.B   R5L,#02CH
001289 F225            3249         BNE     _114
                       3250 ; rs232par.c  732                               {
                       3251 ; rs232par.c  733                                       Cmd[++CmdNdx] = c;
XA assembler v2.0 r2                    SN00085795-037 (c) 1998 TASKING, Inc.
                                                                                                                            Page  43

ADDR   CODE            LINE SOURCELINE
00128B 964842rr        3253         MOV.B   ES,#SEG( _CmdNdx )
00128F 9908rrrr        3254         MOV.W   R0,#SOF( _CmdNdx )
001293 8A00            3255         MOV.W   R0,[R0]
001295 A901            3256         ADDS.W  R0,#01H
001297 8920            3257         MOV.W   R2,R0
001299 B930            3258         MOVS.W  R3,#00H
00129B 964842rr        3259         MOV.B   ES,#SEG( _CmdNdx )
00129F 9918rrrr        3260         MOV.W   R1,#SOF( _CmdNdx )
0012A3 8A09            3261         MOV.W   [R1],R0
0012A5 964842rr        3262         MOV.B   ES,#SEG( _Cmd )
0012A9 85AArrrr        3263         MOV.B   [R2+SOF( _Cmd )],R5L
                       3264 ; rs232par.c  734                                       State = StateP8;
0012AD 964842rr        3266         MOV.B   ES,#SEG( _State )
0012B1 9908rrrr        3267         MOV.W   R0,#SOF( _State )
0012B5 920808          3268         MOV.B   [R0],#08H
                       3269 ; rs232par.c  735                                       ParType[ParCnt] = P_DecNum;
0012B8 964842rr        3271         MOV.B   ES,#SEG( _ParCnt )
0012BC 9908rrrr        3272         MOV.W   R0,#SOF( _ParCnt )
0012C0 8200            3273         MOV.B   R0L,[R0]
0012C2 B110            3274         MOVS.B  R0H,#00H
0012C4 B910            3275         MOVS.W  R1,#00H
0012C6 964842rr        3276         MOV.B   ES,#SEG( _ParType )
0012CA B502rrrr        3277         MOV.B   [R0+SOF( _ParType )],#02H
                       3278 ; rs232par.c  736                                       return( Ready);
0012CE 910802          3280         MOV.B   R0L,#02H
                       3281         BR      _384
0012D1 D507FF         +3281         JMP.L   _384
                       3282 ; rs232par.c  737                               }
0012D4                 3284 _114:
                       3285 ; rs232par.c  738       
                       3286 ; rs232par.c  739                               if ( (c) == 'E')
0012D4 91A445          3288         CMP.B   R5L,#045H
0012D7 F229            3289         BNE     _116
                       3290 ; rs232par.c  740                               {
                       3291 ; rs232par.c  741                                       if ( CmdNdx < 255)
0012D9 964842rr        3293         MOV.B   ES,#SEG( _CmdNdx )
0012DD 9908rrrr        3294         MOV.W   R0,#SOF( _CmdNdx )
0012E1 8A00            3295         MOV.W   R0,[R0]
0012E3 990400FF        3296         CMP.W   R0,#0FFH
0012E7 F014            3297         BCC     _115
                       3298 ; rs232par.c  742                                       {
                       3299 ; rs232par.c  743                                               Cmd[++CmdNdx] = c;
0012E9 A901            3301         ADDS.W  R0,#01H
0012EB 8920            3302         MOV.W   R2,R0
0012ED B930            3303         MOVS.W  R3,#00H
0012EF 964842rr        3304         MOV.B   ES,#SEG( _CmdNdx )
0012F3 9918rrrr        3305         MOV.W   R1,#SOF( _CmdNdx )
0012F7 8A09            3306         MOV.W   [R1],R0
0012F9 964842rr        3307         MOV.B   ES,#SEG( _Cmd )
0012FD 85AArrrr        3308         MOV.B   [R2+SOF( _Cmd )],R5L
                       3309 ; rs232par.c  744                                               State = StateD5;
001301 964842rr        3311         MOV.B   ES,#SEG( _State )
001305 9908rrrr        3312         MOV.W   R0,#SOF( _State )
001309 92080F          3313         MOV.B   [R0],#0FH
                       3314 ; rs232par.c  745                                               break;
                       3316         BR      _329
00130C D507D6         +3316         JMP.L   _329
                       3317 ; rs232par.c  746                                       }
001310                 3319 _115:
                       3320 ; rs232par.c  747                                       SCPIError = TooManyDigits;               
                                    // TBD
001310 964842rr        3322         MOV.B   ES,#SEG( _SCPIError )
XA assembler v2.0 r2                    SN00085795-037 (c) 1998 TASKING, Inc.
                                                                                                                            Page  44

ADDR   CODE            LINE SOURCELINE
001314 9908rrrr        3323         MOV.W   R0,#SOF( _SCPIError )
001318 9A080010        3324         MOV.W   [R0],#010H
                       3325 ; rs232par.c  748                                       State = StateERROR;
00131C 964842rr        3327         MOV.B   ES,#SEG( _State )
001320 9908rrrr        3328         MOV.W   R0,#SOF( _State )
001324 92081E          3329         MOV.B   [R0],#01EH
                       3330 ; rs232par.c  749                                       break;
                       3332         BR      _329
001327 D507C8         +3332         JMP.L   _329
                       3333 ; rs232par.c  750                               }
00132A                 3335 _116:
                       3336 ; rs232par.c  751       
                       3337 ; rs232par.c  752                               if ( isnewline(c))
00132A 91A40A          3339         CMP.B   R5L,#0AH
00132D F225            3340         BNE     _117
                       3341 ; rs232par.c  753                               {
                       3342 ; rs232par.c  754                                       Cmd[++CmdNdx] = 0;
00132F 964842rr        3344         MOV.B   ES,#SEG( _CmdNdx )
001333 9908rrrr        3345         MOV.W   R0,#SOF( _CmdNdx )
001337 8A00            3346         MOV.W   R0,[R0]
001339 A901            3347         ADDS.W  R0,#01H
00133B 8920            3348         MOV.W   R2,R0
00133D B930            3349         MOVS.W  R3,#00H
00133F 964842rr        3350         MOV.B   ES,#SEG( _CmdNdx )
001343 9918rrrr        3351         MOV.W   R1,#SOF( _CmdNdx )
001347 8A09            3352         MOV.W   [R1],R0
001349 964842rr        3353         MOV.B   ES,#SEG( _Cmd )
00134D B520rrrr        3354         MOV.B   [R2+SOF( _Cmd )],#00H
                       3355 ; rs232par.c  755                                       State = StateP0;
001351 964842rr        3357         MOV.B   ES,#SEG( _State )
001355 9908rrrr        3358         MOV.W   R0,#SOF( _State )
001359 B200            3359         MOV.B   [R0],#00H
                       3360 ; rs232par.c  756                                       ParType[ParCnt] = P_DecNum;
00135B 964842rr        3362         MOV.B   ES,#SEG( _ParCnt )
00135F 9908rrrr        3363         MOV.W   R0,#SOF( _ParCnt )
001363 8200            3364         MOV.B   R0L,[R0]
001365 B110            3365         MOVS.B  R0H,#00H
001367 B910            3366         MOVS.W  R1,#00H
001369 964842rr        3367         MOV.B   ES,#SEG( _ParType )
00136D B502rrrr        3368         MOV.B   [R0+SOF( _ParType )],#02H
                       3369 ; rs232par.c  757                                       return( PMT);
001371 910804          3371         MOV.B   R0L,#04H
                       3372         BR      _384
001374 D507AE         +3372         JMP.L   _384
                       3373 ; rs232par.c  758                               }
001378                 3375 _117:
                       3376 ; rs232par.c  759       
                       3377 ; rs232par.c  760                               SCPIError = InvalidChar;
001378 964842rr        3379         MOV.B   ES,#SEG( _SCPIError )
00137C 9908rrrr        3380         MOV.W   R0,#SOF( _SCPIError )
001380 BA02            3381         MOV.W   [R0],#02H
                       3382 ; rs232par.c  761                               State = StateERROR;
001382 964842rr        3384         MOV.B   ES,#SEG( _State )
001386 9908rrrr        3385         MOV.W   R0,#SOF( _State )
00138A 92081E          3386         MOV.B   [R0],#01EH
                       3387 ; rs232par.c  762                               break;
                       3389         BR      _329
00138D D50795         +3389         JMP.L   _329
                       3390 ; rs232par.c  763       
                       3391 ; rs232par.c  764                       case StateD4:
001390                 3393 _118:
                       3394 ; rs232par.c  765                               if ( iswhitespace(c))
XA assembler v2.0 r2                    SN00085795-037 (c) 1998 TASKING, Inc.
                                                                                                                            Page  45

ADDR   CODE            LINE SOURCELINE
001390 91A40A          3396         CMP.B   R5L,#0AH
001393 F30A            3397         BEQ     _120
001395 91A420          3398         CMP.B   R5L,#020H
001398 FC07            3399         BGT     _120
                       3400 ; rs232par.c  766                               {
                       3401 ; rs232par.c  767                                       State = StateD4;
00139A 964842rr        3403         MOV.B   ES,#SEG( _State )
00139E 9908rrrr        3404         MOV.W   R0,#SOF( _State )
0013A2 92080E          3405         MOV.B   [R0],#0EH
                       3406 ; rs232par.c  768                                       break;
                       3408         BR      _329
0013A5 D50789         +3408         JMP.L   _329
                       3409 ; rs232par.c  769                               }
0013A8                 3411 _120:
                       3412 ; rs232par.c  770       
                       3413 ; rs232par.c  771                               if ( issemicolon(c))
0013A8 91A43B          3415         CMP.B   R5L,#03BH
0013AB F225            3416         BNE     _121
                       3417 ; rs232par.c  772                               {
                       3418 ; rs232par.c  773                                       Cmd[++CmdNdx] = 0;
0013AD 964842rr        3420         MOV.B   ES,#SEG( _CmdNdx )
0013B1 9908rrrr        3421         MOV.W   R0,#SOF( _CmdNdx )
0013B5 8A00            3422         MOV.W   R0,[R0]
0013B7 A901            3423         ADDS.W  R0,#01H
0013B9 8920            3424         MOV.W   R2,R0
0013BB B930            3425         MOVS.W  R3,#00H
0013BD 964842rr        3426         MOV.B   ES,#SEG( _CmdNdx )
0013C1 9918rrrr        3427         MOV.W   R1,#SOF( _CmdNdx )
0013C5 8A09            3428         MOV.W   [R1],R0
0013C7 964842rr        3429         MOV.B   ES,#SEG( _Cmd )
0013CB B520rrrr        3430         MOV.B   [R2+SOF( _Cmd )],#00H
                       3431 ; rs232par.c  774                                       State = StateP0;
0013CF 964842rr        3433         MOV.B   ES,#SEG( _State )
0013D3 9908rrrr        3434         MOV.W   R0,#SOF( _State )
0013D7 B200            3435         MOV.B   [R0],#00H
                       3436 ; rs232par.c  775                                       ParType[ParCnt] = P_DecNum;
0013D9 964842rr        3438         MOV.B   ES,#SEG( _ParCnt )
0013DD 9908rrrr        3439         MOV.W   R0,#SOF( _ParCnt )
0013E1 8200            3440         MOV.B   R0L,[R0]
0013E3 B110            3441         MOVS.B  R0H,#00H
0013E5 B910            3442         MOVS.W  R1,#00H
0013E7 964842rr        3443         MOV.B   ES,#SEG( _ParType )
0013EB B502rrrr        3444         MOV.B   [R0+SOF( _ParType )],#02H
                       3445 ; rs232par.c  776                                       return( PMUS);
0013EF 910803          3447         MOV.B   R0L,#03H
                       3448         BR      _384
0013F2 D5076F         +3448         JMP.L   _384
                       3449 ; rs232par.c  777                               }
0013F6                 3451 _121:
                       3452 ; rs232par.c  778       
                       3453 ; rs232par.c  779                               if ( iscomma(c))
0013F6 91A42C          3455         CMP.B   R5L,#02CH
0013F9 F225            3456         BNE     _122
                       3457 ; rs232par.c  780                               {
                       3458 ; rs232par.c  781                                       Cmd[++CmdNdx] = c;
0013FB 964842rr        3460         MOV.B   ES,#SEG( _CmdNdx )
0013FF 9908rrrr        3461         MOV.W   R0,#SOF( _CmdNdx )
001403 8A00            3462         MOV.W   R0,[R0]
001405 A901            3463         ADDS.W  R0,#01H
001407 8920            3464         MOV.W   R2,R0
001409 B930            3465         MOVS.W  R3,#00H
00140B 964842rr        3466         MOV.B   ES,#SEG( _CmdNdx )
XA assembler v2.0 r2                    SN00085795-037 (c) 1998 TASKING, Inc.
                                                                                                                            Page  46

ADDR   CODE            LINE SOURCELINE
00140F 9918rrrr        3467         MOV.W   R1,#SOF( _CmdNdx )
001413 8A09            3468         MOV.W   [R1],R0
001415 964842rr        3469         MOV.B   ES,#SEG( _Cmd )
001419 85AArrrr        3470         MOV.B   [R2+SOF( _Cmd )],R5L
                       3471 ; rs232par.c  782                                       State = StateP8;
00141D 964842rr        3473         MOV.B   ES,#SEG( _State )
001421 9908rrrr        3474         MOV.W   R0,#SOF( _State )
001425 920808          3475         MOV.B   [R0],#08H
                       3476 ; rs232par.c  783                                       ParType[ParCnt] = P_DecNum;
001428 964842rr        3478         MOV.B   ES,#SEG( _ParCnt )
00142C 9908rrrr        3479         MOV.W   R0,#SOF( _ParCnt )
001430 8200            3480         MOV.B   R0L,[R0]
001432 B110            3481         MOVS.B  R0H,#00H
001434 B910            3482         MOVS.W  R1,#00H
001436 964842rr        3483         MOV.B   ES,#SEG( _ParType )
00143A B502rrrr        3484         MOV.B   [R0+SOF( _ParType )],#02H
                       3485 ; rs232par.c  784                                       return( Ready);
00143E 910802          3487         MOV.B   R0L,#02H
                       3488         BR      _384
001441 D50747         +3488         JMP.L   _384
                       3489 ; rs232par.c  785                               }
001444                 3491 _122:
                       3492 ; rs232par.c  786       
                       3493 ; rs232par.c  787                               if ( (c) == 'E')
001444 91A445          3495         CMP.B   R5L,#045H
001447 F229            3496         BNE     _124
                       3497 ; rs232par.c  788                               {
                       3498 ; rs232par.c  789                                       if ( CmdNdx < 255)
001449 964842rr        3500         MOV.B   ES,#SEG( _CmdNdx )
00144D 9908rrrr        3501         MOV.W   R0,#SOF( _CmdNdx )
001451 8A00            3502         MOV.W   R0,[R0]
001453 990400FF        3503         CMP.W   R0,#0FFH
001457 F014            3504         BCC     _123
                       3505 ; rs232par.c  790                                       {
                       3506 ; rs232par.c  791                                               Cmd[++CmdNdx] = c;
001459 A901            3508         ADDS.W  R0,#01H
00145B 8920            3509         MOV.W   R2,R0
00145D B930            3510         MOVS.W  R3,#00H
00145F 964842rr        3511         MOV.B   ES,#SEG( _CmdNdx )
001463 9918rrrr        3512         MOV.W   R1,#SOF( _CmdNdx )
001467 8A09            3513         MOV.W   [R1],R0
001469 964842rr        3514         MOV.B   ES,#SEG( _Cmd )
00146D 85AArrrr        3515         MOV.B   [R2+SOF( _Cmd )],R5L
                       3516 ; rs232par.c  792                                               State = StateD5;
001471 964842rr        3518         MOV.B   ES,#SEG( _State )
001475 9908rrrr        3519         MOV.W   R0,#SOF( _State )
001479 92080F          3520         MOV.B   [R0],#0FH
                       3521 ; rs232par.c  793                                               break;
                       3523         BR      _329
00147C D5071E         +3523         JMP.L   _329
                       3524 ; rs232par.c  794                                       }
001480                 3526 _123:
                       3527 ; rs232par.c  795                                       SCPIError = TooManyDigits;               
                                    // TBD
001480 964842rr        3529         MOV.B   ES,#SEG( _SCPIError )
001484 9908rrrr        3530         MOV.W   R0,#SOF( _SCPIError )
001488 9A080010        3531         MOV.W   [R0],#010H
                       3532 ; rs232par.c  796                                       State = StateERROR;
00148C 964842rr        3534         MOV.B   ES,#SEG( _State )
001490 9908rrrr        3535         MOV.W   R0,#SOF( _State )
001494 92081E          3536         MOV.B   [R0],#01EH
                       3537 ; rs232par.c  797                                       break;
XA assembler v2.0 r2                    SN00085795-037 (c) 1998 TASKING, Inc.
                                                                                                                            Page  47

ADDR   CODE            LINE SOURCELINE
                       3539         BR      _329
001497 D50710         +3539         JMP.L   _329
                       3540 ; rs232par.c  798                               }
00149A                 3542 _124:
                       3543 ; rs232par.c  799       
                       3544 ; rs232par.c  800                               if ( isnewline(c))
00149A 91A40A          3546         CMP.B   R5L,#0AH
00149D F225            3547         BNE     _125
                       3548 ; rs232par.c  801                               {
                       3549 ; rs232par.c  802                                       Cmd[++CmdNdx] = 0;
00149F 964842rr        3551         MOV.B   ES,#SEG( _CmdNdx )
0014A3 9908rrrr        3552         MOV.W   R0,#SOF( _CmdNdx )
0014A7 8A00            3553         MOV.W   R0,[R0]
0014A9 A901            3554         ADDS.W  R0,#01H
0014AB 8920            3555         MOV.W   R2,R0
0014AD B930            3556         MOVS.W  R3,#00H
0014AF 964842rr        3557         MOV.B   ES,#SEG( _CmdNdx )
0014B3 9918rrrr        3558         MOV.W   R1,#SOF( _CmdNdx )
0014B7 8A09            3559         MOV.W   [R1],R0
0014B9 964842rr        3560         MOV.B   ES,#SEG( _Cmd )
0014BD B520rrrr        3561         MOV.B   [R2+SOF( _Cmd )],#00H
                       3562 ; rs232par.c  803                                       State = StateP0;
0014C1 964842rr        3564         MOV.B   ES,#SEG( _State )
0014C5 9908rrrr        3565         MOV.W   R0,#SOF( _State )
0014C9 B200            3566         MOV.B   [R0],#00H
                       3567 ; rs232par.c  804                                       ParType[ParCnt] = P_DecNum;
0014CB 964842rr        3569         MOV.B   ES,#SEG( _ParCnt )
0014CF 9908rrrr        3570         MOV.W   R0,#SOF( _ParCnt )
0014D3 8200            3571         MOV.B   R0L,[R0]
0014D5 B110            3572         MOVS.B  R0H,#00H
0014D7 B910            3573         MOVS.W  R1,#00H
0014D9 964842rr        3574         MOV.B   ES,#SEG( _ParType )
0014DD B502rrrr        3575         MOV.B   [R0+SOF( _ParType )],#02H
                       3576 ; rs232par.c  805                                       return( PMT);
0014E1 910804          3578         MOV.B   R0L,#04H
                       3579         BR      _384
0014E4 D506F6         +3579         JMP.L   _384
                       3580 ; rs232par.c  806                               }
0014E8                 3582 _125:
                       3583 ; rs232par.c  807       
                       3584 ; rs232par.c  808                               SCPIError = InvalidChar;
0014E8 964842rr        3586         MOV.B   ES,#SEG( _SCPIError )
0014EC 9908rrrr        3587         MOV.W   R0,#SOF( _SCPIError )
0014F0 BA02            3588         MOV.W   [R0],#02H
                       3589 ; rs232par.c  809                               State = StateERROR;
0014F2 964842rr        3591         MOV.B   ES,#SEG( _State )
0014F6 9908rrrr        3592         MOV.W   R0,#SOF( _State )
0014FA 92081E          3593         MOV.B   [R0],#01EH
                       3594 ; rs232par.c  810                               break;
                       3596         BR      _329
0014FD D506DD         +3596         JMP.L   _329
                       3597 ; rs232par.c  811       
                       3598 ; rs232par.c  812                       case StateD5:
001500                 3600 _126:
                       3601 ; rs232par.c  813                               if ( iswhitespace(c))
001500 91A40A          3603         CMP.B   R5L,#0AH
001503 F30A            3604         BEQ     _128
001505 91A420          3605         CMP.B   R5L,#020H
001508 FC07            3606         BGT     _128
                       3607 ; rs232par.c  814                               {
                       3608 ; rs232par.c  815                                       State = StateD5;
00150A 964842rr        3610         MOV.B   ES,#SEG( _State )
XA assembler v2.0 r2                    SN00085795-037 (c) 1998 TASKING, Inc.
                                                                                                                            Page  48

ADDR   CODE            LINE SOURCELINE
00150E 9908rrrr        3611         MOV.W   R0,#SOF( _State )
001512 92080F          3612         MOV.B   [R0],#0FH
                       3613 ; rs232par.c  816                                       break;
                       3615         BR      _329
001515 D506D1         +3615         JMP.L   _329
                       3616 ; rs232par.c  817                               }
001518                 3618 _128:
                       3619 ; rs232par.c  818       
                       3620 ; rs232par.c  819                               if ( isdigit(c))
001518 810A            3622         MOV.B   R0L,R5L
00151A 9019            3623         SEXT.B  R0H
00151C 9819            3624         SEXT.W  R1
00151E 964842rr        3625         MOV.B   ES,#SEG( __ctype_+1 )
001522 8500rrrr        3626         MOV.B   R0L,[R0+SOF( __ctype_+1 )]
001526 9019            3627         SEXT.B  R0H
001528 99050004        3628         AND.W   R0,#04H
00152C F328            3629         BEQ     _130
                       3630 ; rs232par.c  820                               {
                       3631 ; rs232par.c  821                                       if ( CmdNdx < 255)
00152E 964842rr        3633         MOV.B   ES,#SEG( _CmdNdx )
001532 9908rrrr        3634         MOV.W   R0,#SOF( _CmdNdx )
001536 8A00            3635         MOV.W   R0,[R0]
001538 990400FF        3636         CMP.W   R0,#0FFH
00153C F013            3637         BCC     _129
                       3638 ; rs232par.c  822                                       {
                       3639 ; rs232par.c  823                                               Cmd[++CmdNdx] = c;
00153E A901            3641         ADDS.W  R0,#01H
001540 8920            3642         MOV.W   R2,R0
001542 B930            3643         MOVS.W  R3,#00H
001544 964842rr        3644         MOV.B   ES,#SEG( _CmdNdx )
001548 9918rrrr        3645         MOV.W   R1,#SOF( _CmdNdx )
00154C 8A09            3646         MOV.W   [R1],R0
00154E 964842rr        3647         MOV.B   ES,#SEG( _Cmd )
001552 85AArrrr        3648         MOV.B   [R2+SOF( _Cmd )],R5L
                       3649 ; rs232par.c  824                                               State = StateD7;
001556 964842rr        3651         MOV.B   ES,#SEG( _State )
00155A 9908rrrr        3652         MOV.W   R0,#SOF( _State )
00155E 920811          3653         MOV.B   [R0],#011H
                       3654 ; rs232par.c  825                                               break;
                       3656         BR      _329
001561 D506AB         +3656         JMP.L   _329
                       3657 ; rs232par.c  826                                       }
001564                 3659 _129:
                       3660 ; rs232par.c  827                                       SCPIError = TooManyDigits;               
                                    // TBD
001564 964842rr        3662         MOV.B   ES,#SEG( _SCPIError )
001568 9908rrrr        3663         MOV.W   R0,#SOF( _SCPIError )
00156C 9A080010        3664         MOV.W   [R0],#010H
                       3665 ; rs232par.c  828                                       State = StateERROR;
001570 964842rr        3667         MOV.B   ES,#SEG( _State )
001574 9908rrrr        3668         MOV.W   R0,#SOF( _State )
001578 92081E          3669         MOV.B   [R0],#01EH
                       3670 ; rs232par.c  829                                       break;
                       3672         BR      _329
00157B D5069E         +3672         JMP.L   _329
                       3673 ; rs232par.c  830                               }
00157E                 3675 _130:
                       3676 ; rs232par.c  831       
                       3677 ; rs232par.c  832                               if ( isplussign(c) || isminussign(c))
00157E 91A42B          3679         CMP.B   R5L,#02BH
001581 F303            3680         BEQ     _131
001583 91A42D          3681         CMP.B   R5L,#02DH
XA assembler v2.0 r2                    SN00085795-037 (c) 1998 TASKING, Inc.
                                                                                                                            Page  49

ADDR   CODE            LINE SOURCELINE
001586 F228            3682         BNE     _133
001586 F228            3682         BNE     _133
001588                 3683 _131:
                       3684 ; rs232par.c  833                               {
                       3685 ; rs232par.c  834                                       if ( CmdNdx < 255)
001588 964842rr        3687         MOV.B   ES,#SEG( _CmdNdx )
00158C 9908rrrr        3688         MOV.W   R0,#SOF( _CmdNdx )
001590 8A00            3689         MOV.W   R0,[R0]
001592 990400FF        3690         CMP.W   R0,#0FFH
001596 F013            3691         BCC     _132
                       3692 ; rs232par.c  835                                       {
                       3693 ; rs232par.c  836                                               Cmd[++CmdNdx] = c;
001598 A901            3695         ADDS.W  R0,#01H
00159A 8920            3696         MOV.W   R2,R0
00159C B930            3697         MOVS.W  R3,#00H
00159E 964842rr        3698         MOV.B   ES,#SEG( _CmdNdx )
0015A2 9918rrrr        3699         MOV.W   R1,#SOF( _CmdNdx )
0015A6 8A09            3700         MOV.W   [R1],R0
0015A8 964842rr        3701         MOV.B   ES,#SEG( _Cmd )
0015AC 85AArrrr        3702         MOV.B   [R2+SOF( _Cmd )],R5L
                       3703 ; rs232par.c  837                                               State = StateD6;
0015B0 964842rr        3705         MOV.B   ES,#SEG( _State )
0015B4 9908rrrr        3706         MOV.W   R0,#SOF( _State )
0015B8 920810          3707         MOV.B   [R0],#010H
                       3708 ; rs232par.c  838                                               break;
                       3710         BR      _329
0015BB D5067E         +3710         JMP.L   _329
                       3711 ; rs232par.c  839                                       }
0015BE                 3713 _132:
                       3714 ; rs232par.c  840                                       SCPIError = TooManyDigits;               
                                    // TBD
0015BE 964842rr        3716         MOV.B   ES,#SEG( _SCPIError )
0015C2 9908rrrr        3717         MOV.W   R0,#SOF( _SCPIError )
0015C6 9A080010        3718         MOV.W   [R0],#010H
                       3719 ; rs232par.c  841                                       State = StateERROR;
0015CA 964842rr        3721         MOV.B   ES,#SEG( _State )
0015CE 9908rrrr        3722         MOV.W   R0,#SOF( _State )
0015D2 92081E          3723         MOV.B   [R0],#01EH
                       3724 ; rs232par.c  842                                       break;
                       3726         BR      _329
0015D5 D50671         +3726         JMP.L   _329
                       3727 ; rs232par.c  843                               }
0015D8                 3729 _133:
                       3730 ; rs232par.c  844       
                       3731 ; rs232par.c  845                               SCPIError = InvalidChar;
0015D8 964842rr        3733         MOV.B   ES,#SEG( _SCPIError )
0015DC 9908rrrr        3734         MOV.W   R0,#SOF( _SCPIError )
0015E0 BA02            3735         MOV.W   [R0],#02H
                       3736 ; rs232par.c  846                               State = StateERROR;
0015E2 964842rr        3738         MOV.B   ES,#SEG( _State )
0015E6 9908rrrr        3739         MOV.W   R0,#SOF( _State )
0015EA 92081E          3740         MOV.B   [R0],#01EH
                       3741 ; rs232par.c  847                               break;
                       3743         BR      _329
0015ED D50665         +3743         JMP.L   _329
                       3744 ; rs232par.c  848       
                       3745 ; rs232par.c  849                       case StateD6:
0015F0                 3747 _134:
                       3748 ; rs232par.c  850                               if ( isdigit(c))
0015F0 810A            3750         MOV.B   R0L,R5L
0015F2 9019            3751         SEXT.B  R0H
0015F4 9819            3752         SEXT.W  R1
XA assembler v2.0 r2                    SN00085795-037 (c) 1998 TASKING, Inc.
                                                                                                                            Page  50

ADDR   CODE            LINE SOURCELINE
0015F6 964842rr        3753         MOV.B   ES,#SEG( __ctype_+1 )
0015FA 8500rrrr        3754         MOV.B   R0L,[R0+SOF( __ctype_+1 )]
0015FE 9019            3755         SEXT.B  R0H
001600 99050004        3756         AND.W   R0,#04H
001604 F328            3757         BEQ     _136
                       3758 ; rs232par.c  851                               {
                       3759 ; rs232par.c  852                                       if ( CmdNdx < 255)
001606 964842rr        3761         MOV.B   ES,#SEG( _CmdNdx )
00160A 9908rrrr        3762         MOV.W   R0,#SOF( _CmdNdx )
00160E 8A00            3763         MOV.W   R0,[R0]
001610 990400FF        3764         CMP.W   R0,#0FFH
001614 F013            3765         BCC     _135
                       3766 ; rs232par.c  853                                       {
                       3767 ; rs232par.c  854                                               Cmd[++CmdNdx] = c;
001616 A901            3769         ADDS.W  R0,#01H
001618 8920            3770         MOV.W   R2,R0
00161A B930            3771         MOVS.W  R3,#00H
00161C 964842rr        3772         MOV.B   ES,#SEG( _CmdNdx )
001620 9918rrrr        3773         MOV.W   R1,#SOF( _CmdNdx )
001624 8A09            3774         MOV.W   [R1],R0
001626 964842rr        3775         MOV.B   ES,#SEG( _Cmd )
00162A 85AArrrr        3776         MOV.B   [R2+SOF( _Cmd )],R5L
                       3777 ; rs232par.c  855                                               State = StateD7;
00162E 964842rr        3779         MOV.B   ES,#SEG( _State )
001632 9908rrrr        3780         MOV.W   R0,#SOF( _State )
001636 920811          3781         MOV.B   [R0],#011H
                       3782 ; rs232par.c  856                                               break;
                       3784         BR      _329
001639 D5063F         +3784         JMP.L   _329
                       3785 ; rs232par.c  857                                       }
00163C                 3787 _135:
                       3788 ; rs232par.c  858                                       SCPIError = TooManyDigits;               
                                    // TBD
00163C 964842rr        3790         MOV.B   ES,#SEG( _SCPIError )
001640 9908rrrr        3791         MOV.W   R0,#SOF( _SCPIError )
001644 9A080010        3792         MOV.W   [R0],#010H
                       3793 ; rs232par.c  859                                       State = StateERROR;
001648 964842rr        3795         MOV.B   ES,#SEG( _State )
00164C 9908rrrr        3796         MOV.W   R0,#SOF( _State )
001650 92081E          3797         MOV.B   [R0],#01EH
                       3798 ; rs232par.c  860                                       break;
                       3800         BR      _329
001653 D50632         +3800         JMP.L   _329
                       3801 ; rs232par.c  861                               }
001656                 3803 _136:
                       3804 ; rs232par.c  862       
                       3805 ; rs232par.c  863                               SCPIError = InvalidChar;
001656 964842rr        3807         MOV.B   ES,#SEG( _SCPIError )
00165A 9908rrrr        3808         MOV.W   R0,#SOF( _SCPIError )
00165E BA02            3809         MOV.W   [R0],#02H
                       3810 ; rs232par.c  864                               State = StateERROR;
001660 964842rr        3812         MOV.B   ES,#SEG( _State )
001664 9908rrrr        3813         MOV.W   R0,#SOF( _State )
001668 92081E          3814         MOV.B   [R0],#01EH
                       3815 ; rs232par.c  865                               break;
                       3817         BR      _329
00166B D50626         +3817         JMP.L   _329
                       3818 ; rs232par.c  866       
                       3819 ; rs232par.c  867                       case StateD7:
00166E                 3821 _137:
                       3822 ; rs232par.c  868                               if ( iswhitespace(c))
00166E 91A40A          3824         CMP.B   R5L,#0AH
XA assembler v2.0 r2                    SN00085795-037 (c) 1998 TASKING, Inc.
                                                                                                                            Page  51

ADDR   CODE            LINE SOURCELINE
001671 F315            3825         BEQ     _139
001673 91A420          3826         CMP.B   R5L,#020H
001676 FC12            3827         BGT     _139
                       3828 ; rs232par.c  869                               {
                       3829 ; rs232par.c  870                                       State = StateP7;
001678 964842rr        3831         MOV.B   ES,#SEG( _State )
00167C 9908rrrr        3832         MOV.W   R0,#SOF( _State )
001680 B207            3833         MOV.B   [R0],#07H
                       3834 ; rs232par.c  871                                       ParType[ParCnt] = P_DecNum;
001682 964842rr        3836         MOV.B   ES,#SEG( _ParCnt )
001686 9908rrrr        3837         MOV.W   R0,#SOF( _ParCnt )
00168A 8200            3838         MOV.B   R0L,[R0]
00168C B110            3839         MOVS.B  R0H,#00H
00168E B910            3840         MOVS.W  R1,#00H
001690 964842rr        3841         MOV.B   ES,#SEG( _ParType )
001694 B502rrrr        3842         MOV.B   [R0+SOF( _ParType )],#02H
                       3843 ; rs232par.c  872                                       break;
                       3845         BR      _329
001698 D50610         +3845         JMP.L   _329
                       3846 ; rs232par.c  873                               }
00169C                 3848 _139:
                       3849 ; rs232par.c  874       
                       3850 ; rs232par.c  875                               if ( isdigit(c))
00169C 810A            3852         MOV.B   R0L,R5L
00169E 9019            3853         SEXT.B  R0H
0016A0 9819            3854         SEXT.W  R1
0016A2 964842rr        3855         MOV.B   ES,#SEG( __ctype_+1 )
0016A6 8500rrrr        3856         MOV.B   R0L,[R0+SOF( __ctype_+1 )]
0016AA 9019            3857         SEXT.B  R0H
0016AC 99050004        3858         AND.W   R0,#04H
0016B0 F323            3859         BEQ     _141
                       3860 ; rs232par.c  876                               {
                       3861 ; rs232par.c  877                                       if ( CmdNdx < 255)
0016B2 964842rr        3863         MOV.B   ES,#SEG( _CmdNdx )
0016B6 9908rrrr        3864         MOV.W   R0,#SOF( _CmdNdx )
0016BA 8A00            3865         MOV.W   R0,[R0]
0016BC 990400FF        3866         CMP.W   R0,#0FFH
0016C0 F00E            3867         BCC     _140
                       3868 ; rs232par.c  878                                       {
                       3869 ; rs232par.c  879                                               Cmd[++CmdNdx] = c;
0016C2 A901            3871         ADDS.W  R0,#01H
0016C4 8920            3872         MOV.W   R2,R0
0016C6 B930            3873         MOVS.W  R3,#00H
0016C8 964842rr        3874         MOV.B   ES,#SEG( _CmdNdx )
0016CC 9918rrrr        3875         MOV.W   R1,#SOF( _CmdNdx )
0016D0 8A09            3876         MOV.W   [R1],R0
0016D2 964842rr        3877         MOV.B   ES,#SEG( _Cmd )
0016D6 85AArrrr        3878         MOV.B   [R2+SOF( _Cmd )],R5L
                       3879 ; rs232par.c  880                                               break;
                       3881         BR      _329
0016DA D505EF         +3881         JMP.L   _329
                       3882 ; rs232par.c  881                                       }
0016DE                 3884 _140:
                       3885 ; rs232par.c  882                                       SCPIError = TooManyDigits;               
                                    // TBD
0016DE 964842rr        3887         MOV.B   ES,#SEG( _SCPIError )
0016E2 9908rrrr        3888         MOV.W   R0,#SOF( _SCPIError )
0016E6 9A080010        3889         MOV.W   [R0],#010H
                       3890 ; rs232par.c  883                                       State = StateERROR;
0016EA 964842rr        3892         MOV.B   ES,#SEG( _State )
0016EE 9908rrrr        3893         MOV.W   R0,#SOF( _State )
0016F2 92081E          3894         MOV.B   [R0],#01EH
XA assembler v2.0 r2                    SN00085795-037 (c) 1998 TASKING, Inc.
                                                                                                                            Page  52

ADDR   CODE            LINE SOURCELINE
                       3895 ; rs232par.c  884                                       break;
                       3897         BR      _329
0016F5 D505E1         +3897         JMP.L   _329
                       3898 ; rs232par.c  885                               }
0016F8                 3900 _141:
                       3901 ; rs232par.c  886       
                       3902 ; rs232par.c  887                               if ( issemicolon(c))
0016F8 91A43B          3904         CMP.B   R5L,#03BH
0016FB F225            3905         BNE     _142
                       3906 ; rs232par.c  888                               {
                       3907 ; rs232par.c  889                                       Cmd[++CmdNdx] = 0;
0016FD 964842rr        3909         MOV.B   ES,#SEG( _CmdNdx )
001701 9908rrrr        3910         MOV.W   R0,#SOF( _CmdNdx )
001705 8A00            3911         MOV.W   R0,[R0]
001707 A901            3912         ADDS.W  R0,#01H
001709 8920            3913         MOV.W   R2,R0
00170B B930            3914         MOVS.W  R3,#00H
00170D 964842rr        3915         MOV.B   ES,#SEG( _CmdNdx )
001711 9918rrrr        3916         MOV.W   R1,#SOF( _CmdNdx )
001715 8A09            3917         MOV.W   [R1],R0
001717 964842rr        3918         MOV.B   ES,#SEG( _Cmd )
00171B B520rrrr        3919         MOV.B   [R2+SOF( _Cmd )],#00H
                       3920 ; rs232par.c  890                                       State = StateP0;
00171F 964842rr        3922         MOV.B   ES,#SEG( _State )
001723 9908rrrr        3923         MOV.W   R0,#SOF( _State )
001727 B200            3924         MOV.B   [R0],#00H
                       3925 ; rs232par.c  891                                       ParType[ParCnt] = P_DecNum;
001729 964842rr        3927         MOV.B   ES,#SEG( _ParCnt )
00172D 9908rrrr        3928         MOV.W   R0,#SOF( _ParCnt )
001731 8200            3929         MOV.B   R0L,[R0]
001733 B110            3930         MOVS.B  R0H,#00H
001735 B910            3931         MOVS.W  R1,#00H
001737 964842rr        3932         MOV.B   ES,#SEG( _ParType )
00173B B502rrrr        3933         MOV.B   [R0+SOF( _ParType )],#02H
                       3934 ; rs232par.c  892                                       return( PMUS);
00173F 910803          3936         MOV.B   R0L,#03H
                       3937         BR      _384
001742 D505C7         +3937         JMP.L   _384
                       3938 ; rs232par.c  893                               }
001746                 3940 _142:
                       3941 ; rs232par.c  894       
                       3942 ; rs232par.c  895                               if ( iscomma(c))
001746 91A42C          3944         CMP.B   R5L,#02CH
001749 F22C            3945         BNE     _143
                       3946 ; rs232par.c  896                               {
                       3947 ; rs232par.c  897                                       Cmd[++CmdNdx] = c;
00174B 964842rr        3949         MOV.B   ES,#SEG( _CmdNdx )
00174F 9908rrrr        3950         MOV.W   R0,#SOF( _CmdNdx )
001753 8A00            3951         MOV.W   R0,[R0]
001755 A901            3952         ADDS.W  R0,#01H
001757 8920            3953         MOV.W   R2,R0
001759 B930            3954         MOVS.W  R3,#00H
00175B 964842rr        3955         MOV.B   ES,#SEG( _CmdNdx )
00175F 9918rrrr        3956         MOV.W   R1,#SOF( _CmdNdx )
001763 8A09            3957         MOV.W   [R1],R0
001765 964842rr        3958         MOV.B   ES,#SEG( _Cmd )
001769 85AArrrr        3959         MOV.B   [R2+SOF( _Cmd )],R5L
                       3960 ; rs232par.c  898                                       State = StateP8;
00176D 964842rr        3962         MOV.B   ES,#SEG( _State )
001771 9908rrrr        3963         MOV.W   R0,#SOF( _State )
001775 920808          3964         MOV.B   [R0],#08H
                       3965 ; rs232par.c  899                                       ParType[ParCnt] = P_DecNum;
XA assembler v2.0 r2                    SN00085795-037 (c) 1998 TASKING, Inc.
                                                                                                                            Page  53

ADDR   CODE            LINE SOURCELINE
001778 964842rr        3967         MOV.B   ES,#SEG( _ParCnt )
00177C 9908rrrr        3968         MOV.W   R0,#SOF( _ParCnt )
001780 8200            3969         MOV.B   R0L,[R0]
001782 8140            3970         MOV.B   R2L,R0L
001784 B150            3971         MOVS.B  R2H,#00H
001786 B930            3972         MOVS.W  R3,#00H
001788 964842rr        3973         MOV.B   ES,#SEG( _ParType )
00178C B522rrrr        3974         MOV.B   [R2+SOF( _ParType )],#02H
                       3975 ; rs232par.c  900                                       ParCnt++;
001790 A101            3977         ADDS.B  R0L,#01H
001792 964842rr        3978         MOV.B   ES,#SEG( _ParCnt )
001796 9918rrrr        3979         MOV.W   R1,#SOF( _ParCnt )
00179A 8209            3980         MOV.B   [R1],R0L
                       3981 ; rs232par.c  901                                       return( Ready);
00179C 910802          3983         MOV.B   R0L,#02H
                       3984         BR      _384
00179F D50598         +3984         JMP.L   _384
                       3985 ; rs232par.c  902                               }
0017A2                 3987 _143:
                       3988 ; rs232par.c  903       
                       3989 ; rs232par.c  904                               if ( isnewline(c))
0017A2 91A40A          3991         CMP.B   R5L,#0AH
0017A5 F225            3992         BNE     _144
                       3993 ; rs232par.c  905                               {
                       3994 ; rs232par.c  906                                       Cmd[++CmdNdx] = 0;
0017A7 964842rr        3996         MOV.B   ES,#SEG( _CmdNdx )
0017AB 9908rrrr        3997         MOV.W   R0,#SOF( _CmdNdx )
0017AF 8A00            3998         MOV.W   R0,[R0]
0017B1 A901            3999         ADDS.W  R0,#01H
0017B3 8920            4000         MOV.W   R2,R0
0017B5 B930            4001         MOVS.W  R3,#00H
0017B7 964842rr        4002         MOV.B   ES,#SEG( _CmdNdx )
0017BB 9918rrrr        4003         MOV.W   R1,#SOF( _CmdNdx )
0017BF 8A09            4004         MOV.W   [R1],R0
0017C1 964842rr        4005         MOV.B   ES,#SEG( _Cmd )
0017C5 B520rrrr        4006         MOV.B   [R2+SOF( _Cmd )],#00H
                       4007 ; rs232par.c  907                                       State = StateP0;
0017C9 964842rr        4009         MOV.B   ES,#SEG( _State )
0017CD 9908rrrr        4010         MOV.W   R0,#SOF( _State )
0017D1 B200            4011         MOV.B   [R0],#00H
                       4012 ; rs232par.c  908                                       ParType[ParCnt] = P_DecNum;
0017D3 964842rr        4014         MOV.B   ES,#SEG( _ParCnt )
0017D7 9908rrrr        4015         MOV.W   R0,#SOF( _ParCnt )
0017DB 8200            4016         MOV.B   R0L,[R0]
0017DD B110            4017         MOVS.B  R0H,#00H
0017DF B910            4018         MOVS.W  R1,#00H
0017E1 964842rr        4019         MOV.B   ES,#SEG( _ParType )
0017E5 B502rrrr        4020         MOV.B   [R0+SOF( _ParType )],#02H
                       4021 ; rs232par.c  909                                       return( PMT);
0017E9 910804          4023         MOV.B   R0L,#04H
                       4024         BR      _384
0017EC D50572         +4024         JMP.L   _384
                       4025 ; rs232par.c  910                               }
0017F0                 4027 _144:
                       4028 ; rs232par.c  911       
                       4029 ; rs232par.c  912                               SCPIError = InvalidChar;
0017F0 964842rr        4031         MOV.B   ES,#SEG( _SCPIError )
0017F4 9908rrrr        4032         MOV.W   R0,#SOF( _SCPIError )
0017F8 BA02            4033         MOV.W   [R0],#02H
                       4034 ; rs232par.c  913                               State = StateERROR;
0017FA 964842rr        4036         MOV.B   ES,#SEG( _State )
0017FE 9908rrrr        4037         MOV.W   R0,#SOF( _State )
XA assembler v2.0 r2                    SN00085795-037 (c) 1998 TASKING, Inc.
                                                                                                                            Page  54

ADDR   CODE            LINE SOURCELINE
001802 92081E          4038         MOV.B   [R0],#01EH
                       4039 ; rs232par.c  914                               break;
                       4041         BR      _329
001805 D50559         +4041         JMP.L   _329
                       4042 ; rs232par.c  915       
                       4043 ; rs232par.c  916                       case StateS0:                                            
                                     // STRING PROGRAM DATA
001808                 4045 _145:
                       4047 ; rs232par.c  917                               if ( isquote(c))
001808 91A427          4049         CMP.B   R5L,#027H
00180B F208            4050         BNE     _146
                       4051 ; rs232par.c  918                               {
                       4052 ; rs232par.c  919                                       State = StateS1;
00180D 964842rr        4054         MOV.B   ES,#SEG( _State )
001811 9908rrrr        4055         MOV.W   R0,#SOF( _State )
001815 920813          4056         MOV.B   [R0],#013H
                       4057 ; rs232par.c  920                                       break;
                       4059         BR      _329
001818 D50550         +4059         JMP.L   _329
                       4060 ; rs232par.c  921                               }
00181C                 4062 _146:
                       4065 ; rs232par.c  922       
                       4066 ; rs232par.c  923                               Cmd[CmdNdx++] = c_str;
00181C 964842rr        4068         MOV.B   ES,#SEG( _CmdNdx )
001820 9908rrrr        4069         MOV.W   R0,#SOF( _CmdNdx )
001824 8A00            4070         MOV.W   R0,[R0]
001826 8920            4071         MOV.W   R2,R0
001828 B930            4072         MOVS.W  R3,#00H
00182A 964842rr        4073         MOV.B   ES,#SEG( _Cmd )
00182E 859Arrrr        4074         MOV.B   [R2+SOF( _Cmd )],R4H
001832 A901            4075         ADDS.W  R0,#01H
001834 964842rr        4076         MOV.B   ES,#SEG( _CmdNdx )
001838 9918rrrr        4077         MOV.W   R1,#SOF( _CmdNdx )
00183C 8A09            4078         MOV.W   [R1],R0
                       4079 ; rs232par.c  924                               break;
                       4081         BR      _329
00183E D5053D         +4081         JMP.L   _329
                       4082 ; rs232par.c  925       
                       4083 ; rs232par.c  926                       case StateS1:
001842                 4085 _147:
                       4086 ; rs232par.c  927                               if ( iswhitespace(c))
001842 91A40A          4088         CMP.B   R5L,#0AH
001845 F31F            4089         BEQ     _149
001847 91A420          4090         CMP.B   R5L,#020H
00184A FC1C            4091         BGT     _149
                       4092 ; rs232par.c  928                               {
                       4093 ; rs232par.c  929                                       Cmd[CmdNdx] = 0;
00184C 964842rr        4095         MOV.B   ES,#SEG( _CmdNdx )
001850 9908rrrr        4096         MOV.W   R0,#SOF( _CmdNdx )
001854 8A00            4097         MOV.W   R0,[R0]
001856 B910            4098         MOVS.W  R1,#00H
001858 964842rr        4099         MOV.B   ES,#SEG( _Cmd )
00185C B500rrrr        4100         MOV.B   [R0+SOF( _Cmd )],#00H
                       4101 ; rs232par.c  930                                       State = StateP7;
001860 964842rr        4103         MOV.B   ES,#SEG( _State )
001864 9908rrrr        4104         MOV.W   R0,#SOF( _State )
001868 B207            4105         MOV.B   [R0],#07H
                       4106 ; rs232par.c  931                                       ParType[ParCnt] = P_String;
00186A 964842rr        4108         MOV.B   ES,#SEG( _ParCnt )
00186E 9908rrrr        4109         MOV.W   R0,#SOF( _ParCnt )
001872 8200            4110         MOV.B   R0L,[R0]
001874 B110            4111         MOVS.B  R0H,#00H
XA assembler v2.0 r2                    SN00085795-037 (c) 1998 TASKING, Inc.
                                                                                                                            Page  55

ADDR   CODE            LINE SOURCELINE
001876 B910            4112         MOVS.W  R1,#00H
001878 964842rr        4113         MOV.B   ES,#SEG( _ParType )
00187C B506rrrr        4114         MOV.B   [R0+SOF( _ParType )],#06H
                       4115 ; rs232par.c  932                                       break;
                       4117         BR      _329
001880 D5051C         +4117         JMP.L   _329
                       4118 ; rs232par.c  933                               }
001884                 4120 _149:
                       4121 ; rs232par.c  934       
                       4122 ; rs232par.c  935                               if ( issemicolon(c))
001884 91A43B          4124         CMP.B   R5L,#03BH
001887 F21E            4125         BNE     _150
                       4126 ; rs232par.c  936                               {
                       4127 ; rs232par.c  937                                       Cmd[CmdNdx] = 0;
001889 964842rr        4129         MOV.B   ES,#SEG( _CmdNdx )
00188D 9908rrrr        4130         MOV.W   R0,#SOF( _CmdNdx )
001891 8A00            4131         MOV.W   R0,[R0]
001893 B910            4132         MOVS.W  R1,#00H
001895 964842rr        4133         MOV.B   ES,#SEG( _Cmd )
001899 B500rrrr        4134         MOV.B   [R0+SOF( _Cmd )],#00H
                       4135 ; rs232par.c  938                                       State = StateP0;
00189D 964842rr        4137         MOV.B   ES,#SEG( _State )
0018A1 9908rrrr        4138         MOV.W   R0,#SOF( _State )
0018A5 B200            4139         MOV.B   [R0],#00H
                       4140 ; rs232par.c  939                                       ParType[ParCnt] = P_String;
0018A7 964842rr        4142         MOV.B   ES,#SEG( _ParCnt )
0018AB 9908rrrr        4143         MOV.W   R0,#SOF( _ParCnt )
0018AF 8200            4144         MOV.B   R0L,[R0]
0018B1 B110            4145         MOVS.B  R0H,#00H
0018B3 B910            4146         MOVS.W  R1,#00H
0018B5 964842rr        4147         MOV.B   ES,#SEG( _ParType )
0018B9 B506rrrr        4148         MOV.B   [R0+SOF( _ParType )],#06H
                       4149 ; rs232par.c  940                                       return( PMUS);
0018BD 910803          4151         MOV.B   R0L,#03H
                       4152         BR      _384
0018C0 D50508         +4152         JMP.L   _384
                       4153 ; rs232par.c  941                               }
0018C4                 4155 _150:
                       4156 ; rs232par.c  942       
                       4157 ; rs232par.c  943                               if ( isquote(c))
0018C4 91A427          4159         CMP.B   R5L,#027H
0018C7 F219            4160         BNE     _151
                       4161 ; rs232par.c  944                               {
                       4162 ; rs232par.c  945                                       Cmd[CmdNdx++] = c;
0018C9 964842rr        4164         MOV.B   ES,#SEG( _CmdNdx )
0018CD 9908rrrr        4165         MOV.W   R0,#SOF( _CmdNdx )
0018D1 8A00            4166         MOV.W   R0,[R0]
0018D3 8920            4167         MOV.W   R2,R0
0018D5 B930            4168         MOVS.W  R3,#00H
0018D7 964842rr        4169         MOV.B   ES,#SEG( _Cmd )
0018DB 85AArrrr        4170         MOV.B   [R2+SOF( _Cmd )],R5L
0018DF A901            4171         ADDS.W  R0,#01H
0018E1 964842rr        4172         MOV.B   ES,#SEG( _CmdNdx )
0018E5 9918rrrr        4173         MOV.W   R1,#SOF( _CmdNdx )
0018E9 8A09            4174         MOV.W   [R1],R0
                       4175 ; rs232par.c  946                                       State = StateS0;
0018EB 964842rr        4177         MOV.B   ES,#SEG( _State )
0018EF 9908rrrr        4178         MOV.W   R0,#SOF( _State )
0018F3 920812          4179         MOV.B   [R0],#012H
                       4180 ; rs232par.c  947                                       break;
                       4182         BR      _329
0018F6 D504E1         +4182         JMP.L   _329
XA assembler v2.0 r2                    SN00085795-037 (c) 1998 TASKING, Inc.
                                                                                                                            Page  56

ADDR   CODE            LINE SOURCELINE
                       4183 ; rs232par.c  948                               }
0018FA                 4185 _151:
                       4186 ; rs232par.c  949       
                       4187 ; rs232par.c  950                               if ( iscomma(c))
0018FA 91A42C          4189         CMP.B   R5L,#02CH
0018FD F21E            4190         BNE     _152
                       4191 ; rs232par.c  951                               {
                       4192 ; rs232par.c  952       //                              Cmd[++CmdNdx] = c;
                       4193 ; rs232par.c  953                                       Cmd[CmdNdx] = c;                         
                                                                    // Chang. KEn 000615
0018FF 964842rr        4195         MOV.B   ES,#SEG( _CmdNdx )
001903 9908rrrr        4196         MOV.W   R0,#SOF( _CmdNdx )
001907 8A00            4197         MOV.W   R0,[R0]
001909 B910            4198         MOVS.W  R1,#00H
00190B 964842rr        4199         MOV.B   ES,#SEG( _Cmd )
00190F 85A8rrrr        4200         MOV.B   [R0+SOF( _Cmd )],R5L
                       4201 ; rs232par.c  954                                       State = StateP8;
001913 964842rr        4203         MOV.B   ES,#SEG( _State )
001917 9908rrrr        4204         MOV.W   R0,#SOF( _State )
00191B 920808          4205         MOV.B   [R0],#08H
                       4206 ; rs232par.c  955                                       ParType[ParCnt] = P_String;
00191E 964842rr        4208         MOV.B   ES,#SEG( _ParCnt )
001922 9908rrrr        4209         MOV.W   R0,#SOF( _ParCnt )
001926 8200            4210         MOV.B   R0L,[R0]
001928 B110            4211         MOVS.B  R0H,#00H
00192A B910            4212         MOVS.W  R1,#00H
00192C 964842rr        4213         MOV.B   ES,#SEG( _ParType )
001930 B506rrrr        4214         MOV.B   [R0+SOF( _ParType )],#06H
                       4215 ; rs232par.c  956                                       return( Ready);
001934 910802          4217         MOV.B   R0L,#02H
                       4218         BR      _384
001937 D504CC         +4218         JMP.L   _384
                       4219 ; rs232par.c  957                               }
00193A                 4221 _152:
                       4222 ; rs232par.c  958       
                       4223 ; rs232par.c  959                               if ( isnewline(c))
00193A 91A40A          4225         CMP.B   R5L,#0AH
00193D F21E            4226         BNE     _153
                       4227 ; rs232par.c  960                               {
                       4228 ; rs232par.c  961                                       Cmd[CmdNdx] = 0;
00193F 964842rr        4230         MOV.B   ES,#SEG( _CmdNdx )
001943 9908rrrr        4231         MOV.W   R0,#SOF( _CmdNdx )
001947 8A00            4232         MOV.W   R0,[R0]
001949 B910            4233         MOVS.W  R1,#00H
00194B 964842rr        4234         MOV.B   ES,#SEG( _Cmd )
00194F B500rrrr        4235         MOV.B   [R0+SOF( _Cmd )],#00H
                       4236 ; rs232par.c  962                                       State = StateP0;
001953 964842rr        4238         MOV.B   ES,#SEG( _State )
001957 9908rrrr        4239         MOV.W   R0,#SOF( _State )
00195B B200            4240         MOV.B   [R0],#00H
                       4241 ; rs232par.c  963                                       ParType[ParCnt] = P_String;
00195D 964842rr        4243         MOV.B   ES,#SEG( _ParCnt )
001961 9908rrrr        4244         MOV.W   R0,#SOF( _ParCnt )
001965 8200            4245         MOV.B   R0L,[R0]
001967 B110            4246         MOVS.B  R0H,#00H
001969 B910            4247         MOVS.W  R1,#00H
00196B 964842rr        4248         MOV.B   ES,#SEG( _ParType )
00196F B506rrrr        4249         MOV.B   [R0+SOF( _ParType )],#06H
                       4250 ; rs232par.c  964                                       return( PMT);
001973 910804          4252         MOV.B   R0L,#04H
                       4253         BR      _384
001976 D504AD         +4253         JMP.L   _384
XA assembler v2.0 r2                    SN00085795-037 (c) 1998 TASKING, Inc.
                                                                                                                            Page  57

ADDR   CODE            LINE SOURCELINE
                       4254 ; rs232par.c  965                               }
00197A                 4256 _153:
                       4257 ; rs232par.c  966       
                       4258 ; rs232par.c  967                               SCPIError = InvalidChar;
00197A 964842rr        4260         MOV.B   ES,#SEG( _SCPIError )
00197E 9908rrrr        4261         MOV.W   R0,#SOF( _SCPIError )
001982 BA02            4262         MOV.W   [R0],#02H
                       4263 ; rs232par.c  968                               State = StateERROR;
001984 964842rr        4265         MOV.B   ES,#SEG( _State )
001988 9908rrrr        4266         MOV.W   R0,#SOF( _State )
00198C 92081E          4267         MOV.B   [R0],#01EH
                       4268 ; rs232par.c  969                               break;
                       4270         BR      _329
00198F D50494         +4270         JMP.L   _329
                       4271 ; rs232par.c  970       
                       4272 ; rs232par.c  971                       case StateS2:
001992                 4274 _154:
                       4277 ; rs232par.c  972                               if ( isdoublequote(c))
001992 91A422          4279         CMP.B   R5L,#022H
001995 F208            4280         BNE     _155
                       4281 ; rs232par.c  973                               {
                       4282 ; rs232par.c  974                                       State = StateS3;
001997 964842rr        4284         MOV.B   ES,#SEG( _State )
00199B 9908rrrr        4285         MOV.W   R0,#SOF( _State )
00199F 920815          4286         MOV.B   [R0],#015H
                       4287 ; rs232par.c  975                                       break;
                       4289         BR      _329
0019A2 D5048B         +4289         JMP.L   _329
                       4290 ; rs232par.c  976                               }
0019A6                 4292 _155:
                       4295 ; rs232par.c  977       
                       4296 ; rs232par.c  978                               Cmd[CmdNdx++] = c_str;
0019A6 964842rr        4298         MOV.B   ES,#SEG( _CmdNdx )
0019AA 9908rrrr        4299         MOV.W   R0,#SOF( _CmdNdx )
0019AE 8A00            4300         MOV.W   R0,[R0]
0019B0 8920            4301         MOV.W   R2,R0
0019B2 B930            4302         MOVS.W  R3,#00H
0019B4 964842rr        4303         MOV.B   ES,#SEG( _Cmd )
0019B8 859Arrrr        4304         MOV.B   [R2+SOF( _Cmd )],R4H
0019BC A901            4305         ADDS.W  R0,#01H
0019BE 964842rr        4306         MOV.B   ES,#SEG( _CmdNdx )
0019C2 9918rrrr        4307         MOV.W   R1,#SOF( _CmdNdx )
0019C6 8A09            4308         MOV.W   [R1],R0
                       4309 ; rs232par.c  979                               break;
                       4311         BR      _329
0019C8 D50478         +4311         JMP.L   _329
                       4312 ; rs232par.c  980       
                       4313 ; rs232par.c  981                       case StateS3:
0019CC                 4315 _156:
                       4316 ; rs232par.c  982                               if ( iswhitespace(c))
0019CC 91A40A          4318         CMP.B   R5L,#0AH
0019CF F31F            4319         BEQ     _158
0019D1 91A420          4320         CMP.B   R5L,#020H
0019D4 FC1C            4321         BGT     _158
                       4322 ; rs232par.c  983                               {
                       4323 ; rs232par.c  984                                       Cmd[CmdNdx] = 0;
0019D6 964842rr        4325         MOV.B   ES,#SEG( _CmdNdx )
0019DA 9908rrrr        4326         MOV.W   R0,#SOF( _CmdNdx )
0019DE 8A00            4327         MOV.W   R0,[R0]
0019E0 B910            4328         MOVS.W  R1,#00H
0019E2 964842rr        4329         MOV.B   ES,#SEG( _Cmd )
0019E6 B500rrrr        4330         MOV.B   [R0+SOF( _Cmd )],#00H
XA assembler v2.0 r2                    SN00085795-037 (c) 1998 TASKING, Inc.
                                                                                                                            Page  58

ADDR   CODE            LINE SOURCELINE
                       4331 ; rs232par.c  985                                       State = StateP7;
0019EA 964842rr        4333         MOV.B   ES,#SEG( _State )
0019EE 9908rrrr        4334         MOV.W   R0,#SOF( _State )
0019F2 B207            4335         MOV.B   [R0],#07H
                       4336 ; rs232par.c  986                                       ParType[ParCnt] = P_String;
0019F4 964842rr        4338         MOV.B   ES,#SEG( _ParCnt )
0019F8 9908rrrr        4339         MOV.W   R0,#SOF( _ParCnt )
0019FC 8200            4340         MOV.B   R0L,[R0]
0019FE B110            4341         MOVS.B  R0H,#00H
001A00 B910            4342         MOVS.W  R1,#00H
001A02 964842rr        4343         MOV.B   ES,#SEG( _ParType )
001A06 B506rrrr        4344         MOV.B   [R0+SOF( _ParType )],#06H
                       4345 ; rs232par.c  987                                       break;
                       4347         BR      _329
001A0A D50457         +4347         JMP.L   _329
                       4348 ; rs232par.c  988                               }
001A0E                 4350 _158:
                       4351 ; rs232par.c  989       
                       4352 ; rs232par.c  990                               if ( issemicolon(c))
001A0E 91A43B          4354         CMP.B   R5L,#03BH
001A11 F21E            4355         BNE     _159
                       4356 ; rs232par.c  991                               {
                       4357 ; rs232par.c  992                                       Cmd[CmdNdx] = 0;
001A13 964842rr        4359         MOV.B   ES,#SEG( _CmdNdx )
001A17 9908rrrr        4360         MOV.W   R0,#SOF( _CmdNdx )
001A1B 8A00            4361         MOV.W   R0,[R0]
001A1D B910            4362         MOVS.W  R1,#00H
001A1F 964842rr        4363         MOV.B   ES,#SEG( _Cmd )
001A23 B500rrrr        4364         MOV.B   [R0+SOF( _Cmd )],#00H
                       4365 ; rs232par.c  993                                       State = StateP0;
001A27 964842rr        4367         MOV.B   ES,#SEG( _State )
001A2B 9908rrrr        4368         MOV.W   R0,#SOF( _State )
001A2F B200            4369         MOV.B   [R0],#00H
                       4370 ; rs232par.c  994                                       ParType[ParCnt] = P_String;
001A31 964842rr        4372         MOV.B   ES,#SEG( _ParCnt )
001A35 9908rrrr        4373         MOV.W   R0,#SOF( _ParCnt )
001A39 8200            4374         MOV.B   R0L,[R0]
001A3B B110            4375         MOVS.B  R0H,#00H
001A3D B910            4376         MOVS.W  R1,#00H
001A3F 964842rr        4377         MOV.B   ES,#SEG( _ParType )
001A43 B506rrrr        4378         MOV.B   [R0+SOF( _ParType )],#06H
                       4379 ; rs232par.c  995                                       return( PMUS);
001A47 910803          4381         MOV.B   R0L,#03H
                       4382         BR      _384
001A4A D50443         +4382         JMP.L   _384
                       4383 ; rs232par.c  996                               }
001A4E                 4385 _159:
                       4386 ; rs232par.c  997       
                       4387 ; rs232par.c  998                               if ( isdoublequote(c))
001A4E 91A422          4389         CMP.B   R5L,#022H
001A51 F219            4390         BNE     _160
                       4391 ; rs232par.c  999                               {
                       4392 ; rs232par.c 1000                                       Cmd[CmdNdx++] = c;
001A53 964842rr        4394         MOV.B   ES,#SEG( _CmdNdx )
001A57 9908rrrr        4395         MOV.W   R0,#SOF( _CmdNdx )
001A5B 8A00            4396         MOV.W   R0,[R0]
001A5D 8920            4397         MOV.W   R2,R0
001A5F B930            4398         MOVS.W  R3,#00H
001A61 964842rr        4399         MOV.B   ES,#SEG( _Cmd )
001A65 85AArrrr        4400         MOV.B   [R2+SOF( _Cmd )],R5L
001A69 A901            4401         ADDS.W  R0,#01H
001A6B 964842rr        4402         MOV.B   ES,#SEG( _CmdNdx )
XA assembler v2.0 r2                    SN00085795-037 (c) 1998 TASKING, Inc.
                                                                                                                            Page  59

ADDR   CODE            LINE SOURCELINE
001A6F 9918rrrr        4403         MOV.W   R1,#SOF( _CmdNdx )
001A73 8A09            4404         MOV.W   [R1],R0
                       4405 ; rs232par.c 1001                                       State = StateS2;
001A75 964842rr        4407         MOV.B   ES,#SEG( _State )
001A79 9908rrrr        4408         MOV.W   R0,#SOF( _State )
001A7D 920814          4409         MOV.B   [R0],#014H
                       4410 ; rs232par.c 1002                                       break;
                       4412         BR      _329
001A80 D5041C         +4412         JMP.L   _329
                       4413 ; rs232par.c 1003                               }
001A84                 4415 _160:
                       4416 ; rs232par.c 1004       
                       4417 ; rs232par.c 1005                               if ( iscomma(c))
001A84 91A42C          4419         CMP.B   R5L,#02CH
001A87 F21E            4420         BNE     _161
                       4421 ; rs232par.c 1006                               {
                       4422 ; rs232par.c 1007       //                              Cmd[++CmdNdx] = c;
                       4423 ; rs232par.c 1008                                       Cmd[CmdNdx] = c;                         
                                                                    // Chang. KEn 000615
001A89 964842rr        4425         MOV.B   ES,#SEG( _CmdNdx )
001A8D 9908rrrr        4426         MOV.W   R0,#SOF( _CmdNdx )
001A91 8A00            4427         MOV.W   R0,[R0]
001A93 B910            4428         MOVS.W  R1,#00H
001A95 964842rr        4429         MOV.B   ES,#SEG( _Cmd )
001A99 85A8rrrr        4430         MOV.B   [R0+SOF( _Cmd )],R5L
                       4431 ; rs232par.c 1009                                       State = StateP8;
001A9D 964842rr        4433         MOV.B   ES,#SEG( _State )
001AA1 9908rrrr        4434         MOV.W   R0,#SOF( _State )
001AA5 920808          4435         MOV.B   [R0],#08H
                       4436 ; rs232par.c 1010                                       ParType[ParCnt] = P_String;
001AA8 964842rr        4438         MOV.B   ES,#SEG( _ParCnt )
001AAC 9908rrrr        4439         MOV.W   R0,#SOF( _ParCnt )
001AB0 8200            4440         MOV.B   R0L,[R0]
001AB2 B110            4441         MOVS.B  R0H,#00H
001AB4 B910            4442         MOVS.W  R1,#00H
001AB6 964842rr        4443         MOV.B   ES,#SEG( _ParType )
001ABA B506rrrr        4444         MOV.B   [R0+SOF( _ParType )],#06H
                       4445 ; rs232par.c 1011                                       return( Ready);
001ABE 910802          4447         MOV.B   R0L,#02H
                       4448         BR      _384
001AC1 D50407         +4448         JMP.L   _384
                       4449 ; rs232par.c 1012                               }
001AC4                 4451 _161:
                       4452 ; rs232par.c 1013       
                       4453 ; rs232par.c 1014                               if ( isnewline(c))
001AC4 91A40A          4455         CMP.B   R5L,#0AH
001AC7 F21E            4456         BNE     _162
                       4457 ; rs232par.c 1015                               {
                       4458 ; rs232par.c 1016                                       Cmd[CmdNdx] = 0;
001AC9 964842rr        4460         MOV.B   ES,#SEG( _CmdNdx )
001ACD 9908rrrr        4461         MOV.W   R0,#SOF( _CmdNdx )
001AD1 8A00            4462         MOV.W   R0,[R0]
001AD3 B910            4463         MOVS.W  R1,#00H
001AD5 964842rr        4464         MOV.B   ES,#SEG( _Cmd )
001AD9 B500rrrr        4465         MOV.B   [R0+SOF( _Cmd )],#00H
                       4466 ; rs232par.c 1017                                       State = StateP0;
001ADD 964842rr        4468         MOV.B   ES,#SEG( _State )
001AE1 9908rrrr        4469         MOV.W   R0,#SOF( _State )
001AE5 B200            4470         MOV.B   [R0],#00H
                       4471 ; rs232par.c 1018                                       ParType[ParCnt] = P_String;
001AE7 964842rr        4473         MOV.B   ES,#SEG( _ParCnt )
001AEB 9908rrrr        4474         MOV.W   R0,#SOF( _ParCnt )
XA assembler v2.0 r2                    SN00085795-037 (c) 1998 TASKING, Inc.
                                                                                                                            Page  60

ADDR   CODE            LINE SOURCELINE
001AEF 8200            4475         MOV.B   R0L,[R0]
001AF1 B110            4476         MOVS.B  R0H,#00H
001AF3 B910            4477         MOVS.W  R1,#00H
001AF5 964842rr        4478         MOV.B   ES,#SEG( _ParType )
001AF9 B506rrrr        4479         MOV.B   [R0+SOF( _ParType )],#06H
                       4480 ; rs232par.c 1019                                       return( PMT);
001AFD 910804          4482         MOV.B   R0L,#04H
                       4483         BR      _384
001B00 D503E8         +4483         JMP.L   _384
                       4484 ; rs232par.c 1020                               }
001B04                 4486 _162:
                       4487 ; rs232par.c 1021       
                       4488 ; rs232par.c 1022                               SCPIError = InvalidChar;
001B04 964842rr        4490         MOV.B   ES,#SEG( _SCPIError )
001B08 9908rrrr        4491         MOV.W   R0,#SOF( _SCPIError )
001B0C BA02            4492         MOV.W   [R0],#02H
                       4493 ; rs232par.c 1023                               State = StateERROR;
001B0E 964842rr        4495         MOV.B   ES,#SEG( _State )
001B12 9908rrrr        4496         MOV.W   R0,#SOF( _State )
001B16 92081E          4497         MOV.B   [R0],#01EH
                       4498 ; rs232par.c 1024                               break;
                       4500         BR      _329
001B19 D503CF         +4500         JMP.L   _329
                       4501 ; rs232par.c 1025       
                       4502 ; rs232par.c 1026                       case StateDA0:                                           
                                     // NON-DECIMAL/ARBITRARY PROGRAM DATA
001B1C                 4504 _163:
                       4505 ; rs232par.c 1027                               if ( (c) == 'B')
001B1C 91A442          4507         CMP.B   R5L,#042H
001B1F F20D            4508         BNE     _164
                       4509 ; rs232par.c 1028                               {
                       4510 ; rs232par.c 1029                                       CmdNdx = 0;
001B21 964842rr        4512         MOV.B   ES,#SEG( _CmdNdx )
001B25 9908rrrr        4513         MOV.W   R0,#SOF( _CmdNdx )
001B29 BA00            4514         MOV.W   [R0],#00H
                       4515 ; rs232par.c 1030                                       State = StateDA3;
001B2B 964842rr        4517         MOV.B   ES,#SEG( _State )
001B2F 9908rrrr        4518         MOV.W   R0,#SOF( _State )
001B33 920819          4519         MOV.B   [R0],#019H
                       4520 ; rs232par.c 1031                                       break;
                       4522         BR      _329
001B36 D503C1         +4522         JMP.L   _329
                       4523 ; rs232par.c 1032                               }
001B3A                 4525 _164:
                       4526 ; rs232par.c 1033       
                       4527 ; rs232par.c 1034                               if ( (c) == 'Q')
001B3A 91A451          4529         CMP.B   R5L,#051H
001B3D F20D            4530         BNE     _165
                       4531 ; rs232par.c 1035                               {
                       4532 ; rs232par.c 1036                                       CmdNdx = 0;
001B3F 964842rr        4534         MOV.B   ES,#SEG( _CmdNdx )
001B43 9908rrrr        4535         MOV.W   R0,#SOF( _CmdNdx )
001B47 BA00            4536         MOV.W   [R0],#00H
                       4537 ; rs232par.c 1037                                       State = StateDA2;
001B49 964842rr        4539         MOV.B   ES,#SEG( _State )
001B4D 9908rrrr        4540         MOV.W   R0,#SOF( _State )
001B51 920818          4541         MOV.B   [R0],#018H
                       4542 ; rs232par.c 1038                                       break;
                       4544         BR      _329
001B54 D503B2         +4544         JMP.L   _329
                       4545 ; rs232par.c 1039                               }
001B58                 4547 _165:
XA assembler v2.0 r2                    SN00085795-037 (c) 1998 TASKING, Inc.
                                                                                                                            Page  61

ADDR   CODE            LINE SOURCELINE
                       4548 ; rs232par.c 1040       
                       4549 ; rs232par.c 1041                               if ( (c) == 'H')
001B58 91A448          4551         CMP.B   R5L,#048H
001B5B F20D            4552         BNE     _166
                       4553 ; rs232par.c 1042                               {
                       4554 ; rs232par.c 1043                                       CmdNdx = 0;
001B5D 964842rr        4556         MOV.B   ES,#SEG( _CmdNdx )
001B61 9908rrrr        4557         MOV.W   R0,#SOF( _CmdNdx )
001B65 BA00            4558         MOV.W   [R0],#00H
                       4559 ; rs232par.c 1044                                       State = StateDA1;
001B67 964842rr        4561         MOV.B   ES,#SEG( _State )
001B6B 9908rrrr        4562         MOV.W   R0,#SOF( _State )
001B6F 920817          4563         MOV.B   [R0],#017H
                       4564 ; rs232par.c 1045                                       break;
                       4566         BR      _329
001B72 D503A3         +4566         JMP.L   _329
                       4567 ; rs232par.c 1046                               }
001B76                 4569 _166:
                       4570 ; rs232par.c 1047       
                       4571 ; rs232par.c 1048                               if ( (c) == '0')
001B76 91A430          4573         CMP.B   R5L,#030H
001B79 F20D            4574         BNE     _167
                       4575 ; rs232par.c 1049                               {
                       4576 ; rs232par.c 1050                                       CmdNdx = 0;
001B7B 964842rr        4578         MOV.B   ES,#SEG( _CmdNdx )
001B7F 9908rrrr        4579         MOV.W   R0,#SOF( _CmdNdx )
001B83 BA00            4580         MOV.W   [R0],#00H
                       4581 ; rs232par.c 1051                                       State = StateDA5;
001B85 964842rr        4583         MOV.B   ES,#SEG( _State )
001B89 9908rrrr        4584         MOV.W   R0,#SOF( _State )
001B8D 92081B          4585         MOV.B   [R0],#01BH
                       4586 ; rs232par.c 1052                                       break;
                       4588         BR      _329
001B90 D50394         +4588         JMP.L   _329
                       4589 ; rs232par.c 1053                               }
001B94                 4591 _167:
                       4592 ; rs232par.c 1054       
                       4593 ; rs232par.c 1055                               if ( isdigit(c))
001B94 810A            4595         MOV.B   R0L,R5L
001B96 9019            4596         SEXT.B  R0H
001B98 9819            4597         SEXT.W  R1
001B9A 964842rr        4598         MOV.B   ES,#SEG( __ctype_+1 )
001B9E 8500rrrr        4599         MOV.B   R0L,[R0+SOF( __ctype_+1 )]
001BA2 9019            4600         SEXT.B  R0H
001BA4 99050004        4601         AND.W   R0,#04H
001BA8 F318            4602         BEQ     _168
                       4603 ; rs232par.c 1056                               {
                       4604 ; rs232par.c 1057                                       NoOfDigits = c - '0';
001BAA 91A230          4606         SUB.B   R5L,#030H
001BAD 964842rr        4607         MOV.B   ES,#SEG( _NoOfDigits )
001BB1 9908rrrr        4608         MOV.W   R0,#SOF( _NoOfDigits )
001BB5 82A8            4609         MOV.B   [R0],R5L
                       4610 ; rs232par.c 1058                                       NoOfBytes = 0;
001BB7 964842rr        4612         MOV.B   ES,#SEG( _NoOfBytes )
001BBB 9908rrrr        4613         MOV.W   R0,#SOF( _NoOfBytes )
001BBF BA00            4614         MOV.W   [R0],#00H
                       4615 ; rs232par.c 1059                                       CmdNdx = 0;
001BC1 964842rr        4617         MOV.B   ES,#SEG( _CmdNdx )
001BC5 9908rrrr        4618         MOV.W   R0,#SOF( _CmdNdx )
001BC9 BA00            4619         MOV.W   [R0],#00H
                       4620 ; rs232par.c 1060                                       State = StateDA4;
001BCB 964842rr        4622         MOV.B   ES,#SEG( _State )
XA assembler v2.0 r2                    SN00085795-037 (c) 1998 TASKING, Inc.
                                                                                                                            Page  62

ADDR   CODE            LINE SOURCELINE
001BCF 9908rrrr        4623         MOV.W   R0,#SOF( _State )
001BD3 92081A          4624         MOV.B   [R0],#01AH
                       4625 ; rs232par.c 1061                                       break;
                       4627         BR      _329
001BD6 D50371         +4627         JMP.L   _329
                       4628 ; rs232par.c 1062                               }
001BDA                 4630 _168:
                       4631 ; rs232par.c 1063       
                       4632 ; rs232par.c 1064                               SCPIError = InvalidChar;
001BDA 964842rr        4634         MOV.B   ES,#SEG( _SCPIError )
001BDE 9908rrrr        4635         MOV.W   R0,#SOF( _SCPIError )
001BE2 BA02            4636         MOV.W   [R0],#02H
                       4637 ; rs232par.c 1065                               State = StateERROR;
001BE4 964842rr        4639         MOV.B   ES,#SEG( _State )
001BE8 9908rrrr        4640         MOV.W   R0,#SOF( _State )
001BEC 92081E          4641         MOV.B   [R0],#01EH
                       4642 ; rs232par.c 1066                               break;
                       4644         BR      _329
001BEF D50364         +4644         JMP.L   _329
                       4645 ; rs232par.c 1067       
                       4646 ; rs232par.c 1068                       case StateDA1:
001BF2                 4648 _169:
                       4649 ; rs232par.c 1069                               if ( isxdigit(c))
001BF2 810A            4651         MOV.B   R0L,R5L
001BF4 9019            4652         SEXT.B  R0H
001BF6 9819            4653         SEXT.W  R1
001BF8 964842rr        4654         MOV.B   ES,#SEG( __ctype_+1 )
001BFC 8500rrrr        4655         MOV.B   R0L,[R0+SOF( __ctype_+1 )]
001C00 9019            4656         SEXT.B  R0H
001C02 99050044        4657         AND.W   R0,#044H
001C06 F318            4658         BEQ     _170
                       4659 ; rs232par.c 1070                               {
                       4660 ; rs232par.c 1071                                       if ( CmdNdx < 255)                       
                                                    // TBD SHOULD NOT GENERATE AN ERR
001C08 964842rr        4662         MOV.B   ES,#SEG( _CmdNdx )
001C0C 9908rrrr        4663         MOV.W   R0,#SOF( _CmdNdx )
001C10 8A00            4664         MOV.W   R0,[R0]
001C12 990400FF        4665         CMP.W   R0,#0FFH
                       4666         BCC     _329
001C16 F102           +4666 ;       BCS     _LG_286
001C18 D50350         +4666 ;       JMP.L   _329
001C18 D5035000       +4666 ;       JMP.L   _329
001C1C                +4666 _LG_286:
                       4667 ; rs232par.c 1072                                       {                                        
                                                                    
                       4668 ; rs232par.c 1073                                               Cmd[CmdNdx++] = c;
001C1C 8920            4670         MOV.W   R2,R0
001C1E B930            4671         MOVS.W  R3,#00H
001C20 964842rr        4672         MOV.B   ES,#SEG( _Cmd )
001C24 85AArrrr        4673         MOV.B   [R2+SOF( _Cmd )],R5L
001C28 A901            4674         ADDS.W  R0,#01H
001C2A 964842rr        4675         MOV.B   ES,#SEG( _CmdNdx )
001C2E 9918rrrr        4676         MOV.W   R1,#SOF( _CmdNdx )
001C32 8A09            4677         MOV.W   [R1],R0
                       4678 ; rs232par.c 1074                                               break;
                       4680         BR      _329
001C34 D50342         +4680         JMP.L   _329
                       4681 ; rs232par.c 1075                                       }
                       4682 ; rs232par.c 1076       //                              SCPIError = TooManyDigits;
                       4683 ; rs232par.c 1077       //                              State = StateERROR;
                       4684 ; rs232par.c 1078                                       break;
                       4685 ; rs232par.c 1079                               }
XA assembler v2.0 r2                    SN00085795-037 (c) 1998 TASKING, Inc.
                                                                                                                            Page  63

ADDR   CODE            LINE SOURCELINE
001C38                 4687 _170:
                       4688 ; rs232par.c 1080       
                       4689 ; rs232par.c 1081                               if ( issemicolon(c))
001C38 91A43B          4691         CMP.B   R5L,#03BH
001C3B F21E            4692         BNE     _171
                       4693 ; rs232par.c 1082                               {
                       4694 ; rs232par.c 1083                                       Cmd[CmdNdx] = 0;
001C3D 964842rr        4696         MOV.B   ES,#SEG( _CmdNdx )
001C41 9908rrrr        4697         MOV.W   R0,#SOF( _CmdNdx )
001C45 8A00            4698         MOV.W   R0,[R0]
001C47 B910            4699         MOVS.W  R1,#00H
001C49 964842rr        4700         MOV.B   ES,#SEG( _Cmd )
001C4D B500rrrr        4701         MOV.B   [R0+SOF( _Cmd )],#00H
                       4702 ; rs232par.c 1084                                       State = StateP0;
001C51 964842rr        4704         MOV.B   ES,#SEG( _State )
001C55 9908rrrr        4705         MOV.W   R0,#SOF( _State )
001C59 B200            4706         MOV.B   [R0],#00H
                       4707 ; rs232par.c 1085                                       ParType[ParCnt] = P_HexDecNum;
001C5B 964842rr        4709         MOV.B   ES,#SEG( _ParCnt )
001C5F 9908rrrr        4710         MOV.W   R0,#SOF( _ParCnt )
001C63 8200            4711         MOV.B   R0L,[R0]
001C65 B110            4712         MOVS.B  R0H,#00H
001C67 B910            4713         MOVS.W  R1,#00H
001C69 964842rr        4714         MOV.B   ES,#SEG( _ParType )
001C6D B503rrrr        4715         MOV.B   [R0+SOF( _ParType )],#03H
                       4716 ; rs232par.c 1086                                       return( PMUS);
001C71 910803          4718         MOV.B   R0L,#03H
                       4719         BR      _384
001C74 D5032E         +4719         JMP.L   _384
                       4720 ; rs232par.c 1087                               }
001C78                 4722 _171:
                       4723 ; rs232par.c 1088       
                       4724 ; rs232par.c 1089                               if ( iswhitespace(c))
001C78 91A40A          4726         CMP.B   R5L,#0AH
001C7B F315            4727         BEQ     _173
001C7D 91A420          4728         CMP.B   R5L,#020H
001C80 FC12            4729         BGT     _173
                       4730 ; rs232par.c 1090                               {
                       4731 ; rs232par.c 1091                                       State = StateP7;
001C82 964842rr        4733         MOV.B   ES,#SEG( _State )
001C86 9908rrrr        4734         MOV.W   R0,#SOF( _State )
001C8A B207            4735         MOV.B   [R0],#07H
                       4736 ; rs232par.c 1092                                       ParType[ParCnt] = P_HexDecNum;
001C8C 964842rr        4738         MOV.B   ES,#SEG( _ParCnt )
001C90 9908rrrr        4739         MOV.W   R0,#SOF( _ParCnt )
001C94 8200            4740         MOV.B   R0L,[R0]
001C96 B110            4741         MOVS.B  R0H,#00H
001C98 B910            4742         MOVS.W  R1,#00H
001C9A 964842rr        4743         MOV.B   ES,#SEG( _ParType )
001C9E B503rrrr        4744         MOV.B   [R0+SOF( _ParType )],#03H
                       4745 ; rs232par.c 1093                                       break;
                       4747         BR      _329
001CA2 D5030B         +4747         JMP.L   _329
                       4748 ; rs232par.c 1094                               }
001CA6                 4750 _173:
                       4751 ; rs232par.c 1095       
                       4752 ; rs232par.c 1096                               if ( iscomma(c))
001CA6 91A42C          4754         CMP.B   R5L,#02CH
001CA9 F225            4755         BNE     _174
                       4756 ; rs232par.c 1097                               {
                       4757 ; rs232par.c 1098                                       Cmd[++CmdNdx] = c;
001CAB 964842rr        4759         MOV.B   ES,#SEG( _CmdNdx )
XA assembler v2.0 r2                    SN00085795-037 (c) 1998 TASKING, Inc.
                                                                                                                            Page  64

ADDR   CODE            LINE SOURCELINE
001CAF 9908rrrr        4760         MOV.W   R0,#SOF( _CmdNdx )
001CB3 8A00            4761         MOV.W   R0,[R0]
001CB5 A901            4762         ADDS.W  R0,#01H
001CB7 8920            4763         MOV.W   R2,R0
001CB9 B930            4764         MOVS.W  R3,#00H
001CBB 964842rr        4765         MOV.B   ES,#SEG( _CmdNdx )
001CBF 9918rrrr        4766         MOV.W   R1,#SOF( _CmdNdx )
001CC3 8A09            4767         MOV.W   [R1],R0
001CC5 964842rr        4768         MOV.B   ES,#SEG( _Cmd )
001CC9 85AArrrr        4769         MOV.B   [R2+SOF( _Cmd )],R5L
                       4770 ; rs232par.c 1099                                       State = StateP8;
001CCD 964842rr        4772         MOV.B   ES,#SEG( _State )
001CD1 9908rrrr        4773         MOV.W   R0,#SOF( _State )
001CD5 920808          4774         MOV.B   [R0],#08H
                       4775 ; rs232par.c 1100                                       ParType[ParCnt] = P_HexDecNum;
001CD8 964842rr        4777         MOV.B   ES,#SEG( _ParCnt )
001CDC 9908rrrr        4778         MOV.W   R0,#SOF( _ParCnt )
001CE0 8200            4779         MOV.B   R0L,[R0]
001CE2 B110            4780         MOVS.B  R0H,#00H
001CE4 B910            4781         MOVS.W  R1,#00H
001CE6 964842rr        4782         MOV.B   ES,#SEG( _ParType )
001CEA B503rrrr        4783         MOV.B   [R0+SOF( _ParType )],#03H
                       4784 ; rs232par.c 1101                                       return( Ready);
001CEE 910802          4786         MOV.B   R0L,#02H
                       4787         BR      _384
001CF1 D502EF         +4787         JMP.L   _384
                       4788 ; rs232par.c 1102                               }
001CF4                 4790 _174:
                       4791 ; rs232par.c 1103       
                       4792 ; rs232par.c 1104                               if ( isnewline(c))
001CF4 91A40A          4794         CMP.B   R5L,#0AH
001CF7 F21E            4795         BNE     _175
                       4796 ; rs232par.c 1105                               {
                       4797 ; rs232par.c 1106                                       Cmd[CmdNdx] = 0;
001CF9 964842rr        4799         MOV.B   ES,#SEG( _CmdNdx )
001CFD 9908rrrr        4800         MOV.W   R0,#SOF( _CmdNdx )
001D01 8A00            4801         MOV.W   R0,[R0]
001D03 B910            4802         MOVS.W  R1,#00H
001D05 964842rr        4803         MOV.B   ES,#SEG( _Cmd )
001D09 B500rrrr        4804         MOV.B   [R0+SOF( _Cmd )],#00H
                       4805 ; rs232par.c 1107                                       State = StateP0;
001D0D 964842rr        4807         MOV.B   ES,#SEG( _State )
001D11 9908rrrr        4808         MOV.W   R0,#SOF( _State )
001D15 B200            4809         MOV.B   [R0],#00H
                       4810 ; rs232par.c 1108                                       ParType[ParCnt] = P_HexDecNum;
001D17 964842rr        4812         MOV.B   ES,#SEG( _ParCnt )
001D1B 9908rrrr        4813         MOV.W   R0,#SOF( _ParCnt )
001D1F 8200            4814         MOV.B   R0L,[R0]
001D21 B110            4815         MOVS.B  R0H,#00H
001D23 B910            4816         MOVS.W  R1,#00H
001D25 964842rr        4817         MOV.B   ES,#SEG( _ParType )
001D29 B503rrrr        4818         MOV.B   [R0+SOF( _ParType )],#03H
                       4819 ; rs232par.c 1109                                       return( PMT);
001D2D 910804          4821         MOV.B   R0L,#04H
                       4822         BR      _384
001D30 D502D0         +4822         JMP.L   _384
                       4823 ; rs232par.c 1110                               }
001D34                 4825 _175:
                       4826 ; rs232par.c 1111       
                       4827 ; rs232par.c 1112                               SCPIError = InvalidCharInNumber;
001D34 964842rr        4829         MOV.B   ES,#SEG( _SCPIError )
001D38 9908rrrr        4830         MOV.W   R0,#SOF( _SCPIError )
XA assembler v2.0 r2                    SN00085795-037 (c) 1998 TASKING, Inc.
                                                                                                                            Page  65

ADDR   CODE            LINE SOURCELINE
001D3C 9A08000E        4831         MOV.W   [R0],#0EH
                       4832 ; rs232par.c 1113                               State = StateERROR;
001D40 964842rr        4834         MOV.B   ES,#SEG( _State )
001D44 9908rrrr        4835         MOV.W   R0,#SOF( _State )
001D48 92081E          4836         MOV.B   [R0],#01EH
                       4837 ; rs232par.c 1114                               break;
                       4839         BR      _329
001D4B D502B6         +4839         JMP.L   _329
                       4840 ; rs232par.c 1115       
                       4841 ; rs232par.c 1116                       case StateDA2:
001D4E                 4843 _176:
                       4844 ; rs232par.c 1117                               if ( isoctaldigit(c))
001D4E 91A430          4846         CMP.B   R5L,#030H
001D51 FB1B            4847         BLT     _178
001D53 91A437          4848         CMP.B   R5L,#037H
001D56 FC18            4849         BGT     _178
                       4850 ; rs232par.c 1118                               {
                       4851 ; rs232par.c 1119                                       if ( CmdNdx < 255)                       
                                            // TBD NOT ERROR CODES
001D58 964842rr        4853         MOV.B   ES,#SEG( _CmdNdx )
001D5C 9908rrrr        4854         MOV.W   R0,#SOF( _CmdNdx )
001D60 8A00            4855         MOV.W   R0,[R0]
001D62 990400FF        4856         CMP.W   R0,#0FFH
                       4857         BCC     _329
001D66 F102           +4857 ;       BCS     _LG_302
001D68 D502A8         +4857 ;       JMP.L   _329
001D68 D502A800       +4857 ;       JMP.L   _329
001D6C                +4857 _LG_302:
                       4858 ; rs232par.c 1120                                       {
                       4859 ; rs232par.c 1121                                               Cmd[CmdNdx++] = c;
001D6C 8920            4861         MOV.W   R2,R0
001D6E B930            4862         MOVS.W  R3,#00H
001D70 964842rr        4863         MOV.B   ES,#SEG( _Cmd )
001D74 85AArrrr        4864         MOV.B   [R2+SOF( _Cmd )],R5L
001D78 A901            4865         ADDS.W  R0,#01H
001D7A 964842rr        4866         MOV.B   ES,#SEG( _CmdNdx )
001D7E 9918rrrr        4867         MOV.W   R1,#SOF( _CmdNdx )
001D82 8A09            4868         MOV.W   [R1],R0
                       4869 ; rs232par.c 1122                                               break;
                       4871         BR      _329
001D84 D5029A         +4871         JMP.L   _329
                       4872 ; rs232par.c 1123                                       }
                       4873 ; rs232par.c 1124       //                              SCPIError = ParameterOverflowErr;
                       4874 ; rs232par.c 1125         //                            State = StateERROR;
                       4875 ; rs232par.c 1126                                       break;
                       4876 ; rs232par.c 1127                               }
001D88                 4878 _178:
                       4879 ; rs232par.c 1128       
                       4880 ; rs232par.c 1129                               if ( issemicolon(c))
001D88 91A43B          4882         CMP.B   R5L,#03BH
001D8B F21E            4883         BNE     _179
                       4884 ; rs232par.c 1130                               {
                       4885 ; rs232par.c 1131                                       Cmd[CmdNdx] = 0;
001D8D 964842rr        4887         MOV.B   ES,#SEG( _CmdNdx )
001D91 9908rrrr        4888         MOV.W   R0,#SOF( _CmdNdx )
001D95 8A00            4889         MOV.W   R0,[R0]
001D97 B910            4890         MOVS.W  R1,#00H
001D99 964842rr        4891         MOV.B   ES,#SEG( _Cmd )
001D9D B500rrrr        4892         MOV.B   [R0+SOF( _Cmd )],#00H
                       4893 ; rs232par.c 1132                                       State = StateP0;
001DA1 964842rr        4895         MOV.B   ES,#SEG( _State )
001DA5 9908rrrr        4896         MOV.W   R0,#SOF( _State )
XA assembler v2.0 r2                    SN00085795-037 (c) 1998 TASKING, Inc.
                                                                                                                            Page  66

ADDR   CODE            LINE SOURCELINE
001DA9 B200            4897         MOV.B   [R0],#00H
                       4898 ; rs232par.c 1133                                       ParType[ParCnt] = P_OctDecNum;
001DAB 964842rr        4900         MOV.B   ES,#SEG( _ParCnt )
001DAF 9908rrrr        4901         MOV.W   R0,#SOF( _ParCnt )
001DB3 8200            4902         MOV.B   R0L,[R0]
001DB5 B110            4903         MOVS.B  R0H,#00H
001DB7 B910            4904         MOVS.W  R1,#00H
001DB9 964842rr        4905         MOV.B   ES,#SEG( _ParType )
001DBD B504rrrr        4906         MOV.B   [R0+SOF( _ParType )],#04H
                       4907 ; rs232par.c 1134                                       return( PMUS);
001DC1 910803          4909         MOV.B   R0L,#03H
                       4910         BR      _384
001DC4 D50286         +4910         JMP.L   _384
                       4911 ; rs232par.c 1135                               }
001DC8                 4913 _179:
                       4914 ; rs232par.c 1136       
                       4915 ; rs232par.c 1137                               if ( iswhitespace(c))
001DC8 91A40A          4917         CMP.B   R5L,#0AH
001DCB F315            4918         BEQ     _181
001DCD 91A420          4919         CMP.B   R5L,#020H
001DD0 FC12            4920         BGT     _181
                       4921 ; rs232par.c 1138                               {
                       4922 ; rs232par.c 1139                                       State = StateP7;
001DD2 964842rr        4924         MOV.B   ES,#SEG( _State )
001DD6 9908rrrr        4925         MOV.W   R0,#SOF( _State )
001DDA B207            4926         MOV.B   [R0],#07H
                       4927 ; rs232par.c 1140                                       ParType[ParCnt] = P_OctDecNum;
001DDC 964842rr        4929         MOV.B   ES,#SEG( _ParCnt )
001DE0 9908rrrr        4930         MOV.W   R0,#SOF( _ParCnt )
001DE4 8200            4931         MOV.B   R0L,[R0]
001DE6 B110            4932         MOVS.B  R0H,#00H
001DE8 B910            4933         MOVS.W  R1,#00H
001DEA 964842rr        4934         MOV.B   ES,#SEG( _ParType )
001DEE B504rrrr        4935         MOV.B   [R0+SOF( _ParType )],#04H
                       4936 ; rs232par.c 1141                                       break;
                       4938         BR      _329
001DF2 D50263         +4938         JMP.L   _329
                       4939 ; rs232par.c 1142                               }
001DF6                 4941 _181:
                       4942 ; rs232par.c 1143       
                       4943 ; rs232par.c 1144                               if ( iscomma(c))
001DF6 91A42C          4945         CMP.B   R5L,#02CH
001DF9 F225            4946         BNE     _182
                       4947 ; rs232par.c 1145                               {
                       4948 ; rs232par.c 1146                                       Cmd[++CmdNdx] = c;
001DFB 964842rr        4950         MOV.B   ES,#SEG( _CmdNdx )
001DFF 9908rrrr        4951         MOV.W   R0,#SOF( _CmdNdx )
001E03 8A00            4952         MOV.W   R0,[R0]
001E05 A901            4953         ADDS.W  R0,#01H
001E07 8920            4954         MOV.W   R2,R0
001E09 B930            4955         MOVS.W  R3,#00H
001E0B 964842rr        4956         MOV.B   ES,#SEG( _CmdNdx )
001E0F 9918rrrr        4957         MOV.W   R1,#SOF( _CmdNdx )
001E13 8A09            4958         MOV.W   [R1],R0
001E15 964842rr        4959         MOV.B   ES,#SEG( _Cmd )
001E19 85AArrrr        4960         MOV.B   [R2+SOF( _Cmd )],R5L
                       4961 ; rs232par.c 1147                                       State = StateP8;
001E1D 964842rr        4963         MOV.B   ES,#SEG( _State )
001E21 9908rrrr        4964         MOV.W   R0,#SOF( _State )
001E25 920808          4965         MOV.B   [R0],#08H
                       4966 ; rs232par.c 1148                                       ParType[ParCnt] = P_OctDecNum;
001E28 964842rr        4968         MOV.B   ES,#SEG( _ParCnt )
XA assembler v2.0 r2                    SN00085795-037 (c) 1998 TASKING, Inc.
                                                                                                                            Page  67

ADDR   CODE            LINE SOURCELINE
001E2C 9908rrrr        4969         MOV.W   R0,#SOF( _ParCnt )
001E30 8200            4970         MOV.B   R0L,[R0]
001E32 B110            4971         MOVS.B  R0H,#00H
001E34 B910            4972         MOVS.W  R1,#00H
001E36 964842rr        4973         MOV.B   ES,#SEG( _ParType )
001E3A B504rrrr        4974         MOV.B   [R0+SOF( _ParType )],#04H
                       4975 ; rs232par.c 1149                                       return( Ready);
001E3E 910802          4977         MOV.B   R0L,#02H
                       4978         BR      _384
001E41 D50247         +4978         JMP.L   _384
                       4979 ; rs232par.c 1150                               }
001E44                 4981 _182:
                       4982 ; rs232par.c 1151       
                       4983 ; rs232par.c 1152                               if ( isnewline(c))
001E44 91A40A          4985         CMP.B   R5L,#0AH
001E47 F21E            4986         BNE     _183
                       4987 ; rs232par.c 1153                               {
                       4988 ; rs232par.c 1154                                       Cmd[CmdNdx] = 0;
001E49 964842rr        4990         MOV.B   ES,#SEG( _CmdNdx )
001E4D 9908rrrr        4991         MOV.W   R0,#SOF( _CmdNdx )
001E51 8A00            4992         MOV.W   R0,[R0]
001E53 B910            4993         MOVS.W  R1,#00H
001E55 964842rr        4994         MOV.B   ES,#SEG( _Cmd )
001E59 B500rrrr        4995         MOV.B   [R0+SOF( _Cmd )],#00H
                       4996 ; rs232par.c 1155                                       State = StateP0;
001E5D 964842rr        4998         MOV.B   ES,#SEG( _State )
001E61 9908rrrr        4999         MOV.W   R0,#SOF( _State )
001E65 B200            5000         MOV.B   [R0],#00H
                       5001 ; rs232par.c 1156                                       ParType[ParCnt] = P_OctDecNum;
001E67 964842rr        5003         MOV.B   ES,#SEG( _ParCnt )
001E6B 9908rrrr        5004         MOV.W   R0,#SOF( _ParCnt )
001E6F 8200            5005         MOV.B   R0L,[R0]
001E71 B110            5006         MOVS.B  R0H,#00H
001E73 B910            5007         MOVS.W  R1,#00H
001E75 964842rr        5008         MOV.B   ES,#SEG( _ParType )
001E79 B504rrrr        5009         MOV.B   [R0+SOF( _ParType )],#04H
                       5010 ; rs232par.c 1157                                       return( PMT);
001E7D 910804          5012         MOV.B   R0L,#04H
                       5013         BR      _384
001E80 D50228         +5013         JMP.L   _384
                       5014 ; rs232par.c 1158                               }
001E84                 5016 _183:
                       5017 ; rs232par.c 1159       
                       5018 ; rs232par.c 1160                               SCPIError = InvalidCharInNumber;
001E84 964842rr        5020         MOV.B   ES,#SEG( _SCPIError )
001E88 9908rrrr        5021         MOV.W   R0,#SOF( _SCPIError )
001E8C 9A08000E        5022         MOV.W   [R0],#0EH
                       5023 ; rs232par.c 1161                               State = StateERROR;
001E90 964842rr        5025         MOV.B   ES,#SEG( _State )
001E94 9908rrrr        5026         MOV.W   R0,#SOF( _State )
001E98 92081E          5027         MOV.B   [R0],#01EH
                       5028 ; rs232par.c 1162                               break;
                       5030         BR      _329
001E9B D5020E         +5030         JMP.L   _329
                       5031 ; rs232par.c 1163       
                       5032 ; rs232par.c 1164                       case StateDA3:
001E9E                 5034 _184:
                       5035 ; rs232par.c 1165                               if ( isbinarydigit(c))
001E9E 91A430          5037         CMP.B   R5L,#030H
001EA1 F303            5038         BEQ     _185
001EA3 91A431          5039         CMP.B   R5L,#031H
001EA6 F218            5040         BNE     _186
XA assembler v2.0 r2                    SN00085795-037 (c) 1998 TASKING, Inc.
                                                                                                                            Page  68

ADDR   CODE            LINE SOURCELINE
001EA6 F218            5040         BNE     _186
001EA8                 5041 _185:
                       5042 ; rs232par.c 1166                               {
                       5043 ; rs232par.c 1167                                       if ( CmdNdx < 255)                       
                                                            // TBD NOT ERROR CODES
001EA8 964842rr        5045         MOV.B   ES,#SEG( _CmdNdx )
001EAC 9908rrrr        5046         MOV.W   R0,#SOF( _CmdNdx )
001EB0 8A00            5047         MOV.W   R0,[R0]
001EB2 990400FF        5048         CMP.W   R0,#0FFH
                       5049         BCC     _329
001EB6 F102           +5049 ;       BCS     _LG_318
001EB8 D50200         +5049 ;       JMP.L   _329
001EB8 D5020000       +5049 ;       JMP.L   _329
001EBC                +5049 _LG_318:
                       5050 ; rs232par.c 1168                                       {
                       5051 ; rs232par.c 1169                                               Cmd[CmdNdx++] = c;
001EBC 8920            5053         MOV.W   R2,R0
001EBE B930            5054         MOVS.W  R3,#00H
001EC0 964842rr        5055         MOV.B   ES,#SEG( _Cmd )
001EC4 85AArrrr        5056         MOV.B   [R2+SOF( _Cmd )],R5L
001EC8 A901            5057         ADDS.W  R0,#01H
001ECA 964842rr        5058         MOV.B   ES,#SEG( _CmdNdx )
001ECE 9918rrrr        5059         MOV.W   R1,#SOF( _CmdNdx )
001ED2 8A09            5060         MOV.W   [R1],R0
                       5061 ; rs232par.c 1170                                               break;
                       5063         BR      _329
001ED4 D501F2         +5063         JMP.L   _329
                       5064 ; rs232par.c 1171                                       }
                       5065 ; rs232par.c 1172       //                              SCPIError = ParameterOverflowErr;
                       5066 ; rs232par.c 1173       //                              State = StateERROR;
                       5067 ; rs232par.c 1174                                       break;
                       5068 ; rs232par.c 1175                               }
001ED8                 5070 _186:
                       5071 ; rs232par.c 1176       
                       5072 ; rs232par.c 1177                               if ( issemicolon(c))
001ED8 91A43B          5074         CMP.B   R5L,#03BH
001EDB F21E            5075         BNE     _187
                       5076 ; rs232par.c 1178                               {
                       5077 ; rs232par.c 1179                                       Cmd[CmdNdx] = 0;
001EDD 964842rr        5079         MOV.B   ES,#SEG( _CmdNdx )
001EE1 9908rrrr        5080         MOV.W   R0,#SOF( _CmdNdx )
001EE5 8A00            5081         MOV.W   R0,[R0]
001EE7 B910            5082         MOVS.W  R1,#00H
001EE9 964842rr        5083         MOV.B   ES,#SEG( _Cmd )
001EED B500rrrr        5084         MOV.B   [R0+SOF( _Cmd )],#00H
                       5085 ; rs232par.c 1180                                       State = StateP0;
001EF1 964842rr        5087         MOV.B   ES,#SEG( _State )
001EF5 9908rrrr        5088         MOV.W   R0,#SOF( _State )
001EF9 B200            5089         MOV.B   [R0],#00H
                       5090 ; rs232par.c 1181                                       ParType[ParCnt] = P_BinDecNum;
001EFB 964842rr        5092         MOV.B   ES,#SEG( _ParCnt )
001EFF 9908rrrr        5093         MOV.W   R0,#SOF( _ParCnt )
001F03 8200            5094         MOV.B   R0L,[R0]
001F05 B110            5095         MOVS.B  R0H,#00H
001F07 B910            5096         MOVS.W  R1,#00H
001F09 964842rr        5097         MOV.B   ES,#SEG( _ParType )
001F0D B505rrrr        5098         MOV.B   [R0+SOF( _ParType )],#05H
                       5099 ; rs232par.c 1182                                       return( PMUS);
001F11 910803          5101         MOV.B   R0L,#03H
                       5102         BR      _384
001F14 D501DE         +5102         JMP.L   _384
                       5103 ; rs232par.c 1183                               }
XA assembler v2.0 r2                    SN00085795-037 (c) 1998 TASKING, Inc.
                                                                                                                            Page  69

ADDR   CODE            LINE SOURCELINE
001F18                 5105 _187:
                       5106 ; rs232par.c 1184       
                       5107 ; rs232par.c 1185                               if ( iswhitespace(c))
001F18 91A40A          5109         CMP.B   R5L,#0AH
001F1B F315            5110         BEQ     _189
001F1D 91A420          5111         CMP.B   R5L,#020H
001F20 FC12            5112         BGT     _189
                       5113 ; rs232par.c 1186                               {
                       5114 ; rs232par.c 1187                                       State = StateP7;
001F22 964842rr        5116         MOV.B   ES,#SEG( _State )
001F26 9908rrrr        5117         MOV.W   R0,#SOF( _State )
001F2A B207            5118         MOV.B   [R0],#07H
                       5119 ; rs232par.c 1188                                       ParType[ParCnt] = P_BinDecNum;
001F2C 964842rr        5121         MOV.B   ES,#SEG( _ParCnt )
001F30 9908rrrr        5122         MOV.W   R0,#SOF( _ParCnt )
001F34 8200            5123         MOV.B   R0L,[R0]
001F36 B110            5124         MOVS.B  R0H,#00H
001F38 B910            5125         MOVS.W  R1,#00H
001F3A 964842rr        5126         MOV.B   ES,#SEG( _ParType )
001F3E B505rrrr        5127         MOV.B   [R0+SOF( _ParType )],#05H
                       5128 ; rs232par.c 1189                                       break;
                       5130         BR      _329
001F42 D501BB         +5130         JMP.L   _329
                       5131 ; rs232par.c 1190                               }
001F46                 5133 _189:
                       5134 ; rs232par.c 1191       
                       5135 ; rs232par.c 1192                               if ( iscomma(c))
001F46 91A42C          5137         CMP.B   R5L,#02CH
001F49 F225            5138         BNE     _190
                       5139 ; rs232par.c 1193                               {
                       5140 ; rs232par.c 1194                                       Cmd[++CmdNdx] = c;
001F4B 964842rr        5142         MOV.B   ES,#SEG( _CmdNdx )
001F4F 9908rrrr        5143         MOV.W   R0,#SOF( _CmdNdx )
001F53 8A00            5144         MOV.W   R0,[R0]
001F55 A901            5145         ADDS.W  R0,#01H
001F57 8920            5146         MOV.W   R2,R0
001F59 B930            5147         MOVS.W  R3,#00H
001F5B 964842rr        5148         MOV.B   ES,#SEG( _CmdNdx )
001F5F 9918rrrr        5149         MOV.W   R1,#SOF( _CmdNdx )
001F63 8A09            5150         MOV.W   [R1],R0
001F65 964842rr        5151         MOV.B   ES,#SEG( _Cmd )
001F69 85AArrrr        5152         MOV.B   [R2+SOF( _Cmd )],R5L
                       5153 ; rs232par.c 1195                                       State = StateP8;
001F6D 964842rr        5155         MOV.B   ES,#SEG( _State )
001F71 9908rrrr        5156         MOV.W   R0,#SOF( _State )
001F75 920808          5157         MOV.B   [R0],#08H
                       5158 ; rs232par.c 1196                                       ParType[ParCnt] = P_BinDecNum;
001F78 964842rr        5160         MOV.B   ES,#SEG( _ParCnt )
001F7C 9908rrrr        5161         MOV.W   R0,#SOF( _ParCnt )
001F80 8200            5162         MOV.B   R0L,[R0]
001F82 B110            5163         MOVS.B  R0H,#00H
001F84 B910            5164         MOVS.W  R1,#00H
001F86 964842rr        5165         MOV.B   ES,#SEG( _ParType )
001F8A B505rrrr        5166         MOV.B   [R0+SOF( _ParType )],#05H
                       5167 ; rs232par.c 1197                                       return( Ready);
001F8E 910802          5169         MOV.B   R0L,#02H
                       5170         BR      _384
001F91 D5019F         +5170         JMP.L   _384
                       5171 ; rs232par.c 1198                               }
001F94                 5173 _190:
                       5174 ; rs232par.c 1199       
                       5175 ; rs232par.c 1200                               if ( isnewline(c))
XA assembler v2.0 r2                    SN00085795-037 (c) 1998 TASKING, Inc.
                                                                                                                            Page  70

ADDR   CODE            LINE SOURCELINE
001F94 91A40A          5177         CMP.B   R5L,#0AH
001F97 F21E            5178         BNE     _191
                       5179 ; rs232par.c 1201                               {
                       5180 ; rs232par.c 1202                                       Cmd[CmdNdx] = 0;
001F99 964842rr        5182         MOV.B   ES,#SEG( _CmdNdx )
001F9D 9908rrrr        5183         MOV.W   R0,#SOF( _CmdNdx )
001FA1 8A00            5184         MOV.W   R0,[R0]
001FA3 B910            5185         MOVS.W  R1,#00H
001FA5 964842rr        5186         MOV.B   ES,#SEG( _Cmd )
001FA9 B500rrrr        5187         MOV.B   [R0+SOF( _Cmd )],#00H
                       5188 ; rs232par.c 1203                                       State = StateP0;
001FAD 964842rr        5190         MOV.B   ES,#SEG( _State )
001FB1 9908rrrr        5191         MOV.W   R0,#SOF( _State )
001FB5 B200            5192         MOV.B   [R0],#00H
                       5193 ; rs232par.c 1204                                       ParType[ParCnt] = P_BinDecNum;
001FB7 964842rr        5195         MOV.B   ES,#SEG( _ParCnt )
001FBB 9908rrrr        5196         MOV.W   R0,#SOF( _ParCnt )
001FBF 8200            5197         MOV.B   R0L,[R0]
001FC1 B110            5198         MOVS.B  R0H,#00H
001FC3 B910            5199         MOVS.W  R1,#00H
001FC5 964842rr        5200         MOV.B   ES,#SEG( _ParType )
001FC9 B505rrrr        5201         MOV.B   [R0+SOF( _ParType )],#05H
                       5202 ; rs232par.c 1205                                       return( PMT);
001FCD 910804          5204         MOV.B   R0L,#04H
                       5205         BR      _384
001FD0 D50180         +5205         JMP.L   _384
                       5206 ; rs232par.c 1206                               }
001FD4                 5208 _191:
                       5209 ; rs232par.c 1207       
                       5210 ; rs232par.c 1208                               SCPIError = InvalidCharInNumber;
001FD4 964842rr        5212         MOV.B   ES,#SEG( _SCPIError )
001FD8 9908rrrr        5213         MOV.W   R0,#SOF( _SCPIError )
001FDC 9A08000E        5214         MOV.W   [R0],#0EH
                       5215 ; rs232par.c 1209                               State = StateERROR;
001FE0 964842rr        5217         MOV.B   ES,#SEG( _State )
001FE4 9908rrrr        5218         MOV.W   R0,#SOF( _State )
001FE8 92081E          5219         MOV.B   [R0],#01EH
                       5220 ; rs232par.c 1210                               break;
                       5222         BR      _329
001FEB D50166         +5222         JMP.L   _329
                       5223 ; rs232par.c 1211       
                       5224 ; rs232par.c 1212                       case StateDA4:
001FEE                 5226 _192:
                       5229 ; rs232par.c 1213                               if ( NoOfDigits)
001FEE 964842rr        5231         MOV.B   ES,#SEG( _NoOfDigits )
001FF2 9908rrrr        5232         MOV.W   R0,#SOF( _NoOfDigits )
001FF6 8200            5233         MOV.B   R0L,[R0]
001FF8 F332            5234         BEQ     _194
                       5235 ; rs232par.c 1214                               {
                       5236 ; rs232par.c 1215                                       if ( isdigit(c))
001FFA 814A            5238         MOV.B   R2L,R5L
001FFC 9059            5239         SEXT.B  R2H
001FFE 9839            5240         SEXT.W  R3
002000 964842rr        5241         MOV.B   ES,#SEG( __ctype_+1 )
002004 8512rrrr        5242         MOV.B   R0H,[R2+SOF( __ctype_+1 )]
002008 8121            5243         MOV.B   R1L,R0H
00200A 9039            5244         SEXT.B  R1H
00200C 99150004        5245         AND.W   R1,#04H
002010 F319            5246         BEQ     _193
                       5247 ; rs232par.c 1216                                       {
                       5248 ; rs232par.c 1217                                               NoOfDigits--;
002012 A10F            5250         ADDS.B  R0L,#0FH
XA assembler v2.0 r2                    SN00085795-037 (c) 1998 TASKING, Inc.
                                                                                                                            Page  71

ADDR   CODE            LINE SOURCELINE
002014 964842rr        5251         MOV.B   ES,#SEG( _NoOfDigits )
002018 9918rrrr        5252         MOV.W   R1,#SOF( _NoOfDigits )
00201C 8209            5253         MOV.B   [R1],R0L
                       5254 ; rs232par.c 1218                                               NoOfBytes = 10*NoOfBytes + ( c - 
                            '0');
00201E 964842rr        5256         MOV.B   ES,#SEG( _NoOfBytes )
002022 9908rrrr        5257         MOV.W   R0,#SOF( _NoOfBytes )
002026 8A00            5258         MOV.W   R0,[R0]
002028 E900000A        5259         MULU.W  R0,#0AH
00202C 81AA            5260         MOV.B   R5L,R5L
00202E 90B9            5261         SEXT.B  R5H
002030 99520030        5262         SUB.W   R5,#030H
002034 0905            5263         ADD.W   R0,R5
002036 964842rr        5264         MOV.B   ES,#SEG( _NoOfBytes )
00203A 9918rrrr        5265         MOV.W   R1,#SOF( _NoOfBytes )
00203E 8A09            5266         MOV.W   [R1],R0
                       5267 ; rs232par.c 1219                                               break;
                       5269         BR      _329
002040 D5013C         +5269         JMP.L   _329
                       5270 ; rs232par.c 1220                                       }
002044                 5272 _193:
                       5273 ; rs232par.c 1221                                       SCPIError = InvalidBlockData;
002044 964842rr        5275         MOV.B   ES,#SEG( _SCPIError )
002048 9908rrrr        5276         MOV.W   R0,#SOF( _SCPIError )
00204C 9A08001B        5277         MOV.W   [R0],#01BH
                       5278 ; rs232par.c 1222                                       State = StateERROR;
002050 964842rr        5280         MOV.B   ES,#SEG( _State )
002054 9908rrrr        5281         MOV.W   R0,#SOF( _State )
002058 92081E          5282         MOV.B   [R0],#01EH
                       5283 ; rs232par.c 1223                                       break;
                       5285         BR      _329
00205B D5012E         +5285         JMP.L   _329
                       5286 ; rs232par.c 1224                               }
00205E                 5288 _194:
                       5291 ; rs232par.c 1225       
                       5292 ; rs232par.c 1226                               if ( CmdNdx < NoOfBytes)
00205E 964842rr        5294         MOV.B   ES,#SEG( _CmdNdx )
002062 9908rrrr        5295         MOV.W   R0,#SOF( _CmdNdx )
002066 8A00            5296         MOV.W   R0,[R0]
002068 964842rr        5297         MOV.B   ES,#SEG( _NoOfBytes )
00206C 9918rrrr        5298         MOV.W   R1,#SOF( _NoOfBytes )
002070 8A11            5299         MOV.W   R1,[R1]
002072 4901            5300         CMP.W   R0,R1
                       5301         BCS     _200
002074 F002           +5301 ;       BCC     _LG_334
002076 D50083         +5301 ;       JMP.L   _200
002076 D5008300       +5301 ;       JMP.L   _200
00207A                +5301 _LG_334:
                       5302 ; rs232par.c 1227                               {
                       5303 ; rs232par.c 1228                                       Cmd[CmdNdx++] = c_str;
                       5304 ; rs232par.c 1229                               }
                       5305 ; rs232par.c 1230                               else {
                       5306 ; rs232par.c 1231                                       if ( issemicolon(c))
00207A 91A43B          5308         CMP.B   R5L,#03BH
00207D F219            5309         BNE     _195
                       5310 ; rs232par.c 1232                                       {
                       5311 ; rs232par.c 1233                                               Cmd[CmdNdx] = 0;
00207F B910            5313         MOVS.W  R1,#00H
002081 964842rr        5314         MOV.B   ES,#SEG( _Cmd )
002085 B500rrrr        5315         MOV.B   [R0+SOF( _Cmd )],#00H
                       5316 ; rs232par.c 1234                                               State = StateP0;
002089 964842rr        5318         MOV.B   ES,#SEG( _State )
XA assembler v2.0 r2                    SN00085795-037 (c) 1998 TASKING, Inc.
                                                                                                                            Page  72

ADDR   CODE            LINE SOURCELINE
00208D 9908rrrr        5319         MOV.W   R0,#SOF( _State )
002091 B200            5320         MOV.B   [R0],#00H
                       5321 ; rs232par.c 1235                                               ParType[ParCnt] = P_Blockn;
002093 964842rr        5323         MOV.B   ES,#SEG( _ParCnt )
002097 9908rrrr        5324         MOV.W   R0,#SOF( _ParCnt )
00209B 8200            5325         MOV.B   R0L,[R0]
00209D B110            5326         MOVS.B  R0H,#00H
00209F B910            5327         MOVS.W  R1,#00H
0020A1 964842rr        5328         MOV.B   ES,#SEG( _ParType )
0020A5 9508rrrr08      5329         MOV.B   [R0+SOF( _ParType )],#08H
                       5330 ; rs232par.c 1236                                               return( PMUS);
0020AA 910803          5332         MOV.B   R0L,#03H
                       5333         BR      _384
0020AD D50111         +5333         JMP.L   _384
                       5334 ; rs232par.c 1237                                       }
0020B0                 5336 _195:
                       5337 ; rs232par.c 1238       
                       5338 ; rs232par.c 1239                                       if ( iswhitespace(c))
0020B0 91A40A          5340         CMP.B   R5L,#0AH
0020B3 F315            5341         BEQ     _197
0020B5 91A420          5342         CMP.B   R5L,#020H
0020B8 FC12            5343         BGT     _197
                       5344 ; rs232par.c 1240                                       {
                       5345 ; rs232par.c 1241                                               State = StateP7;
0020BA 964842rr        5347         MOV.B   ES,#SEG( _State )
0020BE 9908rrrr        5348         MOV.W   R0,#SOF( _State )
0020C2 B207            5349         MOV.B   [R0],#07H
                       5350 ; rs232par.c 1242                                               ParType[ParCnt] = P_Blockn;
0020C4 964842rr        5352         MOV.B   ES,#SEG( _ParCnt )
0020C8 9908rrrr        5353         MOV.W   R0,#SOF( _ParCnt )
0020CC 8200            5354         MOV.B   R0L,[R0]
0020CE B110            5355         MOVS.B  R0H,#00H
0020D0 B910            5356         MOVS.W  R1,#00H
0020D2 964842rr        5357         MOV.B   ES,#SEG( _ParType )
0020D6 9508rrrr08      5358         MOV.B   [R0+SOF( _ParType )],#08H
                       5359 ; rs232par.c 1243                                               break;
                       5361         BR      _329
0020DB D500EE         +5361         JMP.L   _329
                       5362 ; rs232par.c 1244                                       }
0020DE                 5364 _197:
                       5365 ; rs232par.c 1245       
                       5366 ; rs232par.c 1246                                       if ( iscomma(c))
0020DE 91A42C          5368         CMP.B   R5L,#02CH
0020E1 F221            5369         BNE     _198
                       5370 ; rs232par.c 1247                                       {
                       5371 ; rs232par.c 1248                                               Cmd[++CmdNdx] = c;
0020E3 A901            5373         ADDS.W  R0,#01H
0020E5 8920            5374         MOV.W   R2,R0
0020E7 B930            5375         MOVS.W  R3,#00H
0020E9 964842rr        5376         MOV.B   ES,#SEG( _CmdNdx )
0020ED 9918rrrr        5377         MOV.W   R1,#SOF( _CmdNdx )
0020F1 8A09            5378         MOV.W   [R1],R0
0020F3 964842rr        5379         MOV.B   ES,#SEG( _Cmd )
0020F7 85AArrrr        5380         MOV.B   [R2+SOF( _Cmd )],R5L
                       5381 ; rs232par.c 1249                                               State = StateP8;
0020FB 964842rr        5383         MOV.B   ES,#SEG( _State )
0020FF 9908rrrr        5384         MOV.W   R0,#SOF( _State )
002103 920808          5385         MOV.B   [R0],#08H
                       5386 ; rs232par.c 1250                                               ParType[ParCnt] = P_Blockn;
002106 964842rr        5388         MOV.B   ES,#SEG( _ParCnt )
00210A 9908rrrr        5389         MOV.W   R0,#SOF( _ParCnt )
00210E 8200            5390         MOV.B   R0L,[R0]
XA assembler v2.0 r2                    SN00085795-037 (c) 1998 TASKING, Inc.
                                                                                                                            Page  73

ADDR   CODE            LINE SOURCELINE
002110 B110            5391         MOVS.B  R0H,#00H
002112 B910            5392         MOVS.W  R1,#00H
002114 964842rr        5393         MOV.B   ES,#SEG( _ParType )
002118 9508rrrr08      5394         MOV.B   [R0+SOF( _ParType )],#08H
                       5395 ; rs232par.c 1251                                               return( Ready);
00211D 910802          5397         MOV.B   R0L,#02H
                       5398         BR      _384
002120 D500D8         +5398         JMP.L   _384
                       5399 ; rs232par.c 1252                                       }
002124                 5401 _198:
                       5402 ; rs232par.c 1253       
                       5403 ; rs232par.c 1254                                       if ( isnewline(c))
002124 91A40A          5405         CMP.B   R5L,#0AH
002127 F21E            5406         BNE     _199
                       5407 ; rs232par.c 1255                                       {
                       5408 ; rs232par.c 1256                                               Cmd[CmdNdx] = 0;
002129 964842rr        5410         MOV.B   ES,#SEG( _CmdNdx )
00212D 9908rrrr        5411         MOV.W   R0,#SOF( _CmdNdx )
002131 8A00            5412         MOV.W   R0,[R0]
002133 B910            5413         MOVS.W  R1,#00H
002135 964842rr        5414         MOV.B   ES,#SEG( _Cmd )
002139 B500rrrr        5415         MOV.B   [R0+SOF( _Cmd )],#00H
                       5416 ; rs232par.c 1257                                               State = StateP0;
00213D 964842rr        5418         MOV.B   ES,#SEG( _State )
002141 9908rrrr        5419         MOV.W   R0,#SOF( _State )
002145 B200            5420         MOV.B   [R0],#00H
                       5421 ; rs232par.c 1258                                               ParType[ParCnt] = P_Blockn;
002147 964842rr        5423         MOV.B   ES,#SEG( _ParCnt )
00214B 9908rrrr        5424         MOV.W   R0,#SOF( _ParCnt )
00214F 8200            5425         MOV.B   R0L,[R0]
002151 B110            5426         MOVS.B  R0H,#00H
002153 B910            5427         MOVS.W  R1,#00H
002155 964842rr        5428         MOV.B   ES,#SEG( _ParType )
002159 9508rrrr08      5429         MOV.B   [R0+SOF( _ParType )],#08H
                       5430 ; rs232par.c 1259                                               return( PMT);
00215E 910804          5432         MOV.B   R0L,#04H
                       5433         BR      _384
002161 D500B7         +5433         JMP.L   _384
                       5434 ; rs232par.c 1260                                       }
002164                 5436 _199:
                       5437 ; rs232par.c 1261       
                       5438 ; rs232par.c 1262                                       SCPIError = InvalidBlockData;
002164 964842rr        5440         MOV.B   ES,#SEG( _SCPIError )
002168 9908rrrr        5441         MOV.W   R0,#SOF( _SCPIError )
00216C 9A08001B        5442         MOV.W   [R0],#01BH
                       5443 ; rs232par.c 1263                                       State = StateERROR;
002170 964842rr        5445         MOV.B   ES,#SEG( _State )
002174 9908rrrr        5446         MOV.W   R0,#SOF( _State )
002178 92081E          5447         MOV.B   [R0],#01EH
                       5448 ; rs232par.c 1264                                       break;
                       5450         BR      _329
00217B D5009E         +5450         JMP.L   _329
00217E                 5452 _200:
00217E 964842rr        5455         MOV.B   ES,#SEG( _CmdNdx )
002182 9908rrrr        5456         MOV.W   R0,#SOF( _CmdNdx )
002186 8A00            5457         MOV.W   R0,[R0]
002188 8920            5458         MOV.W   R2,R0
00218A B930            5459         MOVS.W  R3,#00H
00218C 964842rr        5460         MOV.B   ES,#SEG( _Cmd )
002190 859Arrrr        5461         MOV.B   [R2+SOF( _Cmd )],R4H
002194 A901            5462         ADDS.W  R0,#01H
002196 964842rr        5463         MOV.B   ES,#SEG( _CmdNdx )
XA assembler v2.0 r2                    SN00085795-037 (c) 1998 TASKING, Inc.
                                                                                                                            Page  74

ADDR   CODE            LINE SOURCELINE
00219A 9918rrrr        5464         MOV.W   R1,#SOF( _CmdNdx )
00219E 8A09            5465         MOV.W   [R1],R0
                       5466 ; rs232par.c 1265                               }
                       5467 ; rs232par.c 1266                               break;
                       5469         BR      _329
0021A0 D5008C         +5469         JMP.L   _329
                       5470 ; rs232par.c 1267       
                       5471 ; rs232par.c 1268                       case StateDA5:
0021A4                 5473 _201:
                       5476 ; rs232par.c 1269                               if ( isnewline(c))
0021A4 91A40A          5478         CMP.B   R5L,#0AH
0021A7 F21D            5479         BNE     _202
                       5480 ; rs232par.c 1270                               {
                       5481 ; rs232par.c 1271                                       Cmd[CmdNdx] = 0;
0021A9 964842rr        5483         MOV.B   ES,#SEG( _CmdNdx )
0021AD 9908rrrr        5484         MOV.W   R0,#SOF( _CmdNdx )
0021B1 8A00            5485         MOV.W   R0,[R0]
0021B3 B910            5486         MOVS.W  R1,#00H
0021B5 964842rr        5487         MOV.B   ES,#SEG( _Cmd )
0021B9 B500rrrr        5488         MOV.B   [R0+SOF( _Cmd )],#00H
                       5489 ; rs232par.c 1272                                       State = StateP0;
0021BD 964842rr        5491         MOV.B   ES,#SEG( _State )
0021C1 9908rrrr        5492         MOV.W   R0,#SOF( _State )
0021C5 B200            5493         MOV.B   [R0],#00H
                       5494 ; rs232par.c 1273                                       ParType[ParCnt] = P_Block0;
0021C7 964842rr        5496         MOV.B   ES,#SEG( _ParCnt )
0021CB 9908rrrr        5497         MOV.W   R0,#SOF( _ParCnt )
0021CF 8200            5498         MOV.B   R0L,[R0]
0021D1 B110            5499         MOVS.B  R0H,#00H
0021D3 B910            5500         MOVS.W  R1,#00H
0021D5 964842rr        5501         MOV.B   ES,#SEG( _ParType )
0021D9 B507rrrr        5502         MOV.B   [R0+SOF( _ParType )],#07H
                       5503 ; rs232par.c 1274                                       return( PMT);
0021DD 910804          5505         MOV.B   R0L,#04H
0021E0 FE78            5506         BR      _384
                       5507 ; rs232par.c 1275                               }
0021E2                 5509 _202:
                       5512 ; rs232par.c 1276       
                       5513 ; rs232par.c 1277                               Cmd[CmdNdx++] = c_str;
0021E2 964842rr        5515         MOV.B   ES,#SEG( _CmdNdx )
0021E6 9908rrrr        5516         MOV.W   R0,#SOF( _CmdNdx )
0021EA 8A00            5517         MOV.W   R0,[R0]
0021EC 8920            5518         MOV.W   R2,R0
0021EE B930            5519         MOVS.W  R3,#00H
0021F0 964842rr        5520         MOV.B   ES,#SEG( _Cmd )
0021F4 859Arrrr        5521         MOV.B   [R2+SOF( _Cmd )],R4H
0021F8 A901            5522         ADDS.W  R0,#01H
0021FA 964842rr        5523         MOV.B   ES,#SEG( _CmdNdx )
0021FE 9918rrrr        5524         MOV.W   R1,#SOF( _CmdNdx )
002202 8A09            5525         MOV.W   [R1],R0
                       5526 ; rs232par.c 1278                               break;
002204 FE5A            5528         BR      _329
                       5529 ; rs232par.c 1279       
                       5530 ; rs232par.c 1280                       case StateA0:                                            
                                     // ASCII DATA ONLY FOR A RESPONSE
002206                 5532 _203:
                       5535 ; rs232par.c 1281                               if ( isnewline( c))
002206 91A40A          5537         CMP.B   R5L,#0AH
002209 F212            5538         BNE     _204
                       5539 ; rs232par.c 1282                               {
                       5540 ; rs232par.c 1283                                       Cmd[CmdNdx] = 0;
00220B 964842rr        5542         MOV.B   ES,#SEG( _CmdNdx )
XA assembler v2.0 r2                    SN00085795-037 (c) 1998 TASKING, Inc.
                                                                                                                            Page  75

ADDR   CODE            LINE SOURCELINE
00220F 9908rrrr        5543         MOV.W   R0,#SOF( _CmdNdx )
002213 8A00            5544         MOV.W   R0,[R0]
002215 B910            5545         MOVS.W  R1,#00H
002217 964842rr        5546         MOV.B   ES,#SEG( _Cmd )
00221B B500rrrr        5547         MOV.B   [R0+SOF( _Cmd )],#00H
                       5548 ; rs232par.c 1284                                       State = StateP0;
00221F 964842rr        5550         MOV.B   ES,#SEG( _State )
002223 9908rrrr        5551         MOV.W   R0,#SOF( _State )
002227 B200            5552         MOV.B   [R0],#00H
                       5553 ; rs232par.c 1285                                       return( PMT);
002229 910804          5555         MOV.B   R0L,#04H
00222C FE52            5556         BR      _384
                       5557 ; rs232par.c 1286                               }
00222E                 5559 _204:
                       5562 ; rs232par.c 1287       
                       5563 ; rs232par.c 1288                               Cmd[CmdNdx++] = c_str;
00222E 964842rr        5565         MOV.B   ES,#SEG( _CmdNdx )
002232 9908rrrr        5566         MOV.W   R0,#SOF( _CmdNdx )
002236 8A00            5567         MOV.W   R0,[R0]
002238 8920            5568         MOV.W   R2,R0
00223A B930            5569         MOVS.W  R3,#00H
00223C 964842rr        5570         MOV.B   ES,#SEG( _Cmd )
002240 859Arrrr        5571         MOV.B   [R2+SOF( _Cmd )],R4H
002244 A901            5572         ADDS.W  R0,#01H
002246 964842rr        5573         MOV.B   ES,#SEG( _CmdNdx )
00224A 9918rrrr        5574         MOV.W   R1,#SOF( _CmdNdx )
00224E 8A09            5575         MOV.W   [R1],R0
                       5576 ; rs232par.c 1289                               ParType[ParCnt] = P_ASCII;
002250 964842rr        5578         MOV.B   ES,#SEG( _ParCnt )
002254 9908rrrr        5579         MOV.W   R0,#SOF( _ParCnt )
002258 8200            5580         MOV.B   R0L,[R0]
00225A B110            5581         MOVS.B  R0H,#00H
00225C B910            5582         MOVS.W  R1,#00H
00225E 964842rr        5583         MOV.B   ES,#SEG( _ParType )
002262 9508rrrr0A      5584         MOV.B   [R0+SOF( _ParType )],#0AH
                       5585 ; rs232par.c 1290                               break;
002267 FE29            5587         BR      _329
                       5588 ; rs232par.c 1291       
                       5589 ; rs232par.c 1292                       case StateE0:
00226A                 5591 _205:
                       5592 ; rs232par.c 1293                               if ( (c) == ')')
00226A 91A429          5594         CMP.B   R5L,#029H
00226D F226            5595         BNE     _329
                       5596 ; rs232par.c 1294                               {
                       5597 ; rs232par.c 1295                                       State = StateP7;
00226F 964842rr        5599         MOV.B   ES,#SEG( _State )
002273 9908rrrr        5600         MOV.W   R0,#SOF( _State )
002277 B207            5601         MOV.B   [R0],#07H
                       5602 ; rs232par.c 1296                                       ParType[ParCnt] = P_Block0;
002279 964842rr        5604         MOV.B   ES,#SEG( _ParCnt )
00227D 9908rrrr        5605         MOV.W   R0,#SOF( _ParCnt )
002281 8200            5606         MOV.B   R0L,[R0]
002283 B110            5607         MOVS.B  R0H,#00H
002285 B910            5608         MOVS.W  R1,#00H
002287 964842rr        5609         MOV.B   ES,#SEG( _ParType )
00228B B507rrrr        5610         MOV.B   [R0+SOF( _ParType )],#07H
                       5611 ; rs232par.c 1297                               }
                       5612 ; rs232par.c 1298                               break;
00228F FE15            5614         BR      _329
                       5615 ; rs232par.c 1299       
                       5616 ; rs232par.c 1300                       case StateERROR:                                         
                                     // ERROR
XA assembler v2.0 r2                    SN00085795-037 (c) 1998 TASKING, Inc.
                                                                                                                            Page  76

ADDR   CODE            LINE SOURCELINE
002292                 5618 _206:
                       5619 ; rs232par.c 1301                               if ( issemicolon(c))
002292 91A43B          5621         CMP.B   R5L,#03BH
002295 F208            5622         BNE     _207
                       5623 ; rs232par.c 1302                               {
                       5624 ; rs232par.c 1303                                       State = StateP0;
002297 964842rr        5626         MOV.B   ES,#SEG( _State )
00229B 9908rrrr        5627         MOV.W   R0,#SOF( _State )
00229F B200            5628         MOV.B   [R0],#00H
                       5629 ; rs232par.c 1304                                       return( PMUS);
0022A1 910803          5631         MOV.B   R0L,#03H
0022A4 FE16            5632         BR      _384
                       5633 ; rs232par.c 1305                               }
0022A6                 5635 _207:
                       5636 ; rs232par.c 1306       
                       5637 ; rs232par.c 1307                               if ( isnewline(c))
0022A6 91A40A          5639         CMP.B   R5L,#0AH
0022A9 F208            5640         BNE     _329
                       5641 ; rs232par.c 1308                               {
                       5642 ; rs232par.c 1309                                       State = StateP0;
0022AB 964842rr        5644         MOV.B   ES,#SEG( _State )
0022AF 9908rrrr        5645         MOV.W   R0,#SOF( _State )
0022B3 B200            5646         MOV.B   [R0],#00H
                       5647 ; rs232par.c 1310                                       return( PMT);
0022B5 910804          5649         MOV.B   R0L,#04H
0022B8 FE0C            5650         BR      _384
                       5651 ; rs232par.c 1311                               }
                       5652 ; rs232par.c 1312                               break;
                       5653 ; rs232par.c 1313               }
0022BA                 5655 _329:
                       5656 ; rs232par.c 1314       
                       5657 ; rs232par.c 1315               if ( State == StateERROR)
0022BA 964842rr        5659         MOV.B   ES,#SEG( _State )
0022BE 9908rrrr        5660         MOV.W   R0,#SOF( _State )
0022C2 8200            5661         MOV.B   R0L,[R0]
0022C4 91041E          5662         CMP.B   R0L,#01EH
0022C7 F203            5663         BNE     _330
                       5664 ; rs232par.c 1316                       return( Error);
0022C9 910805          5666         MOV.B   R0L,#05H
0022CC FE02            5667         BR      _384
0022CC FE02            5667         BR      _384
0022CE                 5668 _330:
                       5669 ; rs232par.c 1317       
                       5670 ; rs232par.c 1318               return( Idle);
0022CE 910800          5672         MOV.B   R0L,#00H
                       5673 ; rs232par.c 1319       }
0022D2                 5675 _384:
0022D2 A974            5676         ADDS.W  R7,#04H
0022D4 2F30            5678         POP.W   R4, R5
0022D6 D680            5680         RET
                       5683 ; rs232par.c 1320       
                       5684 ; rs232par.c 1321       /************************************************************************
                            **/
                       5685 ; rs232par.c 1322       /* CmdHandler                                                            
                                                                                                                             
                                                         RS232PAR.C */
                       5686 ; rs232par.c 1323       /*                                                                       
                                                                                                                             
                                                                                                                             
                                                    */
XA assembler v2.0 r2                    SN00085795-037 (c) 1998 TASKING, Inc.
                                                                                                                            Page  77

ADDR   CODE            LINE SOURCELINE
                       5687 ; rs232par.c 1324       /* Author:              Kim Engedahl, DEV, 941124                        
                                                                                                                             
                                    */
                       5688 ; rs232par.c 1325       /* Revised:             000414                                           
                                                                                                                             
                                                                                    */
                       5689 ; rs232par.c 1326       /*                                                                       
                                                                                                                             
                                                                                                                             
                                                    */
                       5690 ; rs232par.c 1327       /* Function:                                                             
                                                                                                                             
                                                                                                                    */
                       5691 ; rs232par.c 1328       /* Remarks:                                                              
                                                                                                                             
                                                                                                                            *
                            /
                       5692 ; rs232par.c 1329       /* Returns:             --                                               
                                                                                                                             
                                                                                                                    */
                       5693 ; rs232par.c 1330       /* Updates:             TBD                                              
                                                                                                                             
                                                                                                                    */
                       5694 ; rs232par.c 1331       /************************************************************************
                            **/
                       5695 ; rs232par.c 1332       void CmdHandler( char c)
                       5696 ; rs232par.c 1333       {
                       5697         ALIGN   1
                       5699         PUBLIC  _CmdHandler
0022D8                 5700 _CmdHandler:
0022D8 0F70            5704         PUSH.W  R4, R5, R6
                       5710 ; rs232par.c 1334       
                       5711 ; rs232par.c 1335               UC CmdState;
                       5712 ; rs232par.c 1336       //      UL DecVar;
                       5713 ; rs232par.c 1337       
                       5714 ; rs232par.c 1338               switch ( CmdState = CmdSyntax( c))
0022DA C5EE92          5716         CALL    _CmdSyntax
0022DD 81C0            5718         MOV.B   R6L,R0L
0022DF 91C400          5720         CMP.B   R6L,#00H
                       5721         BEQ     _562
0022E2 F202           +5721 ;       BNE     _LG_358
0022E4 D5012C         +5721 ;       JMP.L   _562
0022E4 D5012C00       +5721 ;       JMP.L   _562
0022E8                +5721 _LG_358:
0022E8 91C405          5722         CMP.B   R6L,#05H
                       5723         BEQ     _562
0022EB F202           +5723 ;       BNE     _LG_360
0022ED D50127         +5723 ;       JMP.L   _562
0022ED D50127         +5723 ;       JMP.L   _562
0022F0                +5723 _LG_360:
0022F0 FE00            5724         BR      _535
                       5725 ; rs232par.c 1339               {
                       5726 ; rs232par.c 1340                       case Idle:
                       5727 ; rs232par.c 1341                               break;
                       5728 ; rs232par.c 1342       
                       5729 ; rs232par.c 1343                       case Error:
                       5730 ; rs232par.c 1344                               break;
                       5731 ; rs232par.c 1345       
                       5732 ; rs232par.c 1346                       default:                                                 
                                                    // ie. NextLevel, Ready, PMUS and PMT
0022F2                 5734 _535:
                       5735 ; rs232par.c 1347                               if ( ParType[ParCnt] == P_NoParameter)
XA assembler v2.0 r2                    SN00085795-037 (c) 1998 TASKING, Inc.
                                                                                                                            Page  78

ADDR   CODE            LINE SOURCELINE
0022F2 964842rr        5737         MOV.B   ES,#SEG( _ParCnt )
0022F6 9908rrrr        5738         MOV.W   R0,#SOF( _ParCnt )
0022FA 8200            5739         MOV.B   R0L,[R0]
0022FC B110            5740         MOVS.B  R0H,#00H
0022FE B910            5741         MOVS.W  R1,#00H
002300 964842rr        5742         MOV.B   ES,#SEG( _ParType )
002304 8500rrrr        5743         MOV.B   R0L,[R0+SOF( _ParType )]
                       5744         BNE     _548
002308 F302           +5744 ;       BEQ     _LG_362
00230A D500B0         +5744 ;       JMP.L   _548
00230A D500B000       +5744 ;       JMP.L   _548
00230E                +5744 _LG_362:
                       5745 ; rs232par.c 1348                               {
                       5746 ; rs232par.c 1349                                       if ( NumSuffix)
00230E 964842rr        5748         MOV.B   ES,#SEG( _NumSuffix )
002312 9908rrrr        5749         MOV.W   R0,#SOF( _NumSuffix )
002316 8A00            5750         MOV.W   R0,[R0]
002318 F30C            5751         BEQ     _536
                       5752 ; rs232par.c 1350                                               Cmd[NoOfDigits] = 0;
00231A 964842rr        5754         MOV.B   ES,#SEG( _NoOfDigits )
00231E 9908rrrr        5755         MOV.W   R0,#SOF( _NoOfDigits )
002322 8200            5756         MOV.B   R0L,[R0]
002324 B110            5757         MOVS.B  R0H,#00H
002326 B910            5758         MOVS.W  R1,#00H
002328 964842rr        5759         MOV.B   ES,#SEG( _Cmd )
00232C B500rrrr        5760         MOV.B   [R0+SOF( _Cmd )],#00H
002330 FE05            5761         BR      _537
002330 FE05            5761         BR      _537
002332                 5762 _536:
                       5763 ; rs232par.c 1351                                       else
                       5764 ; rs232par.c 1352                                               NumSuffix = 1;
002332 964842rr        5766         MOV.B   ES,#SEG( _NumSuffix )
002336 9908rrrr        5767         MOV.W   R0,#SOF( _NumSuffix )
00233A BA01            5768         MOV.W   [R0],#01H
00233A BA01            5768         MOV.W   [R0],#01H
00233C                 5769 _537:
                       5770 ; rs232par.c 1353       
                       5771 ; rs232par.c 1354                                       while ( CmdPtr)
00233C 964842rr        5773         MOV.B   ES,#SEG( _CmdPtr )
002340 9918rrrr        5774         MOV.W   R1,#SOF( _CmdPtr )
002344 8B01            5775         MOV.W   R0,[R1+]
002346 8A11            5776         MOV.W   R1,[R1]
002348 6910            5777         OR.W    R1,R0
                       5778         BEQ     _548
00234A F202           +5778 ;       BNE     _LG_366
00234C D5008F         +5778 ;       JMP.L   _548
00234C D5008F00       +5778 ;       JMP.L   _548
002350                +5778 _LG_366:
002350                +5778 _LG_366:
002350                 5779 _538:
                       5780 ; rs232par.c 1355                                       {
                       5781 ; rs232par.c 1356                                               if (( !Cstrcmp( Cmd, CmdPtr->Long
                            Name)) ||
                       5782 ; rs232par.c 1357                                                        ( !Cstrcmp( Cmd, CmdPtr-
                            >ShortName)))
002350 964842rr        5784         MOV.B   ES,#SEG( _CmdPtr )
002354 9918rrrr        5785         MOV.W   R1,#SOF( _CmdPtr )
002358 8B01            5786         MOV.W   R0,[R1+]
00235A 8A11            5787         MOV.W   R1,[R1]
00235C 862C43          5788         MOV.B   CS,R1L
00235F 8820            5789         MOVC.W  R2,[R0+]
002361 99040000        5790         CMP.W   R0,#00H
XA assembler v2.0 r2                    SN00085795-037 (c) 1998 TASKING, Inc.
                                                                                                                            Page  79

ADDR   CODE            LINE SOURCELINE
002365 F202            5791         BNE     _563
002367 A64143          5792         ADDS.B  CS,#01H
002367 A64143          5792         ADDS.B  CS,#01H
00236A                 5793 _563:
00236A 8830            5794         MOVC.W  R3,[R0+]
00236C 9918rrrr        5795         MOV.W   R1,#SEG( _Cmd )
002370 9908rrrr        5796         MOV.W   R0,#SOF( _Cmd )
                       5797         CALL    _Cstrcmp
002374 C4rrrrrr       +5797 ;       FCALL   _Cstrcmp
002378 6900            5798         OR.W    R0,R0
00237A F31A            5799         BEQ     _539
00237C 964842rr        5800         MOV.B   ES,#SEG( _CmdPtr )
002380 9918rrrr        5801         MOV.W   R1,#SOF( _CmdPtr )
002384 8B01            5802         MOV.W   R0,[R1+]
002386 8A11            5803         MOV.W   R1,[R1]
002388 99000004        5804         ADD.W   R0,#04H
00238C 99110000        5805         ADDC.W  R1,#00H
002390 862C43          5806         MOV.B   CS,R1L
002393 8820            5807         MOVC.W  R2,[R0+]
002395 99040000        5808         CMP.W   R0,#00H
002399 F202            5809         BNE     _564
00239B A64143          5810         ADDS.B  CS,#01H
00239B A64143          5810         ADDS.B  CS,#01H
00239E                 5811 _564:
00239E 8830            5812         MOVC.W  R3,[R0+]
0023A0 9918rrrr        5813         MOV.W   R1,#SEG( _Cmd )
0023A4 9908rrrr        5814         MOV.W   R0,#SOF( _Cmd )
                       5815         CALL    _Cstrcmp
0023A8 C4rrrrrr       +5815 ;       FCALL   _Cstrcmp
0023AC 6900            5816         OR.W    R0,R0
0023AE F22B            5817         BNE     _543
0023AE F22B            5817         BNE     _543
0023B0                 5818 _539:
                       5819 ; rs232par.c 1358                                               {
                       5820 ; rs232par.c 1359       
                       5821 ; rs232par.c 1360                                                       if ( CmdPtr->Suffix != NO
                            NE)
0023B0 964842rr        5823         MOV.B   ES,#SEG( _CmdPtr )
0023B4 9918rrrr        5824         MOV.W   R1,#SOF( _CmdPtr )
0023B8 8B01            5825         MOV.W   R0,[R1+]
0023BA 8A11            5826         MOV.W   R1,[R1]
0023BC 99000010        5827         ADD.W   R0,#010H
0023C0 99110000        5828         ADDC.W  R1,#00H
0023C4 862C43          5829         MOV.B   CS,R1L
0023C7 8820            5830         MOVC.W  R2,[R0+]
0023C9 99040000        5831         CMP.W   R0,#00H
0023CD F202            5832         BNE     _565
0023CF A64143          5833         ADDS.B  CS,#01H
0023CF A64143          5833         ADDS.B  CS,#01H
0023D2                 5834 _565:
0023D2 8830            5835         MOVC.W  R3,[R0+]
0023D4 8953            5836         MOV.W   R5,R3
0023D6 8942            5837         MOV.W   R4,R2
0023D8 6932            5838         OR.W    R3,R2
0023DA F303            5839         BEQ     _540
                       5840 ; rs232par.c 1361                                                               CmdPtr->Suffix();
                            
0023DC C4rrrrrr        5842         FCALL   __ICALL
0023E0 FE0E            5843         BR      _542
0023E0 FE0E            5843         BR      _542
0023E2                 5844 _540:
                       5845 ; rs232par.c 1362                                                       else
XA assembler v2.0 r2                    SN00085795-037 (c) 1998 TASKING, Inc.
                                                                                                                            Page  80

ADDR   CODE            LINE SOURCELINE
                       5846 ; rs232par.c 1363                                                       {
                       5847 ; rs232par.c 1364                                                               if ( NumSuffix > 
                            1)
0023E2 964842rr        5849         MOV.B   ES,#SEG( _NumSuffix )
0023E6 9908rrrr        5850         MOV.W   R0,#SOF( _NumSuffix )
0023EA 8A00            5851         MOV.W   R0,[R0]
0023EC 99040001        5852         CMP.W   R0,#01H
0023F0 F906            5853         BL      _542
                       5854 ; rs232par.c 1365                                                                       SCPIError
                             = HdrSuffixOutOfRange;
0023F2 964842rr        5856         MOV.B   ES,#SEG( _SCPIError )
0023F6 9908rrrr        5857         MOV.W   R0,#SOF( _SCPIError )
0023FA 9A08000C        5858         MOV.W   [R0],#0CH
                       5859 ; rs232par.c 1366                                                       }
0023FE                 5861 _542:
                       5862 ; rs232par.c 1367       
                       5863 ; rs232par.c 1368                                                       if ( CmdState == NextLeve
                            l)
0023FE 91C401          5865         CMP.B   R6L,#01H
002401 F235            5866         BNE     _548
                       5867 ; rs232par.c 1369                                                               CmdPtr = CmdPtr->
                            NextLevel;
                       5868 ; rs232par.c 1370                                                       break;
002403 FE1C            5870         BR      _544
                       5871 ; rs232par.c 1371                                               }
002406                 5873 _543:
                       5874 ; rs232par.c 1372                                               CmdPtr = CmdPtr->SameLevel;
002406 964842rr        5876         MOV.B   ES,#SEG( _CmdPtr )
00240A 9938rrrr        5877         MOV.W   R3,#SOF( _CmdPtr )
00240E 8B23            5878         MOV.W   R2,[R3+]
002410 8A33            5879         MOV.W   R3,[R3]
002412 99200008        5880         ADD.W   R2,#08H
002416 99310000        5881         ADDC.W  R3,#00H
00241A 866C43          5882         MOV.B   CS,R3L
00241D 8802            5883         MOVC.W  R0,[R2+]
00241F 99240000        5884         CMP.W   R2,#00H
002423 F202            5885         BNE     _568
002425 A64143          5886         ADDS.B  CS,#01H
002425 A64143          5886         ADDS.B  CS,#01H
002428                 5887 _568:
002428 8812            5888         MOVC.W  R1,[R2+]
00242A 964842rr        5889         MOV.B   ES,#SEG( _CmdPtr )
00242E 9928rrrr        5890         MOV.W   R2,#SOF( _CmdPtr )
002432 8B0A            5891         MOV.W   [R2+],R0
002434 8A1A            5892         MOV.W   [R2],R1
002436 6910            5894         OR.W    R1,R0
002438 F28B            5895         BNE     _538
                       5896 ; rs232par.c 1373                                       }
                       5897 ; rs232par.c 1374                               }
00243A FE18            5899         BR      _548
00243C                 5901 _544:
00243C 964842rr        5902         MOV.B   ES,#SEG( _CmdPtr )
002440 9918rrrr        5903         MOV.W   R1,#SOF( _CmdPtr )
002444 8B01            5904         MOV.W   R0,[R1+]
002446 8A11            5905         MOV.W   R1,[R1]
002448 9900000C        5906         ADD.W   R0,#0CH
00244C 99110000        5907         ADDC.W  R1,#00H
002450 862C43          5908         MOV.B   CS,R1L
002453 8820            5909         MOVC.W  R2,[R0+]
002455 99040000        5910         CMP.W   R0,#00H
002459 F202            5911         BNE     _569
00245B A64143          5912         ADDS.B  CS,#01H
XA assembler v2.0 r2                    SN00085795-037 (c) 1998 TASKING, Inc.
                                                                                                                            Page  81

ADDR   CODE            LINE SOURCELINE
00245B A64143          5912         ADDS.B  CS,#01H
00245E                 5913 _569:
00245E 8830            5914         MOVC.W  R3,[R0+]
002460 964842rr        5915         MOV.B   ES,#SEG( _CmdPtr )
002464 9908rrrr        5916         MOV.W   R0,#SOF( _CmdPtr )
002468 8B28            5917         MOV.W   [R0+],R2
00246A 8A38            5918         MOV.W   [R0],R3
                       5919 ; rs232par.c 1375                               else
                       5920 ; rs232par.c 1376                               {
                       5921 ; rs232par.c 1377       
                       5922 ; rs232par.c 1378       /*                              switch ( ParameterType) {
                       5923 ; rs232par.c 1379                                               case P_BinDecNum:
                       5924 ; rs232par.c 1380                                                       btol( Cmd, &DecVar);
                       5925 ; rs232par.c 1381                                                       _ultoa( DecVar, Cmd);
                       5926 ; rs232par.c 1382                                                       ParameterType = P_DecNum;
                            
                       5927 ; rs232par.c 1383                                                       break;
                       5928 ; rs232par.c 1384       
                       5929 ; rs232par.c 1385                                               case P_OctDecNum:
                       5930 ; rs232par.c 1386                                                       otol( Cmd, &DecVar);
                       5931 ; rs232par.c 1387                                                       _ultoa( DecVar, Cmd);
                       5932 ; rs232par.c 1388                                                       ParameterType = P_DecNum;
                            
                       5933 ; rs232par.c 1389                                                       break;
                       5934 ; rs232par.c 1390       
                       5935 ; rs232par.c 1391                                               case P_HexDecNum:
                       5936 ; rs232par.c 1392                                                       htol( Cmd, &DecVar);
                       5937 ; rs232par.c 1393                                                       _ultoa( DecVar, Cmd);
                       5938 ; rs232par.c 1394                                                       ParameterType = P_DecNum;
                            
                       5939 ; rs232par.c 1395                                                       break;
                       5940 ; rs232par.c 1396                                       }
                       5941 ; rs232par.c 1397       */                      }
00246C                 5943 _548:
                       5944 ; rs232par.c 1398       
                       5945 ; rs232par.c 1399                               if ( CmdState != NextLevel)                      
                                                    // ie. Ready, PMUS and PMT
00246C 91C401          5947         CMP.B   R6L,#01H
00246F F367            5948         BEQ     _562
                       5949 ; rs232par.c 1400                               {
                       5950 ; rs232par.c 1401       
                       5951 ; rs232par.c 1402       /*                              if ( SCPIError == NoErr) {
                       5952 ; rs232par.c 1403       
                       5953 ; rs232par.c 1404                                               if ( CmdState != Ready)
                       5954 ; rs232par.c 1405                                                       CmdExecute = TRUE;
                       5955 ; rs232par.c 1406                                               else
                       5956 ; rs232par.c 1407                                                       CmdExecute = FALSE;
                       5957 ; rs232par.c 1408       
                       5958 ; rs232par.c 1409                                               if (( CmdPtr->Function != NONE) &
                            & CmdPtr)
                       5959 ; rs232par.c 1410                                                       CmdPtr->Function();
                       5960 ; rs232par.c 1411                                               else {
                       5961 ; rs232par.c 1412                                                       if ( Cmd[0] != '\x0')
                       5962 ; rs232par.c 1413                                                               SCPIError = Synta
                            xErr;
                       5963 ; rs232par.c 1414                                               }
                       5964 ; rs232par.c 1415                                       }*/
                       5965 ; rs232par.c 1416       
                       5966 ; rs232par.c 1417       // Rewritten by TK 991110 to not execute function before delimiter.
                       5967 ; rs232par.c 1418       
                       5968 ; rs232par.c 1419                                       if ( SCPIError == NoErr)
002471 964842rr        5970         MOV.B   ES,#SEG( _SCPIError )
XA assembler v2.0 r2                    SN00085795-037 (c) 1998 TASKING, Inc.
                                                                                                                            Page  82

ADDR   CODE            LINE SOURCELINE
002475 9908rrrr        5971         MOV.W   R0,#SOF( _SCPIError )
002479 8A00            5972         MOV.W   R0,[R0]
00247B F237            5973         BNE     _555
                       5974 ; rs232par.c 1420                                       {
                       5975 ; rs232par.c 1421                                               if ( CmdState != Ready)
00247D 91C402          5977         CMP.B   R6L,#02H
002480 F32F            5978         BEQ     _551
                       5979 ; rs232par.c 1422                                               {
                       5980 ; rs232par.c 1423                                                       CmdExecute = TRUE;      
002482 964842rr        5982         MOV.B   ES,#SEG( _CmdExecute )
002486 9908rrrr        5983         MOV.W   R0,#SOF( _CmdExecute )
00248A 9208FF          5984         MOV.B   [R0],#0FFH
                       5985 ; rs232par.c 1424       
                       5986 ; rs232par.c 1425                                                       if (( CmdPtr->Function !=
                             NONE) && CmdPtr)
00248D 964842rr        5988         MOV.B   ES,#SEG( _CmdPtr )
002491 9938rrrr        5989         MOV.W   R3,#SOF( _CmdPtr )
002495 8B23            5990         MOV.W   R2,[R3+]
002497 8A33            5991         MOV.W   R3,[R3]
002499 8953            5992         MOV.W   R5,R3
00249B 8942            5993         MOV.W   R4,R2
00249D 99400014        5994         ADD.W   R4,#014H
0024A1 99510000        5995         ADDC.W  R5,#00H
0024A5 86AC43          5996         MOV.B   CS,R5L
0024A8 8804            5997         MOVC.W  R0,[R4+]
0024AA 99440000        5998         CMP.W   R4,#00H
0024AE F202            5999         BNE     _572
0024B0 A64143          6000         ADDS.B  CS,#01H
0024B0 A6414300        6000         ADDS.B  CS,#01H
0024B4                 6001 _572:
0024B4 8814            6002         MOVC.W  R1,[R4+]
0024B6 8951            6003         MOV.W   R5,R1
0024B8 8940            6004         MOV.W   R4,R0
0024BA 6910            6005         OR.W    R1,R0
0024BC F305            6006         BEQ     _550
0024BE 6932            6007         OR.W    R3,R2
0024C0 F303            6008         BEQ     _550
                       6009 ; rs232par.c 1426                                                               CmdPtr->Function(
                            );
0024C2 C4rrrrrr        6011         FCALL   __ICALL
0024C6 FE11            6012         BR      _555
0024C6 FE11            6012         BR      _555
0024C8                 6013 _550:
                       6014 ; rs232par.c 1427                                                       else
                       6015 ; rs232par.c 1428                                                       {
                       6016 ; rs232par.c 1429                                                               if ( Cmd[0] != '\
                            x0')
0024C8 964842rr        6018         MOV.B   ES,#SEG( _Cmd )
0024CC 9908rrrr        6019         MOV.W   R0,#SOF( _Cmd )
0024D0 8200            6020         MOV.B   R0L,[R0]
0024D2 F30B            6021         BEQ     _555
                       6022 ; rs232par.c 1430                                                                       SCPIError
                             = SyntaxErr;
0024D4 964842rr        6024         MOV.B   ES,#SEG( _SCPIError )
0024D8 9908rrrr        6025         MOV.W   R0,#SOF( _SCPIError )
0024DC BA03            6026         MOV.W   [R0],#03H
                       6027 ; rs232par.c 1431                                                       }
                       6028 ; rs232par.c 1432                                               }
0024DE FE05            6030         BR      _555
0024DE FE05            6030         BR      _555
0024E0                 6031 _551:
                       6032 ; rs232par.c 1433                                               else
XA assembler v2.0 r2                    SN00085795-037 (c) 1998 TASKING, Inc.
                                                                                                                            Page  83

ADDR   CODE            LINE SOURCELINE
                       6033 ; rs232par.c 1434                                                       CmdExecute = FALSE;
0024E0 964842rr        6035         MOV.B   ES,#SEG( _CmdExecute )
0024E4 9908rrrr        6036         MOV.W   R0,#SOF( _CmdExecute )
0024E8 B200            6037         MOV.B   [R0],#00H
                       6038 ; rs232par.c 1435       
                       6039 ; rs232par.c 1436                                       }
0024EA                 6041 _555:
                       6042 ; rs232par.c 1437       
                       6043 ; rs232par.c 1438                                       if ( CmdState == PMT)
0024EA 91C404          6045         CMP.B   R6L,#04H
0024ED F211            6046         BNE     _556
                       6047 ; rs232par.c 1439                                               CmdPtr = CmdLevelPtr = &Subsystem
                            [0];    // Reset level pointers
0024EF 964842rr        6049         MOV.B   ES,#SEG( _CmdLevelPtr )
0024F3 9908rrrr        6050         MOV.W   R0,#SOF( _CmdLevelPtr )
0024F7 9B08rrrr        6051         MOV.W   [R0+],#SOF( _Subsystem )
0024FB 9A08rrrr        6052         MOV.W   [R0],#SEG( _Subsystem )
0024FF 964842rr        6053         MOV.B   ES,#SEG( _CmdPtr )
002503 9908rrrr        6054         MOV.W   R0,#SOF( _CmdPtr )
002507 9B08rrrr        6055         MOV.W   [R0+],#SOF( _Subsystem )
00250B 9A08rrrr        6056         MOV.W   [R0],#SEG( _Subsystem )
00250B 9A08rrrr00      6056         MOV.W   [R0],#SEG( _Subsystem )
002510                 6057 _556:
                       6058 ; rs232par.c 1440       
                       6059 ; rs232par.c 1441                                       if ( CmdState != Ready)                  
                                                                            // ie. PMUS and PMT
002510 91C402          6061         CMP.B   R6L,#02H
002513 F315            6062         BEQ     _562
                       6063 ; rs232par.c 1442                                       {
                       6064 ; rs232par.c 1443                                               if ( SCPIError)                  
                                                                                                    // If any errors has occu
                            red
002515 964842rr        6066         MOV.B   ES,#SEG( _SCPIError )
002519 9908rrrr        6067         MOV.W   R0,#SOF( _SCPIError )
00251D 8A00            6068         MOV.W   R0,[R0]
00251F F309            6069         BEQ     _557
                       6070 ; rs232par.c 1444                                               {
                       6071 ; rs232par.c 1445                                                       SaveErrorEventQueue( SCPI
                            Error);         //  save the error
                       6073         CALL    _SaveErrorEventQueue
002521 C4rrrrrr       +6073 ;       FCALL   _SaveErrorEventQueue
                       6074 ; rs232par.c 1446                                                       SCPIError = NoErr;
002525 964842rr        6076         MOV.B   ES,#SEG( _SCPIError )
002529 9908rrrr        6077         MOV.W   R0,#SOF( _SCPIError )
00252D BA00            6078         MOV.W   [R0],#00H
                       6079 ; rs232par.c 1447                                               }
00252F FE07            6081         BR      _562
00252F FE0700          6081         BR      _562
002532                 6082 _557:
                       6083 ; rs232par.c 1448                                               else
                       6084 ; rs232par.c 1449                                                       NewCmdExecuted = TRUE;   
                                                    // Command has succesfully
002532 964842rr        6086         MOV.B   ES,#SEG( _NewCmdExecuted )
002536 9908rrrr        6087         MOV.W   R0,#SOF( _NewCmdExecuted )
00253A 9208FF          6088         MOV.B   [R0],#0FFH
                       6089 ; rs232par.c 1450                                       }                                        
                                                                                            //  been executed
                       6090 ; rs232par.c 1451                               }
                       6091 ; rs232par.c 1452                               break;
                       6092 ; rs232par.c 1453               }
00253E                 6094 _562:
                       6095 ; rs232par.c 1454       }
XA assembler v2.0 r2                    SN00085795-037 (c) 1998 TASKING, Inc.
                                                                                                                            Page  84

ADDR   CODE            LINE SOURCELINE
00253E 2F70            6097         POP.W   R4, R5, R6
002540 D680            6099         RET
000000                 6106 RS232PAR_CLR_FA SEGMENT HDATA INSEGMENT CLEAR
000000                 6107         RSEG    RS232PAR_CLR_FA
                       6108         PUBLIC  _CmdExecute
000000 RESERVED        6109 _CmdExecute:    DS      1
000000
                       6112         PUBLIC  _NewCmdExecuted
000001 RESERVED        6113 _NewCmdExecuted:        DS      1
000001
                       6117         PUBLIC  _ParType
000002                 6118 _ParType:       DS      10
   |  RESERVED             
00000B
                       6121         EXTRN   HCODE(_Cstrcmp)
                       6124         EXTRN   HCODE(_toupper)
                       6127         EXTRN   HCODE(_SaveErrorEventQueue)
                       6130         PUBLIC  _CmdNdx
                       6131         ALIGN   1
00000C                 6132 _CmdNdx:        DS      2
   |  RESERVED             
00000D
                       6134         ALIGN   1
00000E                 6135 _NoOfBytes:     DS      2
   |  RESERVED             
00000F
                       6139         PUBLIC  _Cmd
000010                 6140 _Cmd:   DS      512
   |  RESERVED             
00020F
                       6143         PUBLIC  _ParCnt
000210 RESERVED        6144 _ParCnt:        DS      1
000210
                       6147         PUBLIC  _NumSuffix
000211 RESERVED        6148         ALIGN   1
000211
000212                 6149 _NumSuffix:     DS      2
   |  RESERVED             
000213
                       6152         PUBLIC  _CmdRequest
000214 RESERVED        6153 _CmdRequest:    DS      1
000214
                       6156         EXTRN   HCODE(_rs232GetLastError)
                       6159         EXTRN   HDATA(__ctype_)
                       6162         EXTRN   HCODE(_Mandated)
000215 RESERVED        6164 _NoOfDigits:    DS      1
000215
                       6165         EXTRN   HCODE(__ICALL)
                       6168         EXTRN   HCODE(_Subsystem)
                       6171         PUBLIC  _ResponseReceived
000216 RESERVED        6172 _ResponseReceived:      DS      1
000216
                       6174         EXTRN   HDATA(_SCPIError)
                       6175         EXTRN   DATA(__lc_ub_xvwbuffer)
                       6176         EXTRN   DATA(__lc_ue_xvwbuffer)
                       6177         CALLS   'CmdSyntax', 'toupper'
                       6178         CALLS   'CmdSyntax', 'rs232GetLastError'
                       6179         CALLS   'CmdHandler', 'CmdSyntax'
                       6180         CALLS   'CmdHandler', 'Cstrcmp'
                       6181         CALLS   'CmdHandler', 'SaveErrorEventQueue'
