file:readme

This version of HD or DL generators contains a 'boot loader', enabling
the microprocessor to receive new program and program the program 
FLASH with it (reprogram itself).

The boot loader is in updat.c.  It is small program which receives data
via UART and writes it into the program FLASH.  updat is linked to 
reside at 0x3C00.  To prepare the hex file for production, you must 
obtain 2 hex files:

a.hex:     main program, obtained via makefile and 
updat.hex: the boot loader. obtained via upd.bat.

Then you must manually combine these two files into one (using a text 
editor) all.hex file, which will contain data for program and the 
boot loader residing at proper addresses.  This all.hex file is then
used by the production team to program all boards leaving the factory.

Note that you must use hex file for combined main and updat, when
programming units, even if updat already resides in the FLASH.  
This is because the programers used always erase all FLASH memory
before programming.

When a new version of the software is issued, it is obtained with 
makefile and a new a.hex file is produced, for a new version of the
main program.  This file is converted to binary (a.bin) and may be
sent to all customers who wish to upgrade their boards.

The customers use dkplay.exe program, which will transmit the new 
version (a.bin) into the boot loader on their boards, thus writing 
the new software into their board's microprocessors.

The dkplay.exe program is used to program both microprocessor and 
FPGA onboard a HD or DL genrator in one go.  It does this via RS232
link from a PC to the PT5300 mainframe.

The main program contains a FPGA programming function (JTAGMode()),
which, using a JTAG connection to the FPGA, programs the FPGA with
received data.
:JK
24.11.2006




