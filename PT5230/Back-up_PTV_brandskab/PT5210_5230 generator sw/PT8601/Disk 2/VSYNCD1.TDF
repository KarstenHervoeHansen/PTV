SUBDESIGN vsyncd1
(
	clk,vg,vm,hsync,vdly,syssel:	INPUT;
	vpulse,gfield,mfield:			OUTPUT;
)
VARIABLE 
	g2,m2,g1,m1:	DFFE;

BEGIN
	vpulse = (vg & !syssel) # (vm & syssel);

	g1.clk	= clk;
	g1.ena	= hsync;
	g1.d	= vg;

	m1.clk	= clk;
	m1.ena	= hsync;
	m1.d	= vm;

	g2.clk	= clk;
	g2.ena	= hsync;
	g2.d	= g1;

	m2.clk	= clk;
	m2.ena	= hsync;
	m2.d	= m1;

	gfield	= (vdly & g1) # (!vdly & g2);
	mfield	= (vdly & m1) # (!vdly & m2);

END;


